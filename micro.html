<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BIZ-OMICS — Microeconomics</title>
<style>
/* ── SYSTEM FONT STACK — NO EXTERNAL REQUESTS ── */
:root{
  --ff-sans:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;
  --ff-mono:'SFMono-Regular','SF Mono',Consolas,'Liberation Mono',monospace;
  --bg:#0a0e1a;--surface:#111827;--surface2:#0d1526;
  --macro:#3b82f6;--macro2:#60a5fa;
  --micro:#10b981;--micro2:#34d399;
  --amber:#f59e0b;--red:#ef4444;--purple:#8b5cf6;
  --orange:#f97316;--pink:#ec4899;--cyan:#06b6d4;--lime:#84cc16;
  --text:#f1f5f9;--muted:#94a3b8;--border:rgba(255,255,255,0.08);
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:var(--ff-sans);background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;}

/* ── HEADER ── */
header{padding:1.1rem 2.5rem;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);position:sticky;top:0;background:rgba(10,14,26,0.96);backdrop-filter:blur(16px);z-index:200;}
.logo{font-size:1.35rem;font-weight:900;letter-spacing:-0.02em;cursor:pointer;user-select:none;}
.logo span{color:var(--amber);}
.header-nav{display:flex;align-items:center;gap:0.6rem;}
.nav-btn{font-size:0.78rem;padding:0.38rem 0.95rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;transition:all 0.18s;font-family:var(--ff-sans);font-weight:500;}
.nav-btn:hover{color:var(--text);border-color:rgba(255,255,255,0.25);}
.nav-btn#nb-home.active{background:var(--amber);color:#000;border-color:var(--amber);font-weight:700;}
.nav-btn#nb-macro.active{background:var(--macro);color:#fff;border-color:var(--macro);font-weight:700;}
.nav-btn#nb-micro.active{background:var(--micro);color:#000;border-color:var(--micro);font-weight:700;}

/* ── VIEWS ── */
.view{display:none;}
.view.active{display:block;animation:fadein 0.22s ease;}
@keyframes fadein{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:none}}

/* ── HOME ── */
#v-home{max-width:1060px;margin:0 auto;padding:4rem 2rem 3rem;}
.hero{text-align:center;margin-bottom:3rem;}
.hero-eyebrow{font-family:var(--ff-mono);font-size:0.68rem;color:var(--amber);letter-spacing:0.2em;text-transform:uppercase;margin-bottom:1rem;}
.hero h1{font-size:clamp(2rem,4.5vw,3.4rem);font-weight:900;line-height:1.1;letter-spacing:-0.025em;margin-bottom:1rem;}
.hero h1 em{font-style:normal;color:var(--amber);}
.hero-sub{font-size:0.97rem;color:var(--muted);max-width:500px;margin:0 auto;line-height:1.75;}
.boards-row{text-align:center;margin-bottom:2.5rem;}
.boards-label{font-family:var(--ff-mono);font-size:0.64rem;color:var(--muted);letter-spacing:0.12em;text-transform:uppercase;margin-bottom:0.6rem;}
.boards{display:inline-flex;gap:0.45rem;flex-wrap:wrap;justify-content:center;}
.board-tag{font-size:0.74rem;padding:0.25rem 0.7rem;border-radius:100px;background:rgba(255,255,255,0.04);border:1px solid var(--border);color:var(--muted);}
.home-cards{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;}
.hc{position:relative;border-radius:16px;padding:2.1rem 1.9rem 2rem;overflow:hidden;border:1px solid var(--border);cursor:pointer;transition:transform 0.22s,box-shadow 0.22s,border-color 0.22s;}
.hc:hover{transform:translateY(-4px);}
.hc.hc-macro{background:linear-gradient(135deg,rgba(59,130,246,0.09) 0%,#111827 55%);}
.hc.hc-macro:hover{border-color:rgba(59,130,246,0.45);box-shadow:0 18px 50px rgba(59,130,246,0.13);}
.hc.hc-micro{background:linear-gradient(135deg,rgba(16,185,129,0.09) 0%,#111827 55%);}
.hc.hc-micro:hover{border-color:rgba(16,185,129,0.45);box-shadow:0 18px 50px rgba(16,185,129,0.13);}
.hc-glow{position:absolute;top:-50px;right:-50px;width:170px;height:170px;border-radius:50%;opacity:0.1;filter:blur(32px);pointer-events:none;}
.hc-macro .hc-glow{background:var(--macro);}
.hc-micro .hc-glow{background:var(--micro);}
.hc-badge{display:inline-block;font-family:var(--ff-mono);font-size:0.61rem;letter-spacing:0.14em;text-transform:uppercase;padding:0.26rem 0.68rem;border-radius:100px;margin-bottom:1rem;font-weight:500;}
.hc-macro .hc-badge{background:rgba(59,130,246,0.14);color:#60a5fa;border:1px solid rgba(59,130,246,0.25);}
.hc-micro .hc-badge{background:rgba(16,185,129,0.14);color:#34d399;border:1px solid rgba(16,185,129,0.25);}
.hc h2{font-size:1.8rem;font-weight:900;margin-bottom:0.6rem;letter-spacing:-0.02em;}
.hc p{font-size:0.86rem;color:var(--muted);line-height:1.65;margin-bottom:1.4rem;}
.topic-pills{display:flex;flex-wrap:wrap;gap:0.32rem;margin-bottom:1.6rem;}
.pill{font-size:0.68rem;padding:0.2rem 0.52rem;border-radius:100px;background:rgba(255,255,255,0.05);border:1px solid var(--border);color:var(--muted);}
.hc-btn{display:inline-flex;align-items:center;gap:0.4rem;font-size:0.83rem;font-weight:700;padding:0.62rem 1.25rem;border-radius:9px;border:none;cursor:pointer;font-family:var(--ff-sans);}
.hc-macro .hc-btn{background:var(--macro);color:#fff;}
.hc-micro .hc-btn{background:var(--micro);color:#000;}
.hc-count{position:absolute;bottom:2rem;right:1.9rem;font-family:var(--ff-mono);font-size:0.63rem;color:var(--muted);opacity:0.5;}
.home-footer{text-align:center;margin-top:2.5rem;font-family:var(--ff-mono);font-size:0.72rem;color:var(--muted);opacity:0.4;}

/* ── BANK VIEWS ── */
.progress-bar{height:3px;background:var(--border);}
.prog-fill{height:100%;transition:width 0.4s ease;width:0%;}
#v-macro .prog-fill{background:linear-gradient(90deg,var(--macro2),var(--macro));}
#v-micro .prog-fill{background:linear-gradient(90deg,var(--micro2),var(--micro));}
.bank-wrap{padding:1.6rem 2.5rem;max-width:1500px;margin:0 auto;}
.controls{display:flex;gap:0.5rem;margin-bottom:1.6rem;flex-wrap:wrap;align-items:center;padding:0.85rem 1.1rem;background:rgba(255,255,255,0.03);border-radius:11px;border:1px solid var(--border);}
.filter-label{font-family:var(--ff-mono);font-size:0.64rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.12em;white-space:nowrap;}
.fbtn{padding:0.33rem 0.8rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--muted);font-family:var(--ff-sans);font-size:0.75rem;font-weight:500;cursor:pointer;transition:all 0.16s;white-space:nowrap;}
.fbtn:hover{color:var(--text);border-color:rgba(255,255,255,0.25);}
#v-macro .fbtn.active{background:var(--macro);color:#fff;border-color:var(--macro);}
#v-micro .fbtn.active{background:var(--micro);color:#000;border-color:var(--micro);}
.div{width:1px;height:20px;background:var(--border);}
.stats{display:flex;gap:0.85rem;}
.stat{display:flex;flex-direction:column;align-items:center;}
.stat-n{font-family:var(--ff-mono);font-size:1rem;font-weight:700;}
#v-macro .stat-n{color:var(--macro);}
#v-micro .stat-n{color:var(--micro);}
.stat-l{font-size:0.58rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.1em;}
.btn-g{padding:0.33rem 0.8rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:0.75rem;cursor:pointer;font-family:var(--ff-sans);}
.btn-g:hover{color:var(--text);}
.search-wrap{position:relative;display:flex;align-items:center;}
.search-wrap svg{position:absolute;left:0.55rem;width:13px;height:13px;pointer-events:none;color:var(--muted);}
.search-input{padding:0.33rem 0.8rem 0.33rem 1.9rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--text);font-family:var(--ff-sans);font-size:0.75rem;width:160px;outline:none;transition:border-color 0.16s,width 0.22s;}
.search-input::placeholder{color:var(--muted);}
.search-input:focus{border-color:rgba(255,255,255,0.3);width:200px;}
#v-macro .search-input:focus{border-color:var(--macro);}
#v-micro .search-input:focus{border-color:var(--micro);}
.btn-p{padding:0.33rem 0.92rem;border-radius:100px;border:none;font-size:0.75rem;font-weight:700;cursor:pointer;font-family:var(--ff-sans);}
#v-macro .btn-p{background:var(--macro);color:#fff;}
#v-micro .btn-p{background:var(--micro);color:#000;}

/* ── CARD GRID ── */
.card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.25rem;}
.cw{perspective:1200px;}
.fc{width:100%;aspect-ratio:3/4;position:relative;transform-style:preserve-3d;transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);cursor:pointer;border-radius:14px;}
.fc.flipped{transform:rotateY(180deg);}
.fc-f,.fc-b{position:absolute;inset:0;backface-visibility:hidden;border-radius:14px;display:flex;flex-direction:column;}
.fc-f{border:1px solid var(--border);overflow:hidden;}
.fc-f::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
.fc-b{transform:rotateY(180deg);padding:1.2rem 1.3rem;justify-content:space-between;overflow:auto;}
#v-macro .fc-f{background:#0d1526;}
#v-macro .fc-b{background:#0a1020;border:1px solid rgba(59,130,246,0.16);}
#v-micro .fc-f{background:#0f1f14;}
#v-micro .fc-b{background:#0a2010;border:1px solid rgba(16,185,129,0.16);}
.ch{padding:0.75rem 0.9rem 0.4rem;display:flex;justify-content:space-between;}
.ccat{font-family:var(--ff-mono);font-size:0.58rem;letter-spacing:0.12em;text-transform:uppercase;font-weight:600;}
.cid{font-family:var(--ff-mono);font-size:0.58rem;color:rgba(255,255,255,0.16);}
.cdiag{flex:1;display:flex;align-items:center;justify-content:center;padding:0.2rem 0.5rem;min-height:0;}
.cdiag svg{max-width:100%;height:auto;min-height:165px;}
.ctit{padding:0.4rem 0.9rem 0.75rem;}
.ctit h3{font-size:0.86rem;font-weight:600;line-height:1.3;}
.blbl{font-family:var(--ff-mono);font-size:0.56rem;letter-spacing:0.15em;text-transform:uppercase;margin-bottom:0.4rem;opacity:0.65;}
#v-macro .blbl{color:var(--macro);}
#v-micro .blbl{color:var(--micro);}
.bcon{font-size:1rem;font-weight:800;margin-bottom:0.55rem;line-height:1.25;}
.bexp{font-size:0.76rem;color:var(--muted);line-height:1.55;margin-bottom:0.55rem;flex:1;}
.bkey{border-radius:7px;padding:0.55rem 0.7rem;font-size:0.72rem;line-height:1.5;}
#v-macro .bkey{background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.2);color:var(--macro2);}
#v-micro .bkey{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);color:var(--micro2);}
.bkey strong{display:block;font-size:0.58rem;font-family:var(--ff-mono);letter-spacing:0.1em;text-transform:uppercase;margin-bottom:0.15rem;}
#v-macro .bkey strong{color:var(--macro);}
#v-micro .bkey strong{color:var(--micro);}
.hidden{display:none!important;}

/* ── MACRO CATEGORY COLOURS ── */
.cat-ppf .fc-f::before{background:linear-gradient(90deg,#06b6d4,#3b82f6);}
.cat-ppf .ccat{color:#06b6d4;}
.cat-adas .fc-f::before{background:linear-gradient(90deg,#3b82f6,#6366f1);}
.cat-adas .ccat{color:#3b82f6;}
.cat-inflation .fc-f::before{background:linear-gradient(90deg,#ef4444,#f97316);}
.cat-inflation .ccat{color:#ef4444;}
.cat-deflation .fc-f::before{background:linear-gradient(90deg,#06b6d4,#3b82f6);}
.cat-deflation .ccat{color:#06b6d4;}
.cat-unemployment .fc-f::before{background:linear-gradient(90deg,#8b5cf6,#6366f1);}
.cat-unemployment .ccat{color:#8b5cf6;}
.cat-growth .fc-f::before{background:linear-gradient(90deg,#10b981,#06b6d4);}
.cat-growth .ccat{color:#10b981;}
.cat-fiscal .fc-f::before{background:linear-gradient(90deg,#f59e0b,#eab308);}
.cat-fiscal .ccat{color:#f59e0b;}
.cat-monetary .fc-f::before{background:linear-gradient(90deg,#ec4899,#8b5cf6);}
.cat-monetary .ccat{color:#ec4899;}
.cat-exchange .fc-f::before{background:linear-gradient(90deg,#d946ef,#8b5cf6);}
.cat-exchange .ccat{color:#d946ef;}
.cat-trade .fc-f::before{background:linear-gradient(90deg,#f97316,#ef4444);}
.cat-trade .ccat{color:#f97316;}
.cat-tax .fc-f::before{background:linear-gradient(90deg,#84cc16,#10b981);}
.cat-tax .ccat{color:#84cc16;}
/* ── MICRO CATEGORY COLOURS ── */
.cat-markets .fc-f::before{background:linear-gradient(90deg,#10b981,#34d399);}
.cat-markets .ccat{color:#10b981;}
.cat-elasticity .fc-f::before{background:linear-gradient(90deg,#3b82f6,#60a5fa);}
.cat-elasticity .ccat{color:#60a5fa;}
.cat-surplus .fc-f::before{background:linear-gradient(90deg,#f59e0b,#fbbf24);}
.cat-surplus .ccat{color:#f59e0b;}
.cat-failure .fc-f::before{background:linear-gradient(90deg,#ef4444,#f87171);}
.cat-failure .ccat{color:#ef4444;}
.cat-labour .fc-f::before{background:linear-gradient(90deg,#8b5cf6,#a78bfa);}
.cat-labour .ccat{color:#a78bfa;}
.cat-costs .fc-f::before{background:linear-gradient(90deg,#ec4899,#f472b6);}
.cat-costs .ccat{color:#ec4899;}
.cat-structures .fc-f::before{background:linear-gradient(90deg,#06b6d4,#22d3ee);}
.cat-structures .ccat{color:#06b6d4;}
.cat-intervention .fc-f::before{background:linear-gradient(90deg,#84cc16,#a3e635);}
.cat-intervention .ccat{color:#84cc16;}

@media(max-width:700px){
  header{padding:0.85rem 1.1rem;}
  .home-cards{grid-template-columns:1fr;}
  #v-home{padding:2.5rem 1.1rem 2rem;}
  .bank-wrap{padding:1rem 1.1rem;}
  .stats{display:none;}
}
</style>
<style>
.back-btn{display:inline-flex;align-items:center;gap:6px;color:#94a3b8;text-decoration:none;
font-size:0.85rem;padding:6px 12px;border-radius:8px;border:1px solid #334155;
margin-bottom:8px;transition:color .2s,border-color .2s}
.back-btn:hover{color:#f1f5f9;border-color:#64748b}

.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.25rem;padding:1rem 1.25rem 2rem;}
@media(max-width:600px){
  .grid{grid-template-columns:1fr 1fr;gap:0.75rem;padding:0.75rem;}
  .cdiag svg{min-height:120px;}
  .ctit h3{font-size:0.78rem;}
}
@media(max-width:380px){
  .grid{grid-template-columns:1fr;}
}

</style>
</head>
<body>
<div class="app">
  <header class="hdr">
    <a class="back-btn" href="index.html">&#8592; Home</a>
    <h1>BIZ-OMICS</h1>
    <p class="tagline">Microeconomics Flashcards</p>
  </header>
  <div class="toolbar">
    <input id="miSearch" class="search" type="search" placeholder="Search cards…" oninput="miSearchFn()">
    <button class="tbtn" onclick="miShuffle()">&#8644; Shuffle</button>
    <button class="tbtn" onclick="miReset()">&#8634; Reset</button>
  </div>
  <div class="stats-bar" id="miStats"></div>
  <div class="filter-bar">
    <button class="fbtn active" onclick="miF('all',this)">All</button>
    <button class="fbtn" onclick="miF('markets',this)">Markets</button>
    <button class="fbtn" onclick="miF('elasticity',this)">Elasticity</button>
    <button class="fbtn" onclick="miF('welfare',this)">Welfare & Surplus</button>
    <button class="fbtn" onclick="miF('failure',this)">Market Failure</button>
    <button class="fbtn" onclick="miF('intervention',this)">Intervention</button>
    <button class="fbtn" onclick="miF('labour',this)">Labour Markets</button>
    <button class="fbtn" onclick="miF('costs',this)">Cost Theory</button>
    <button class="fbtn" onclick="miF('revenue',this)">Revenue & Profit</button>
    <button class="fbtn" onclick="miF('structures',this)">Market Structures</button>
  </div>
  <div class="grid" id="miGrid"></div>
</div>
<script>
// ═══ MICRO: COLOUR CONSTANTS + SVG FUNCTIONS + CARD DATA ═══
const miCards=[{id:1,category:'markets',catLabel:'Markets',concept:'Demand Curve',diagramType:'demand',explanation:'The demand curve shows the inverse relationship between price and quantity demanded, ceteris paribus — it slopes downward due to the substitution effect (higher price makes alternatives relatively cheaper) and the income effect (higher price reduces real purchasing power). A movement along the curve is caused solely by a price change; a shift of the entire curve is caused by non-price factors: income, tastes, prices of related goods, expectations, and population. Key assumption: ceteris paribus — all other factors held constant, which is a simplification since multiple factors change simultaneously in reality. Evaluation: the demand curve assumes rational consumers with perfect information — behavioural economics challenges this, showing that demand is also shaped by anchoring, default bias and loss aversion, which can cause demand curves to behave unexpectedly. Links to: PED, shifts in demand, consumer surplus, income and substitution effects.',keyPoint:'Downward-sloping: substitution + income effects. Movement along = price change. Shift = non-price factor (income, tastes, related goods, expectations). Evaluation: the curve aggregates all consumers — in practice, individual demand curves vary widely and may not always slope downward (Giffen goods, Veblen goods). Behavioural factors (habits, social norms) can make demand stickier than the model implies. Links: PED, Consumer Surplus, Normal/Inferior Goods, Substitutes/Complements. UK example: when Cadbury raised the price of Dairy Milk by 20% in 2022, quantity demanded contracted — a movement along the demand curve driven by the substitution effect toward cheaper confectionery.'},
{id:2,category:'markets',catLabel:'Markets',concept:'Supply Curve',diagramType:'supply',explanation:'The supply curve shows the positive relationship between price and quantity supplied, ceteris paribus — it slopes upward because higher prices make production more profitable, incentivising firms to expand output and attracting new entrants. A movement along the curve is caused by a price change; a shift of the entire curve occurs when non-price factors change: input costs, technology, taxes/subsidies, number of producers, expectations, and weather (for agriculture). Key assumption: firms are profit-maximisers — in reality, firms may have multiple objectives (revenue maximisation, satisficing, CSR) which alter their supply response. Evaluation: supply curves for some goods are highly inelastic in the short run (fixed capacity constraints) but become more elastic over time as firms invest — the time horizon matters enormously for predicting supply responses. Links to: PES, cost curves, producer surplus, shifts in supply.',keyPoint:'Upward-sloping: higher price → more profitable to supply. Movement along = price change. Shift = non-price factor (costs, technology, taxes, number of firms). Evaluation: supply curves are flatter (more elastic) in the long run as capacity adjusts — a distinction crucial for policy analysis. For agricultural goods, supply is extremely inelastic in the short run (crop already planted), causing volatile price swings. Links: PES, Producer Surplus, Cost Curves, Intervention. UK example: the 2022 energy price surge shifted the supply curve for energy-intensive products (glass, ceramics, steel) sharply left as marginal costs rose — output fell and prices rose, consistent with a leftward supply shift.'},
{id:3,category:'markets',catLabel:'Markets',concept:'Market Equilibrium',diagramType:'market',shift:'equilibrium',explanation:'Equilibrium occurs where quantity demanded equals quantity supplied (Qd = Qs) — at price P*, the market clears with no tendency for change. Above P*, excess supply creates downward pressure; below P*, excess demand creates upward pressure. The price mechanism coordinates millions of decentralised decisions through Adam Smith\'s invisible hand — no central planner required. Disequilibrium is self-correcting in competitive markets. Key assumption: the model assumes perfectly competitive conditions with flexible prices, perfect information, and no externalities. Evaluation: equilibrium is a theoretical benchmark, not a description of real markets — real markets are in continuous disequilibrium, converging toward equilibrium imperfectly. Speed of adjustment varies enormously: commodity markets adjust in seconds; housing markets take years. Market equilibrium maximises total welfare (CS + PS) only under perfect competition — externalities, information failures and market power all cause the free market equilibrium to diverge from the social optimum. Links to: consumer and producer surplus, DWL, market failure.',keyPoint:'P* where Qd = Qs. Price mechanism self-corrects: excess supply → P falls; excess demand → P rises. Evaluation: equilibrium maximises total welfare only under perfect competition — any market failure (externality, info asymmetry, market power) means the free market P* and Q* are not socially optimal, justifying intervention. Speed of adjustment varies: commodity markets (instant) vs housing (years). Links: CS/PS, DWL, Market Failure, PED/PES. UK example: UK used car market in 2021 — semiconductor shortage cut new car supply, raising P* sharply as demand surged; equilibrium took 18+ months to restore as supply chains recovered.'},
{id:4,category:'markets',catLabel:'Markets',concept:'Increase in Demand',diagramType:'market',shift:'demandRight',explanation:'When a non-price determinant raises demand — rising income (for normal goods), higher prices of substitutes, lower prices of complements, taste shifts, or positive expectations — the demand curve shifts rightward. This raises both P* and Q*, with supply responding along the existing curve. The transmission: ↑D → excess demand at old P* → price rises → ↑Qs and ↓Qd until new equilibrium. Key assumption: supply is held constant and slopes upward — the price rise is larger when supply is inelastic, and smaller when supply is elastic. Evaluation: the size of the price and quantity effects depend critically on PES — with inelastic supply (housing, agricultural land), a demand shift raises prices sharply with minimal output response; with elastic supply (manufactured goods), output rises with little price effect. Links to: PED, PES, normal/inferior goods, substitutes, consumer surplus.',keyPoint:'D right → P* ↑ and Q* ↑. Supply responds along existing curve. Size of effect: larger P rise when PES inelastic; larger Q rise when PES elastic. Evaluation: demand shifts are not always permanent — temporary demand surges (e.g. pandemic panic buying) create price spikes that reverse once supply adjusts. Long-run supply elasticity determines whether the economy adjusts through price or quantity. Links: PED, PES, Normal/Inferior Goods, Consumer Surplus. UK example: post-lockdown 2021 restaurant demand surged (pent-up demand + savings). Short-run PES was inelastic (staff shortages) → prices rose sharply. As labour supply adjusted over 12 months, prices stabilised — illustrating the importance of the time horizon.'},
{id:5,category:'markets',catLabel:'Markets',concept:'Increase in Supply',diagramType:'market',shift:'supplyRight',explanation:'When a non-price determinant raises supply — lower input costs, improved technology, more producers entering, subsidies, or favourable conditions — the supply curve shifts rightward. This lowers P* and raises Q*, with demand responding along the existing curve. The transmission: ↑S → excess supply at old P* → price falls → ↑Qd and ↓Qs until new equilibrium. Key assumption: demand slopes downward and is held constant. The price fall is larger when demand is inelastic, and smaller when demand is elastic. Evaluation: for agricultural goods, supply shifts can cause the \'cobweb\' problem — falling prices deter next season\'s investment, causing undersupply and price spikes, creating a self-perpetuating cycle of boom and bust that the static model cannot capture. Links to: PED, PES, producer surplus, subsidies, agricultural markets.',keyPoint:'S right → P* ↓ and Q* ↑. Demand responds along existing curve. Size: larger P fall when PED inelastic; larger Q rise when PED elastic. Evaluation: supply shifts can be temporary (weather, energy prices) or permanent (technology improvements) — the policy response and welfare analysis differ. Agricultural cobweb: low prices → undersupply next cycle → high prices → oversupply — a dynamic instability the static model misses. Links: PED, PES, Producer Surplus, Subsidies. UK example: rapid expansion of UK solar installation (2010–20) shifted supply right — costs fell 60%+ as more firms entered and technology improved, demonstrating how technology-driven supply shifts permanently reduce equilibrium price.'},
{id:6,category:'markets',catLabel:'Markets',concept:'Excess Demand (Shortage)',diagramType:'market',shift:'shortage',explanation:'A shortage occurs when price is held below equilibrium — Qd exceeds Qs. In a free market, upward price pressure would restore equilibrium. Persistent shortages arise from price ceilings (maximum prices) set below P*. Non-price rationing mechanisms emerge: queuing, waiting lists, lottery or black markets. Key assumption: the price mechanism is prevented from operating — in practice, parallel markets (black markets) often emerge to allocate the good at closer to the equilibrium price. Evaluation: the welfare analysis of shortages is nuanced — consumers who receive the good at below-equilibrium prices gain (lower price), but many are excluded entirely; black markets may charge above-equilibrium prices, transferring consumer surplus to black market suppliers. The DWL represents the welfare permanently destroyed. Links to: price ceiling, DWL, government intervention, black markets.',keyPoint:'P below P* → Qd > Qs → shortage → non-price rationing (queues, waiting lists, black markets). DWL created. Evaluation: shortages are not always welfare-reducing for all — the gainers (those allocated the good at below-P* prices) benefit; but chronic shortages reduce quality and availability over time as producers cut supply. Black markets emerge to clear excess demand, often at prices above P*, worsening welfare for those unable to access official allocation. Links: Price Ceiling, DWL, Government Intervention. UK example: NHS dental appointments since 2006 — NHS contract rates (a price ceiling set below market-clearing wages for dentists) created a chronic shortage; 12 million patients unable to register with an NHS dentist by 2023.'},
{id:7,category:'markets',catLabel:'Markets',concept:'Excess Supply (Surplus)',diagramType:'market',shift:'surplus',explanation:'A surplus occurs when price is held above equilibrium — Qs exceeds Qd. In a free market, downward price pressure would restore equilibrium. Persistent surpluses arise from price floors (minimum prices) set above P*. The surplus must be disposed of: government purchase and storage, export subsidies, or destruction. Key assumption: firms continue to produce at the floor price despite being unable to sell all output — in practice, firms may cut production over time if losses are unsustainable. Evaluation: price floors redistribute welfare from consumers (who pay higher prices and consume less) to producers (who receive higher prices on units sold). But producers who cannot sell at the floor price gain nothing. The unsold surplus represents wasted resources — a deadweight loss. Links to: price floor, DWL, minimum wage, agricultural policy.',keyPoint:'P above P* → Qs > Qd → surplus → government purchase, storage or destruction. DWL created. Evaluation: not all producers benefit from a price floor — only those who can sell at the floor price gain; those producing unsold surplus incur costs without revenue. Higher prices hurt consumers, particularly low-income households who spend a larger share of income on the affected goods. Links: Price Floor, DWL, Minimum Wage, Agricultural Policy. UK example: EU Common Agricultural Policy price floors created \'butter mountains\' and \'wine lakes\' in the 1980s — surplus bought by EU intervention boards at taxpayer cost, then sold below world price (export subsidies), distorting global food markets.'},
{id:8,category:'markets',catLabel:'Markets',concept:'Substitutes — Cross-Price Demand',diagramType:'substitutes',explanation:'Substitutes are goods in competitive demand — when the price of Good A rises, consumers switch to Good B, increasing demand for B. The cross-price elasticity of demand (XED) is positive for substitutes: XED = % change in Qd of B / % change in price of A > 0. The closer the substitutes, the higher the XED. Perfect substitutes (identical goods) have very high XED. Distant substitutes (e.g. bus vs private jet) have XED close to zero. Key assumption: consumers are rational and respond to relative prices by switching — in practice, habit, brand loyalty and switching costs reduce the substitution response. Evaluation: firms use cross-price demand to assess competitive threats — a high positive XED indicates strong competition; firms may respond with branding and product differentiation to reduce substitutability. Links to: PED, complements, branding, market structures.',keyPoint:'Substitutes: ↑ price of A → ↑ demand for B. XED > 0. Closer substitutes → higher XED. Evaluation: brand loyalty and switching costs reduce the XED below its theoretical level — firms invest in brand differentiation precisely to lower their XED and gain pricing power. In online markets with easy price comparison, XED is higher and competition more intense. Links: PED, Complements, Branding, Market Structures. UK example: when UK petrol prices spiked in 2022, demand for electric vehicles and public transport rose — a positive cross-price effect consistent with substitutes, though habit and infrastructure constraints dampened the speed of switching.'},
{id:'8b',category:'markets',catLabel:'Markets',concept:'Complements — Cross-Price Demand',diagramType:'complements',explanation:'Complements are goods in joint demand — they are consumed together, so when the price of Good A rises, demand for Good B falls. The cross-price elasticity of demand (XED) is negative for complements: XED = % change in Qd of B / % change in price of A < 0. The stronger the complementary relationship, the more negative the XED. Perfect complements (e.g. left and right shoes) have a very large negative XED. Key assumption: the joint consumption relationship is fixed — in reality, consumers can sometimes substitute away from both goods or change the intensity of joint use. Evaluation: firms exploit complementary demand through loss-leader pricing — pricing one good low (razor handles, printers) to lock consumers into high-margin complements (razor blades, ink cartridges). This is a form of price discrimination and product bundling. Links to: PED, substitutes, loss-leader pricing, bundling.',keyPoint:'Complements: ↑ price of A → ↓ demand for B. XED < 0. Stronger complement → more negative XED. Evaluation: complement relationships create lock-in — once consumers have invested in one good, they are less price-sensitive to the complement (explaining high ink cartridge prices). Regulators have intervened in some markets (e.g. printer ink) to break exploitative complement pricing. Links: PED, Substitutes, Price Discrimination, Loss-Leader Pricing. UK example: rising mortgage rates (2022–23) raised the \'price\' of home purchase → demand for DIY home improvement products fell as fewer people moved house, consistent with a negative cross-price effect between mortgages and home furnishings.'},
{id:'8c',category:'markets',catLabel:'Markets',concept:'Normal Good — Income and Demand',diagramType:'normalGood',explanation:'A normal good has a positive income elasticity of demand (YED > 0) — as income rises, demand rises. Luxuries (YED > 1) see demand rise proportionally more than income; necessities (0 < YED < 1) see demand rise proportionally less. The income-demand relationship shifts the demand curve: a rise in real income shifts demand rightward for normal goods. Key assumption: the good\'s character (normal vs inferior) may change at different income levels — a good that is normal at low income may become inferior at high income as consumers trade up. Evaluation: YED is important for business planning — firms producing luxury goods (high YED) face volatile demand over the business cycle; producers of necessities enjoy stable demand. During recessions, luxury demand falls sharply while necessities are resilient. Links to: income elasticity, inferior goods, business cycle, consumer spending.',keyPoint:'Normal good: ↑ income → ↑ demand (D shifts right). YED > 0. Luxury: YED > 1. Necessity: 0 < YED < 1. Evaluation: income elasticity determines vulnerability to recession — luxury producers (YED > 1) face sharp demand falls in downturns; necessity producers are insulated. This shapes risk profiles and pricing strategies across the business cycle. Links: YED, Inferior Goods, Business Cycle, Demand Curve. UK example: UK private school enrolment (luxury, high YED) fell during the 2008 recession as household incomes dropped — consistent with a high positive income elasticity. Meanwhile, demand for budget supermarkets (Aldi, Lidl) rose as consumers traded down.'},
{id:'8d',category:'markets',catLabel:'Markets',concept:'Inferior Good — Income and Demand',diagramType:'inferiorGood',explanation:'An inferior good has a negative income elasticity of demand (YED < 0) — as income rises, demand falls as consumers substitute toward higher-quality alternatives. Classic examples include own-brand foods, bus travel, and low-quality clothing. The income effect of a price change works in the opposite direction for inferior goods — a fall in price raises real income, but the resulting income effect partially offsets the substitution effect. For Giffen goods (an extreme inferior good), the income effect dominates, creating an upward-sloping demand curve. Evaluation: the inferior good classification is income-level specific — a good may be inferior at high incomes but normal at low incomes. The distinction matters for predicting how demand changes during recessions (rises) vs booms (falls). Links to: YED, normal goods, Giffen goods, income and substitution effects.',keyPoint:'Inferior good: ↑ income → ↓ demand (D shifts left). YED < 0. Demand rises in recessions, falls in booms. Giffen good: income effect > substitution effect → upward-sloping demand (extremely rare). Evaluation: inferior good status changes over time — bus travel was an inferior good in the 1970s–80s when car ownership rose, but is becoming more normal as environmental concerns and congestion change preferences. Links: YED, Normal Goods, Giffen Goods, Income Effect. UK example: Aldi and Lidl UK market share rose from 5% (2010) to 18% (2023) — partly reflecting the inferior good dynamic as real incomes fell during the 2010s austerity period and cost-of-living crisis, with consumers switching to budget alternatives.'},
{id:9,category:'elasticity',catLabel:'Elasticity',concept:'Price Inelastic Demand',diagramType:'ped',shift:'inelastic',explanation:'Price inelastic demand (|PED| < 1) means a given percentage price change causes a smaller percentage change in quantity demanded. It arises when goods have few close substitutes, are necessities, are habit-forming, represent a small share of income, or when consumers have little time to adjust. The flatter the demand curve in a PED diagram (all else equal), the more inelastic. Key assumption: PED is measured at a point on the curve — it typically varies along a linear demand curve, being more inelastic at high prices. Evaluation: inelastic demand gives firms pricing power — a price rise increases total revenue (TR = P × Q rises when |PED| < 1). However, the degree of inelasticity depends on the breadth of definition: \'petrol\' is inelastic; \'Shell petrol specifically\' is elastic. Links to: total revenue, tax incidence, pricing strategy, substitutes.',keyPoint:'|PED| < 1. ↑ Price → small ↓ Qd → TR rises. Common in necessities, addictive goods, goods with few substitutes. Evaluation: firms with inelastic demand can raise prices to increase revenue, but face regulatory scrutiny (monopoly abuse) and long-run substitution as consumers eventually find alternatives or change behaviour. Tax incidence falls more heavily on consumers when demand is inelastic. Links: Total Revenue, Tax Incidence, Pricing Power, Substitutes. UK example: UK cigarette demand is highly inelastic (PED ≈ −0.3 to −0.5) — successive tobacco duty rises have raised government revenue substantially while reducing consumption only modestly, consistent with inelastic demand.'},
{id:10,category:'elasticity',catLabel:'Elasticity',concept:'Price Elastic Demand',diagramType:'ped',shift:'elastic',explanation:'Price elastic demand (|PED| > 1) means a given percentage price change causes a larger percentage change in quantity demanded. It arises when goods have many close substitutes, are luxuries, represent a large share of income, are broadly defined, or when consumers have time to adjust. Key assumption: the availability of substitutes is the primary determinant — \'food\' is inelastic but \'a particular restaurant\' is elastic. Evaluation: elastic demand limits firms\' pricing power — a price rise reduces total revenue (TR falls when |PED| > 1). This matters for firms setting prices and for governments designing taxes — a tax on an elastically demanded good raises little revenue but causes significant output reduction. Competition policy focuses on maintaining elastic demand by preventing monopoly. Links to: total revenue, tax incidence, competition, substitutes.',keyPoint:'|PED| > 1. ↑ Price → large ↓ Qd → TR falls. Common in luxuries, goods with many substitutes, broadly defined markets. Evaluation: elastic demand disciplines pricing — firms competing in elastic markets must hold prices close to costs. The internet has increased PED in many retail markets by reducing search costs and making substitutes more visible. Links: Total Revenue, Tax Incidence, Competition, Substitutes. UK example: the UK package holiday market is price elastic — consumers can easily compare and switch between operators (low switching costs, many substitutes). Tour operators regularly discount unsold holidays, consistent with highly elastic demand.'},
{id:11,category:'elasticity',catLabel:'Elasticity',concept:'PED Along a Demand Curve',diagramType:'pedAlong',explanation:'Along a linear downward-sloping demand curve, PED varies continuously — it is not constant. At high prices and low quantities (upper portion), demand is elastic (|PED| > 1); at the midpoint, |PED| = 1 (unit elastic, TR is maximised); at low prices and high quantities (lower portion), demand is inelastic (|PED| < 1). This occurs because PED measures percentage changes — the same absolute price change is a larger percentage at a low base price. Key assumption: the demand curve is linear — non-linear curves have different PED profiles, but the general principle of varying elasticity along the curve holds. Evaluation: this is crucial for pricing strategy — a profit-maximising firm or revenue-maximising firm should not simply look at the slope of the demand curve; the relevant measure is PED at the current price, which tells them whether raising or cutting price will increase revenue. Links to: total revenue, revenue maximisation, pricing, MR.',keyPoint:'Linear D curve: elastic at top (|PED| > 1), unit elastic at midpoint (MR = 0, TR max), inelastic at bottom (|PED| < 1). PED not constant along a straight line. Evaluation: firms must know where on the demand curve they are operating — setting price in the inelastic region means a price cut reduces TR; in the elastic region, a price cut raises TR. Revenue-maximising firms price at the midpoint (MR = 0). Links: Total Revenue, MR, Revenue Maximisation, Pricing Strategy. UK example: UK rail operators know their peak commuter demand is inelastic (upper curve) — they charge premium peak fares. Leisure travellers face elastic demand (many substitutes) — they receive cheap advance tickets, placing them on the lower, inelastic portion.'},
{id:12,category:'elasticity',catLabel:'Elasticity',concept:'Price Inelastic Supply',diagramType:'pes',shift:'inelastic',explanation:'Price inelastic supply (PES < 1) means a given percentage price rise causes a smaller percentage increase in quantity supplied. It arises when: production takes a long time (agriculture, construction), capacity is fixed in the short run, goods are perishable or storage is impossible, or specialist inputs are scarce. Key assumption: PES is time-dependent — nearly all supply is inelastic in the very short run (stock on shelf) and becomes more elastic over time as producers can adjust inputs. Evaluation: inelastic supply means price rises are large when demand increases — most of the adjustment occurs through price rather than quantity. For primary commodities (oil, agricultural produce), inelastic supply causes volatile price movements in response to demand shocks. Tax incidence falls more on producers when supply is inelastic. Links to: PES, tax incidence, agricultural markets, time periods.',keyPoint:'PES < 1. ↑ Price → small ↑ Qs. Common in agriculture, construction, commodities with fixed capacity. Evaluation: inelastic supply causes price volatility — a demand surge causes large price rises when supply cannot respond. Policy responses include buffer stocks (agricultural intervention) and strategic reserves (oil). Tax incidence: more on producer when PES inelastic. Links: PED, Tax Incidence, Buffer Stocks, Time Periods. UK example: UK housing supply is highly inelastic (planning restrictions, long construction times) — rising demand from population growth and household formation consistently raises house prices with little supply response, creating chronic affordability problems.'},
{id:13,category:'elasticity',catLabel:'Elasticity',concept:'Price Elastic Supply',diagramType:'pes',shift:'elastic',explanation:'Price elastic supply (PES > 1) means a given percentage price rise causes a larger percentage increase in quantity supplied. It arises when: production can be increased quickly (manufactured goods, services), inputs are readily available and mobile, goods can be easily stored, and firms have spare capacity. In the long run, supply is more elastic as firms can expand capacity, enter the market, or shift production. Key assumption: spare capacity exists — when capacity is fully utilised, supply becomes inelastic regardless of time horizon. Evaluation: elastic supply stabilises prices — when demand shifts, most of the adjustment occurs through quantity rather than price, benefiting consumers through stable prices. For industries with elastic supply (e.g. clothing, electronics), globalisation and offshoring have made supply even more elastic by drawing on global capacity. Links to: PES, price stability, capacity, long run.',keyPoint:'PES > 1. ↑ Price → large ↑ Qs. Common in manufacturing, services with spare capacity, goods with easily available inputs. Evaluation: elastic supply protects consumers from price volatility — demand surges lead to quantity increases rather than price spikes. Globalisation has increased PES in many manufacturing markets by allowing production to shift to lower-cost countries with spare capacity. Links: PED, Price Stability, Globalisation, Long Run. UK example: UK online retail supply (Amazon, eBay marketplace) is highly elastic — sellers can quickly scale fulfilment in response to demand shifts, keeping prices stable and passing competition on through choice rather than price.'},
{id:14,category:'welfare',catLabel:'Welfare & Surplus',concept:'Consumer and Producer Surplus',diagramType:'surplus',shift:'base',explanation:'Consumer surplus (CS) is the difference between what consumers are willing to pay and what they actually pay — the triangle above the equilibrium price and below the demand curve. Producer surplus (PS) is the difference between the price producers receive and their minimum acceptable price — the triangle below the equilibrium price and above the supply curve. Total welfare (CS + PS) is maximised at the free market equilibrium under perfect competition. Key assumption: the diagram assumes no externalities — in the presence of external costs or benefits, the private equilibrium does not maximise social welfare. Evaluation: CS and PS are measures of allocative efficiency — any deviation from free market equilibrium (through taxes, price controls, monopoly) reduces total surplus and creates deadweight loss. The distribution between CS and PS also matters for equity. Links to: DWL, price controls, monopoly, allocative efficiency.',keyPoint:'CS = area above P*, below D. PS = area below P*, above S. Total welfare = CS + PS, maximised at free market equilibrium (under perfect competition). Evaluation: total welfare maximisation ignores distribution — a monopoly that takes all CS as profit maximises its own surplus but reduces social welfare. Externalities mean the free market P* and Q* do not maximise social welfare. Links: DWL, Price Controls, Monopoly, Market Failure. UK example: the introduction of budget airlines (easyJet, Ryanair) in the 1990s dramatically expanded CS in UK air travel — consumers willing to pay £200 for flights now paid £30, generating large consumer surplus previously captured as profit by legacy carriers.'},
{id:15,category:'welfare',catLabel:'Welfare & Surplus',concept:'Price Rise: Welfare Effects',diagramType:'surplus',shift:'priceRise',explanation:'When price rises above the competitive equilibrium — due to monopoly, taxation or a price floor — consumer surplus shrinks. Part of the lost CS transfers to producers (who receive a higher price on units still sold — a transfer, not a net welfare loss). The remainder is permanently destroyed as a deadweight loss (DWL) triangle — output that would have created net welfare is no longer produced. Only at P* is total welfare maximised. Key assumption: the analysis assumes the supply and demand curves accurately represent social costs and benefits — in the presence of externalities, a price rise above P* may actually improve social welfare if the good was being overproduced. Evaluation: the DWL is the most important measure of inefficiency from price distortions — it quantifies the pure welfare loss that benefits no one. Policymakers face a trade-off between efficiency (minimising DWL) and equity (redistribution from consumers to producers). Links to: CS/PS, DWL, monopoly, taxation.',keyPoint:'↑ P above P* → CS falls. Part transfers to PS (not a welfare loss). Remainder = DWL (pure waste — benefits no one). Evaluation: the DWL rises disproportionately with the size of the price distortion — doubling the price rise quadruples the DWL (triangle area). The policy implication: large distortions are far more costly than small ones. Links: CS/PS, DWL, Monopoly, Taxation, Price Floor. UK example: Pfizer\'s monopoly pricing of Lipitor before UK patent expiry (2012) kept prices at £30/pack vs £1.50 generic after — the price differential represented a large CS transfer to producer surplus, plus a DWL from patients who did not take the drug at monopoly prices.'},
{id:16,category:'welfare',catLabel:'Welfare & Surplus',concept:'Total Revenue = P x Q',diagramType:'totalRevenue',explanation:'Total revenue (TR) is represented as the rectangle beneath the demand curve at equilibrium — P multiplied by Q. Whether a price change raises or lowers TR depends entirely on PED. If demand is inelastic (|PED| < 1), a price rise increases TR because the proportional quantity fall is smaller than the proportional price rise. If elastic (|PED| > 1), a price rise reduces TR. TR is maximised where MR = 0, at the midpoint of a linear demand curve where |PED| = 1 (unit elastic). Key assumption: TR refers to revenue, not profit — maximising TR is not the same as maximising profit (which requires subtracting costs). Evaluation: the TR test is a useful shortcut for firms assessing pricing decisions — but it tells firms about revenue only. A firm chasing revenue maximisation (MR = 0) will produce more output than a profit-maximiser (MC = MR), which requires comparing TR against cost. Links to: PED, MR, profit maximisation, revenue maximisation.',keyPoint:'TR = P × Q (area of rectangle under D curve). |PED| < 1: ↑P → ↑TR. |PED| > 1: ↑P → ↓TR. |PED| = 1: TR maximised (MR = 0). Evaluation: the TR–PED relationship is mechanically useful but firms must not confuse revenue maximisation with profit maximisation — beyond the MR = 0 output, each extra unit adds to revenue but less than it costs, destroying profit. Links: PED, MR, Profit Maximisation, Revenue Maximisation. UK example: the UK government\'s sugar levy (2018) relied on inelastic demand for sugary drinks — if demand were elastic, the tax base would collapse as consumers switched, reducing revenue. The levy raised £340m in its first year, consistent with relatively inelastic demand.'},
{id:17,category:'failure',catLabel:'Market Failure',concept:'Negative Production Externality',diagramType:'externality',shift:'negProd',explanation:'A negative production externality occurs when a firm\'s production imposes costs on third parties not reflected in the market price — the marginal social cost (MSC) exceeds the marginal private cost (MPC). The free market produces at Qm where MPC = MPB, but the social optimum is Qs < Qm where MSC = MSB. The market overproduces relative to the social optimum. The welfare loss triangle between Qm and Qs represents the net external cost imposed on society. Key assumption: the externality is not priced into the market — if it were (via a Pigouvian tax), the externality would be internalised. Evaluation: measuring the marginal external cost (MEC) is extremely difficult in practice — estimates for carbon\'s social cost range from $15 to $400 per tonne, making policy calibration uncertain. Government intervention risks government failure if the MEC is mismeasured. Links to: Pigouvian tax, government intervention, MSC, allocative efficiency.',keyPoint:'MSC > MPC → overproduction at Qm. Social optimum Qs < Qm. DWL = welfare loss from overproduction. Corrective tool: Pigouvian tax equal to MEC, shifting MPC up to MSC. Evaluation: internalising externalities via taxes is theoretically optimal but politically difficult — carbon pricing faces opposition from energy-intensive industries. Regulation (quantity limits) may be preferable when the MEC is unknown. Links: Pigouvian Tax, Regulation, MSC, Market Failure. UK example: UK industrial air pollution imposes external costs on health and environment — the EU ETS and UK Emissions Trading Scheme attempt to price carbon externalities, though permit prices have been volatile, making the signal uncertain.'},
{id:18,category:'failure',catLabel:'Market Failure',concept:'Positive Production Externality',diagramType:'externality',shift:'posProd',explanation:'A positive production externality occurs when production creates benefits for third parties not captured in the market price — the MSC is below the MPC (or MSB exceeds MPB). The free market underproduces at Qm; the social optimum is Qs > Qm. The welfare triangle between Qm and Qs represents unrealised social benefits — output that would create positive net social value is not being produced. Key assumption: the external benefit is real and not captured by the producer — if firms could appropriate all benefits (e.g. through patents), they would produce at the social optimum. Evaluation: positive production externalities provide the economic rationale for R&D subsidies and knowledge spillover policies — but measuring the MSB of innovation is extremely difficult, risking government subsidy to activities with limited spillovers. Links to: subsidies, R&D, MSB, knowledge spillovers.',keyPoint:'MSC < MPC (or MSB > MPB) → underproduction at Qm. Social optimum Qs > Qm. Corrective tool: subsidy equal to MEB, shifting MPC down to MSC. Evaluation: positive production externalities justify industrial policy — but governments risk picking winners that do not generate the expected spillovers. The UK\'s industrial strategy has a mixed record. Links: Subsidies, R&D, Industrial Policy, Market Failure. UK example: UK pharmaceutical R&D generates knowledge spillovers across the industry — AstraZeneca\'s COVID vaccine research built on decades of publicly funded university science. The 230% R&D tax credit aims to internalise this positive externality and stimulate private investment.'},
{id:19,category:'failure',catLabel:'Market Failure',concept:'Negative Consumption Externality',diagramType:'externality',shift:'negCons',explanation:'A negative consumption externality arises when consuming a good harms third parties — the marginal social benefit (MSB) is below the marginal private benefit (MPB). The free market overconsumes at Qm > Qs. The DWL triangle represents welfare destroyed by excessive consumption. Corrective tools include taxes, regulation, advertising restrictions and information campaigns. Key assumption: the external cost is borne by identifiable third parties — in reality, diffuse externalities (e.g. passive smoking affecting millions) are harder to quantify than localised ones. Evaluation: negative consumption externalities are often associated with demerit goods — goods that individuals overconsume because they are unaware of or ignore the full costs to themselves and others. Information failure (underestimating future health costs) compounds the market failure. Links to: demerit goods, information failure, taxation, regulation.',keyPoint:'MSB < MPB → overconsumption at Qm. Social optimum Qs < Qm. DWL between Qs and Qm. Corrective tools: tax, regulation, information campaigns. Evaluation: taxes address the external cost mechanically but cannot correct information failure or addiction — for demerit goods, education and nudge policies may be more effective at changing preferences. Links: Demerit Goods, Information Failure, Taxation, Regulation. UK example: UK alcohol consumption imposes external costs on NHS (£3.5bn/year), police and crime victims. PHE estimated total external cost at £21bn/year — far exceeding private costs to drinkers, confirming a large negative consumption externality. Minimum unit pricing in Scotland attempts to internalise it.'},
{id:20,category:'failure',catLabel:'Market Failure',concept:'Positive Consumption Externality',diagramType:'externality',shift:'posCons',explanation:'A positive consumption externality arises when consuming a good benefits third parties — MSB exceeds MPB. The free market underconsumes at Qm < Qs. The DWL between Qm and Qs represents unrealised welfare. Corrective tools include subsidies, government provision, or information campaigns to raise private demand. Key assumption: the external benefit is genuine and not simply a distributional concern — true externalities create benefits for non-consenting third parties, not merely preferences of observers. Evaluation: the case for government intervention rests on accurately measuring the MSB — for education, estimates of the external benefit vary widely, from 5% to 30% above private returns, making the optimal subsidy uncertain. Over-subsidising risks government failure. Links to: subsidies, merit goods, MSB, education, vaccination.',keyPoint:'MSB > MPB → underconsumption at Qm. Social optimum Qs > Qm. Corrective tools: subsidy, government provision, information. Evaluation: positive externalities provide the strongest argument for universal public provision — when the external benefit is large and universal (vaccination herd immunity), free provision achieves optimal consumption more reliably than subsidies. Links: Merit Goods, Subsidies, Government Provision, Market Failure. UK example: UK childhood vaccination generates herd immunity benefiting the entire population. NHS free provision (an infinite subsidy) achieves near-universal uptake — private market provision would underprovide as individuals undervalue the external benefit to others.'},
{id:21,category:'failure',catLabel:'Market Failure',concept:'Corrective (Pigouvian) Tax',diagramType:'externality',shift:'corrTax',explanation:'A Pigouvian tax sets the per-unit tax equal to the marginal external cost (MEC) at the social optimum, shifting MPC up to coincide with MSC. The market output falls from Qm to Qs, eliminating the DWL. The tax also raises government revenue which can be recycled. Named after Arthur Pigou (1920). Key assumption: the MEC can be accurately measured — in practice, calculating the marginal damage from pollution, congestion or health externalities involves enormous uncertainty. A second assumption is that the tax is set correctly and does not create its own distortions. Evaluation: Pigouvian taxes are theoretically superior to regulation (more flexible, raise revenue) but face practical difficulties — lobbying from affected industries, distributional concerns (regressive if on necessities), and international competitiveness issues if applied unilaterally. Links to: negative externalities, DWL, regulation, carbon tax.',keyPoint:'Tax = MEC → MPC shifts up to MSC → output falls from Qm to Qs. DWL eliminated. Revenue raised. Evaluation: Pigouvian taxes are efficient but may be regressive — a carbon tax on fuel hits lower-income households harder as a share of income. Revenue recycling (cutting income tax or paying dividends) can address this. International carbon leakage: unilateral carbon taxes may push emissions to uncapped countries. Links: Negative Externality, DWL, Carbon Tax, Regulation. UK example: the UK Carbon Price Support tax (CPS) charges power generators per tonne of CO₂ — contributed to coal\'s share of UK electricity falling from 40% (2012) to near zero (2024), demonstrating an effective Pigouvian tax response.'},
{id:'22b',category:'failure',catLabel:'Market Failure',concept:'Merit Good — Information Failure',diagramType:'meritGood',explanation:'A merit good is one that is underprovided by the free market because individuals underestimate its private benefits — typically due to information failure, short-sightedness, or present bias. Examples include education, healthcare and exercise. The social optimum consumption exceeds the free market level. Information failure means MPB understates the true private benefit, so the demand curve lies below where it should be. Key assumption: the government has better information about private benefits than consumers — this is contestable; paternalism can misidentify merit goods and impose preferences. Evaluation: the merit good concept is closely related to but distinct from positive consumption externalities — a merit good may have no external benefit (only a private benefit the consumer undervalues). The justification for intervention is paternalism, which raises philosophical concerns about individual autonomy. Links to: information failure, positive externality, subsidies, education.',keyPoint:'Merit good: private benefit underestimated due to information failure → underconsumption. Social optimum > free market output. Corrective tools: subsidies, free provision, advertising, regulation. Evaluation: the merit good argument is paternalistic — governments assume they know consumers\' true preferences better than consumers themselves. This risks over-provision and dependency. The distinction between merit goods (information failure) and positive externalities (third-party benefits) matters for policy design. Links: Information Failure, Positive Externality, Subsidies, Education. UK example: NHS free healthcare is partly justified as a merit good — patients underestimate the long-run value of preventive health due to present bias, leading to underconsumption of check-ups and vaccinations without intervention.'},
{id:'22c',category:'failure',catLabel:'Market Failure',concept:'Demerit Good — Information Failure',diagramType:'demeritGood',explanation:'A demerit good is one that is overconsumed relative to the social optimum because individuals overestimate its private benefits or underestimate its private costs — typically due to information failure, addiction, or present bias. Examples include cigarettes, alcohol and recreational drugs. The free market overconsumes because MPB overstates the true private benefit. Key assumption: the government has accurate information about the true private costs — this is contestable; individual valuations of risky behaviour vary widely and governments may overestimate harm. Evaluation: the demerit good justification combines information failure with paternalism — it implies consumers make mistakes that the government can correct. Critics argue this erodes freedom of choice; proponents argue behavioural economics shows systematic biases that justify nudge interventions. Links to: information failure, negative externality, taxation, regulation, addiction.',keyPoint:'Demerit good: private costs underestimated (or benefits overestimated) → overconsumption. Social optimum < free market output. Tools: tax, advertising bans, regulation, plain packaging, nudge. Evaluation: demerit good policies that restrict information (plain packaging) are more liberty-preserving than outright bans, but less certain in their effect. Addiction makes information provision ineffective — addicted consumers cannot easily respond to accurate cost information. Links: Information Failure, Negative Externality, Taxation, Behavioural Economics. UK example: UK plain cigarette packaging (2016) was a nudge-based demerit good intervention — removing brand imagery reduces the perceived private benefit of smoking, correcting information failure without raising prices or restricting supply.'},
{id:41,category:'intervention',catLabel:'Intervention',concept:'Indirect Tax (Specific)',diagramType:'indirectTax',explanation:'A specific (unit) indirect tax is a fixed amount per unit, shifting the supply curve vertically upward by the tax amount. The market price rises by less than the full tax — the incidence is shared between consumers (who pay a higher price) and producers (who receive a lower net price). The share borne by each depends on relative elasticities: when demand is more inelastic than supply, consumers bear more of the tax; when supply is more inelastic, producers bear more. Key assumption: the tax is set at a fixed per-unit amount regardless of price — unlike an ad valorem tax which is proportional to price. Evaluation: specific taxes are simple but lose real value with inflation (the £per unit stays fixed while prices rise). They create DWL — the optimal Pigouvian tax minimises DWL by correcting an externality, but a revenue-raising tax creates DWL with no offsetting external benefit. Links to: tax incidence, PED, PES, DWL, Pigouvian tax.',keyPoint:'Specific tax → S shifts up by tax amount. Price rises by less than tax — shared incidence. Consumer burden: (tax × ΔP/tax). Producer burden: (tax − consumer burden). Evaluation: the more inelastic the demand, the greater the consumer burden and the larger the revenue raised — but also the larger the regressive impact on lower-income consumers. DWL is smaller when demand is inelastic (less output lost). Links: Tax Incidence, PED, PES, DWL, Pigouvian Tax. UK example: UK fuel duty (57.95p/litre) is a specific tax — demand for fuel is relatively inelastic (few substitutes for car use in rural areas), so consumers bear most of the incidence. Revenue: £25bn/year.'},
{id:46,category:'intervention',catLabel:'Intervention',concept:'Ad Valorem Tax',diagramType:'adValorem',explanation:'An ad valorem tax is a percentage of the price (e.g. VAT at 20%), so the supply curve pivots (rotates) rather than shifting in parallel — the tax wedge is larger at higher prices. This means the DWL and revenue effects are proportionally larger at higher price levels. Like specific taxes, incidence is shared based on relative elasticities. Key assumption: the percentage is applied to the pre-tax price — in practice, UK VAT is calculated on the pre-tax price and added on top. Evaluation: ad valorem taxes automatically rise in real value with inflation (unlike specific taxes), maintaining their real revenue yield. However, they may be less effective as Pigouvian tools because the external cost per unit is typically fixed (not proportional to price), making a specific tax more precisely targeted. Links to: specific tax, VAT, tax incidence, PED.',keyPoint:'Ad valorem tax → S curve pivots (larger wedge at higher prices). Tax = % of price. Revenue and DWL larger at higher price points. Evaluation: ad valorem taxes are administratively simpler for multi-price markets (VAT applies uniformly) but less precise as corrective tools — the optimal Pigouvian corrective tax should equal MEC, which is usually a fixed amount per unit, not a percentage. Links: Specific Tax, VAT, Tax Incidence, PED. UK example: UK VAT (20%) is an ad valorem tax — the supply curve for taxable goods pivots. As UK inflation pushed prices up in 2022–23, VAT revenue rose proportionally, providing an automatic revenue boost to the Treasury compared to a fixed specific tax.'},
{id:42,category:'intervention',catLabel:'Intervention',concept:'Producer Subsidy',diagramType:'subsidy',explanation:'A producer subsidy shifts the supply curve rightward (downward) by the subsidy amount, reducing the market price and increasing output. The benefit is shared between consumers (lower price) and producers (higher net price received including subsidy) — the division depends on relative elasticities. The government bears the cost (subsidy per unit × quantity produced), which must be funded through taxation. Key assumption: the subsidy reaches producers, not intermediaries — in practice, subsidy pass-through varies and some benefit may be absorbed by distributors. Evaluation: subsidies correct positive externalities and merit good underconsumption, but create government expenditure costs and risk dependency. If the subsidy props up inefficient producers, it creates long-run allocative inefficiency. WTO rules restrict agricultural subsidies to prevent trade distortions. Links to: positive externality, merit goods, DWL, government failure.',keyPoint:'Subsidy → S shifts right/down by subsidy amount. Price falls, output rises. Shared benefit: consumers (lower P) and producers (higher net P). Government cost = subsidy × Q. Evaluation: subsidies are less visible than taxes but create long-run dependency and government expenditure obligations. Agricultural subsidies (UK\'s ELMS) face WTO scrutiny and risk over-producing goods regardless of market demand. Links: Positive Externality, Merit Goods, Government Failure, DWL. UK example: the UK\'s 30-hours free childcare subsidy reduces the price of childcare to parents — a producer subsidy shifting supply right and lowering P, addressing the positive externality from early years education and correcting merit good underconsumption.'},
{id:43,category:'intervention',catLabel:'Intervention',concept:'Price Ceiling (Maximum Price)',diagramType:'priceControl',shift:'ceiling',explanation:'A price ceiling (maximum price) is set below the free market equilibrium price P*. At the ceiling, Qd > Qs — a shortage emerges. Non-price rationing mechanisms replace the price mechanism: queuing, waiting lists, lottery, or black markets. Consumer surplus is redistributed — those who receive the good at below-P* gain; those excluded lose. A DWL triangle emerges as the output reduction destroys welfare. Key assumption: the ceiling is below P* — a ceiling above P* is non-binding and has no effect. Evaluation: price ceilings benefit some consumers (those allocated the good at lower prices) but harm others (excluded from access) and producers (lower revenue). Over time, the shortage may worsen if low prices deter investment in supply — rent controls are the classic example, where low rents eventually reduce housing supply, worsening the affordability problem they sought to solve. Links to: shortage, DWL, rent controls, black markets.',keyPoint:'Ceiling below P* → shortage (Qd > Qs). Non-price rationing. DWL created. Some consumers gain; others excluded; producers lose revenue. Evaluation: price ceilings have a poor long-run track record — they address the symptom (high prices) not the cause (insufficient supply). Rent controls in Stockholm resulted in a 20-year waiting list for apartments, illustrating how ceilings suppress supply over time. Links: Shortage, DWL, Rent Controls, Black Markets. UK example: energy price cap (2022 Ofgem cap) prevented domestic bills rising to market-clearing levels — a price ceiling that protected consumers short-run but required £40bn government subsidy to compensate suppliers for below-cost selling, illustrating the fiscal cost of ceilings.'},
{id:44,category:'intervention',catLabel:'Intervention',concept:'Price Floor (Minimum Price)',diagramType:'priceControl',shift:'floor',explanation:'A price floor (minimum price) is set above the free market equilibrium P*. At the floor, Qs > Qd — a surplus emerges. The surplus must be disposed of: government purchases and stores it, exports it with subsidy, or mandates destruction. Producers benefit (higher price on units sold), consumers lose (higher price, lower quantity). A DWL triangle emerges. Key assumption: the floor is above P* — a floor below P* is non-binding. Evaluation: price floors used as agricultural support policies create perverse incentives for overproduction — farmers produce to the floor price regardless of market demand, leading to chronic surpluses. Minimum wages (a labour market price floor) are the most common modern application — their welfare effects are more complex when monopsony power is present. Links to: surplus, DWL, minimum wage, agricultural policy.',keyPoint:'Floor above P* → surplus (Qs > Qd). Government must purchase surplus or mandate destruction. Producers gain; consumers lose; DWL created. Evaluation: price floors that support agricultural incomes may be justified by food security arguments, but create production inefficiency and burden taxpayers. Minimum wages are a price floor with contested employment effects — Card and Krueger suggest monopsony limits job losses. Links: Surplus, DWL, Minimum Wage, Agricultural Policy. UK example: EU Common Agricultural Policy price floors (pre-Brexit) guaranteed wheat prices above world levels — UK farmers overproduced, creating surplus grain that required intervention buying and export subsidies, at significant taxpayer cost.'},
{id:45,category:'intervention',catLabel:'Intervention',concept:'Tax Incidence — Inelastic Demand',diagramType:'taxInelastic',explanation:'When demand is price inelastic (|PED| < 1), consumers are less responsive to price changes — they cannot easily substitute away from the good. This means producers can pass most of the tax on as a higher price with little loss of sales volume. The consumer bears the larger share of the tax burden. The DWL is relatively small because the quantity reduction is modest — output barely falls. Formally: consumer burden = tax × (PES / (PED + PES)), producer burden = tax × (PED / (PED + PES)) — with low PED, the consumer share is high. Key assumption: the tax is applied in a competitive market — in a monopoly, the firm already charges above MC, so the incidence analysis is more complex. Evaluation: taxing inelastic goods raises revenue efficiently (little DWL) but is typically regressive — necessities (food, fuel, tobacco) tend to be inelastic and are consumed by all income groups, hitting lower incomes proportionally harder. Links to: PED, specific tax, regressive tax, DWL.',keyPoint:'Inelastic demand → most tax falls on consumers (large ↑P, small ↓Q). DWL small. Revenue large. Evaluation: politically, governments prefer to tax inelastic goods (cigarettes, fuel, alcohol) because revenue is stable and DWL is low — but these taxes tend to be regressive. Counter-argument: if the taxed good generates negative externalities (cigarettes), the regressive incidence may be acceptable if it deters harmful consumption. Links: PED, Pigouvian Tax, Regressive Taxation, DWL. UK example: UK tobacco duty falls mainly on consumers — demand is inelastic (PED ≈ −0.4). A 10% price rise reduces consumption by only 4%, so 96% of the price rise is borne by smokers as a consumer burden.'},
{id:451,category:'intervention',catLabel:'Intervention',concept:'Tax Incidence — Elastic Demand',diagramType:'taxElastic',explanation:'When demand is price elastic (|PED| > 1), consumers readily substitute away from the good when price rises. This means producers cannot pass the tax on without losing significant sales volume — they absorb more of the tax as a lower net price to maintain sales. The producer bears the larger share of the tax burden. The DWL is relatively large because the quantity reduction is significant. Formally: with high |PED|, the producer share of incidence rises. Key assumption: supply is upward-sloping — if supply is also elastic, both sides can escape the burden more easily, reducing revenue and increasing DWL further. Evaluation: taxing elastically demanded goods raises less revenue per unit of tax and creates larger DWL — generally a less efficient tax base unless the good has significant negative externalities that justify the output reduction. Links to: PED, specific tax, DWL, optimal tax theory.',keyPoint:'Elastic demand → most tax falls on producers (small ↑P, large ↓Q). DWL large. Revenue small. Evaluation: elastic-demand goods are poor tax revenue bases — the large output reduction means the government collects less than expected (Laffer-type effect within the good market). However, if the good has negative externalities, the output reduction may be desirable — the DWL becomes a correction of overconsumption. Links: PED, DWL, Tax Revenue, Pigouvian Tax. UK example: UK airline passenger duty faces relatively elastic demand on leisure routes — airlines absorb much of the duty to remain competitive, consistent with elastic-demand incidence. Business routes are more inelastic (essential travel), shifting incidence to passengers.'},
{id:46,category:'intervention',catLabel:'Intervention',concept:'Corrective Subsidy (Merit Good)',diagramType:'corrSubsidy',explanation:'For a merit good where positive externalities cause underconsumption, a government subsidy shifts supply (or demand) to raise output toward the social optimum Qs. The welfare loss triangle from underconsumption at Qm is eliminated as the market moves to Qs. The subsidy equals the marginal external benefit (MEB) at the optimum. It can be given to producers (shifting S down) or consumers (shifting D up) — with the same output effect. Key assumption: the government can accurately estimate the MEB — in practice this is difficult, and over-subsidising creates its own DWL on the other side of the optimum. Evaluation: subsidies are generally preferable to direct provision when private markets can deliver the good efficiently — they preserve market incentives and choice while correcting the underconsumption. Direct provision (NHS, state education) is preferable when market provision would be highly unequal or the good has strong public good characteristics. Links to: merit goods, positive externality, DWL, government provision.',keyPoint:'Subsidy = MEB → output rises from Qm to Qs. DWL eliminated. Can be producer-side (↓S) or consumer-side (↑D). Evaluation: the optimal subsidy equals MEB — if set too high, it creates a new DWL from overproduction. Government failure risk: subsidies become permanent even when no longer needed, creating dependency and rent-seeking. Links: Merit Goods, Positive Externality, DWL, Government Failure. UK example: the UK Apprenticeship Levy subsidises employer-led training — a corrective subsidy addressing the positive externality of skills development (trained workers benefit future employers and the wider economy). Firms that invest in training cannot capture all the benefit if workers leave, causing underinvestment without the subsidy.'},
{id:23,category:'labour',catLabel:'Labour Markets',concept:'Competitive Labour Market',diagramType:'labour',shift:'base',explanation:'In a competitive labour market, many employers and many workers interact so that no single participant can influence the wage rate. The wage is determined by the intersection of labour demand (DL = MRP curve — firms hire workers up to the point where marginal revenue product equals the wage) and labour supply (upward-sloping — higher wages attract more workers). Equilibrium wage W* clears the market at employment Q*. Key assumption: labour is homogeneous and perfectly mobile between employers — in reality, skills, geography and information asymmetries create segmented labour markets where wages vary substantially for similar work. Evaluation: the competitive model predicts that wages equal MRP — workers are paid the value of their marginal contribution. Deviations (minimum wages above W*, union bargaining, monopsony) create unemployment or exploitation. Links to: MRP, minimum wage, trade union, monopsony.',keyPoint:'W* where DL = SL. DL = MRP (downward-sloping). SL upward-sloping. Workers paid MRP in competitive equilibrium. Evaluation: the competitive labour market model is a useful benchmark, but most real labour markets have frictions — search costs, imperfect information, geographic immobility — that prevent wages from instantly clearing. These frictions justify minimum wage legislation even in otherwise competitive markets. Links: MRP, Minimum Wage, Trade Union, Monopsony. UK example: the UK graduate labour market approximates competitive conditions for general skills — many employers, many graduates, wages converge toward MRP across similar roles. However, regional disparities persist (London premium of 20–30%) reflecting geographic immobility.'},
{id:24,category:'labour',catLabel:'Labour Markets',concept:'Minimum Wage',diagramType:'labour',shift:'minWage',explanation:'A minimum wage is a price floor in the labour market set above the competitive equilibrium wage W*. At Wmin, labour supply exceeds labour demand — classical unemployment emerges (Qs > Qd). The standard competitive model predicts employment falls from Q* to Qd. However, Card and Krueger (1994) found no employment loss when New Jersey raised its minimum wage — attributed to monopsony power, where employers were paying workers below their MRP. In a monopsonistic labour market, a minimum wage can simultaneously raise wages and employment up to the competitive level. Evaluation: the employment effect of minimum wages is the most contested question in labour economics. Evidence suggests small negative effects in competitive markets and potentially positive effects in monopsonistic ones. The net welfare effect depends on the market structure. Links to: monopsony, classical unemployment, MRP, labour market.',keyPoint:'Min wage above W* → classical unemployment (Qs > Qd) in competitive markets. But in monopsony: min wage can raise both W and Q toward competitive level. Evaluation: the employment effect is empirically small in most studies — UK NLW rises have not generated the unemployment predicted by the basic competitive model, consistent with widespread monopsony in low-wage sectors (retail, hospitality, care). The key question is always: how competitive is the labour market? Links: Monopsony, Classical Unemployment, MRP, Card-Krueger. UK example: UK National Living Wage rose from £6.50 (2014) to £11.44/hour (2024) — a 76% increase. Employment in low-wage sectors remained broadly stable, consistent with monopsony rather than a perfectly competitive baseline.'},
{id:25,category:'labour',catLabel:'Labour Markets',concept:'Increase in Labour Demand',diagramType:'labour',shift:'dlRight',explanation:'Labour demand shifts right when the MRP of workers rises — caused by: higher product prices (raising MRP = MP × P), improved productivity (raising MP directly), or technological complementarity (technology that raises worker productivity rather than replacing it). A rightward DL shift raises both W* and Q* along the existing labour supply curve. Key assumption: labour supply is held constant — in practice, wage rises may attract more workers (supply shift), moderating the wage increase. Evaluation: the distinction between demand-side wage growth (↑MRP) and cost-push wage pressure (trade union bargaining) matters — MRP-driven wage rises are sustainable without inflation because productivity underpins them; union-bargained rises above MRP create cost-push pressure. Links to: MRP, productivity, trade union, wage determination.',keyPoint:'DL right → W* ↑ and Q* ↑. Caused by ↑ MRP (↑ product price or ↑ productivity). Evaluation: wage growth driven by productivity is non-inflationary; wage growth exceeding productivity creates cost-push inflation pressure (unit labour costs rise). The Bank of England monitors wage growth vs productivity as a key inflation indicator. Links: MRP, Productivity, Trade Union, Cost-Push Inflation. UK example: UK tech sector wages rose strongly 2019–23 as demand for software engineers surged (↑product price of digital services) — a rightward DL shift driven by rising MRP. Average tech salaries reached £65,000 vs £35,000 economy-wide, consistent with higher MRP valuation.'},
{id:26,category:'labour',catLabel:'Labour Markets',concept:'Trade Union Wage Push',diagramType:'tradeUnion',explanation:'A trade union acts as a monopoly supplier of labour, bargaining collectively to push wages above the competitive equilibrium. By restricting labour supply (enforcing a minimum wage floor for members), the union shifts the effective labour supply curve left or imposes a wage floor at Wu > W*. Employment falls from Q* to Qd — the standard monopoly union model predicts a trade-off between higher wages and lower employment. Evaluation: the employment cost of union bargaining depends on the elasticity of labour demand — if DL is inelastic (workers are hard to replace), the union can secure large wage gains with small employment losses. If DL is elastic (workers easily substituted by capital), wage gains come at a significant employment cost. The bargaining model also ignores efficiency wages — unions may raise productivity through improved morale and reduced turnover, partially offsetting the cost. Links to: wage determination, MRP, elasticity of DL, collective bargaining.',keyPoint:'Union imposes Wu > W* → employment falls from Q* to Qd. Wage gain at cost of employment. Evaluation: elasticity of DL determines the trade-off — inelastic DL means large wage gains, small job losses (mining, rail); elastic DL means the union faces a sharper jobs-wages trade-off. Evidence: UK unions are strongest in public sector (inelastic DL) and weakest in retail (elastic DL). Links: MRP, Labour Demand Elasticity, Minimum Wage, Collective Bargaining. UK example: UK rail unions (ASLEF, RMT) secured 14% pay rises in 2023 after prolonged strikes — possible because train drivers are hard to replace (inelastic DL, highly specific skills), giving union bargaining power without large employment losses.'},
{id:43,category:'labour',catLabel:'Labour Markets',concept:'Elastic Labour Demand and Supply',diagramType:'elasticLab',explanation:'When both labour demand and labour supply are elastic, the labour market adjusts primarily through changes in employment (quantity) rather than wages. A demand shift raises employment significantly with only a modest wage rise; a supply shift raises employment with a modest wage fall. Elastic DL arises when workers are easily substitutable (low skills, many alternatives) or when the product market demand is elastic. Elastic SL arises when workers are mobile geographically and occupationally, and when the wage is close to reservation wages. Evaluation: elastic labour markets are more efficient — they adjust quickly to shocks via quantity (employment) changes rather than price (wage) changes. But they may also be more insecure — workers face greater unemployment risk in downturns when employers cut the large employment margin easily. Links to: labour market flexibility, minimum wage, employment, MRP.',keyPoint:'Elastic DL and SL → adjustment via quantity (employment), not wages. Wage changes are small; employment changes are large. Evaluation: elastic labour markets are associated with flexible, deregulated economies (UK, US) — they adjust faster to shocks but create greater employment insecurity. Continental European labour markets (France, Germany) have less elastic supply (stronger employment protection), adjusting via hours rather than headcount. Links: Labour Market Flexibility, Minimum Wage, Employment Security. UK example: UK retail and hospitality labour markets are highly elastic — firms can hire and fire easily (flexible contracts, low skills), so employment fluctuates widely with demand shocks. During COVID, retail employment fell 400,000 within months — consistent with elastic labour market adjustment.'},
{id:44,category:'labour',catLabel:'Labour Markets',concept:'Inelastic Labour Demand and Supply',diagramType:'inelasticLab',explanation:'When labour demand and supply are both inelastic, the labour market adjusts primarily through wages rather than employment. A demand shift causes large wage changes with little employment effect. Inelastic DL arises when workers have highly specific skills (surgeons, pilots), are essential to production, and have no close substitutes. Inelastic SL arises when: training takes years (doctors, engineers), workers are geographically immobile, or the occupation requires rare talent. Evaluation: inelastic labour markets create wage volatility — small changes in demand for specialist workers cause large wage swings. This can generate large wage inequality between high-skill (inelastic SL) and low-skill (elastic SL) workers. It also explains why minimum wages have less employment impact in markets with inelastic demand. Links to: wage determination, human capital, inequality, MRP.',keyPoint:'Inelastic DL and SL → adjustment via wages (large ↑W), not employment (small ↑Q). Common in high-skill, specific occupations. Evaluation: wage inequality between elastic and inelastic labour markets is a key driver of income inequality — the premium for scarce skills (surgeons, software engineers, Premier League footballers) can be enormous because DL is high and SL near-vertical. Supply-side policies (training, education) aim to increase SL elasticity over time. Links: Human Capital, Wage Inequality, Supply-Side Policy, MRP. UK example: UK NHS consultant shortage — inelastic SL (15 years of training) and inelastic DL (essential to hospital operations) → consultant wages are high and rising, but supply responds very slowly. Shortfall of 50,000 doctors cannot be solved quickly regardless of pay.'},
{id:45,category:'labour',catLabel:'Labour Markets',concept:'Marginal Revenue Product (MRP) Curve',diagramType:'mrp',explanation:'The MRP curve is a firm\'s labour demand curve — it shows the additional revenue generated by hiring one more worker. MRP = Marginal Product (MP) × Marginal Revenue (MR). In a competitive product market, MR = P, so MRP = MP × P. The MRP curve slopes downward because MP diminishes (law of diminishing returns) and, for price makers, MR also falls as output rises. Firms hire workers up to the point where MRP = wage rate (W) — the profit-maximising condition. Key assumption: the firm is a price taker in the labour market (competitive). In monopsony, the hiring condition is MRP = MCL > W. Evaluation: the MRP theory of wages has powerful implications — it predicts that wages reflect productivity. But it assumes firms know workers\' MRP (information problem), that labour markets are competitive, and that MRP can be separately identified from team production. Links to: diminishing returns, profit maximisation, monopsony, wage determination.',keyPoint:'MRP = MP × MR (or MP × P in competitive product market). Firm hires where MRP = W. MRP curve = DL curve. Slopes down due to diminishing MP and (for price makers) falling MR. Evaluation: MRP theory struggles with team production — when output is jointly produced, individual MRP cannot be measured, weakening the link between productivity and wages. CEO pay often far exceeds measurable MRP, reflecting bargaining power and information asymmetry rather than marginal productivity. Links: Law of Diminishing Returns, Monopsony, Competitive Labour Market, Profit Maximisation. UK example: UK agricultural firms hire seasonal workers up to the point where harvest MRP (price of produce × marginal physical output per picker) equals the minimum wage — the NLW effectively acts as a binding constraint when MRP is low, consistent with the MRP hiring rule.'},
{id:27,category:'labour',catLabel:'Labour Markets',concept:'Monopsony Labour Market',diagramType:'monopsony',explanation:'A monopsony has a single employer facing the entire labour supply. To hire additional workers it must raise wages for all existing workers — so the marginal cost of labour (MCL) exceeds the average cost (ACL = supply curve). Profit maximisation requires MCL = MRP, giving employment Qm < Q* and wage Wm < W*. Workers are paid below their MRP — the gap (MRP − Wm) represents monopsonistic exploitation. A minimum wage set between Wm and W* can simultaneously raise wages and employment toward the competitive level, challenging the standard competitive model\'s prediction that minimum wages reduce employment. Key assumption: the firm has true wage-setting power — in practice, many labour markets have oligopsonistic (few employers) rather than pure monopsonistic structure, with similar but less extreme effects. Evaluation: monopsony is more widespread than the pure model suggests — labour market frictions (search costs, geography, information asymmetry) give most employers some wage-setting power. Links to: minimum wage, MRP, exploitation, competitive labour market.',keyPoint:'MCL > ACL → Wm < W*, Qm < Q*. Workers paid below MRP. Min wage between Wm and W* → ↑ both W and Q (unlike competitive model). Evaluation: monopsony power is pervasive in low-wage sectors — care homes, supermarkets and fast food face few rival employers in many localities, giving them wage-setting power. This explains why NLW rises have had limited employment impact in these sectors. Links: Minimum Wage, MRP, MCL, Competitive Labour Market. UK example: the UK care sector is heavily monopsonistic in many regions — a single local authority or large care provider employs most care workers, with no rival employer offering comparable jobs. Care worker wages historically fell below competitive MRP levels, consistent with monopsony exploitation.'},
{id:50,category:'labour',catLabel:'Labour Markets',concept:'Maximum Wage',diagramType:'maxWage',explanation:'A maximum wage set below the free market equilibrium W* acts as a price ceiling in the labour market. At Wmax < W*, firms demand more workers (Qd > Qs) — creating a labour shortage as supply falls below demand. Non-wage rationing emerges (non-wage benefits, informal payments, status). The analysis parallels a product market price ceiling. In practice, maximum wages are rarely imposed directly — but implicit caps exist in public sector pay policy. Evaluation: the economic case for a maximum wage is not efficiency-based (it creates a shortage and DWL) but distributional — reducing wage inequality and preventing executive pay from extracting rents from shareholders. Critics argue this distorts incentives and causes talent to migrate to unregulated sectors or countries. Links to: minimum wage, labour shortage, pay policy, inequality.',keyPoint:'Max wage below W* → Qd > Qs → labour shortage. Non-wage rationing. DWL created. Evaluation: maximum wages are economically costly (shortages, misallocation) but may be justified on equity grounds if high wages reflect rent extraction rather than marginal productivity. The alternative — progressive taxation of earnings — is generally preferred as it does not distort labour supply decisions. Links: Minimum Wage, Labour Shortage, Inequality, Taxation. UK example: UK public sector pay caps (2010–17) effectively imposed a maximum wage constraint on NHS staff and teachers — real wages fell 8–15%, causing recruitment shortages consistent with a binding price ceiling in labour markets for nurses and teachers.'},
{id:51,category:'labour',catLabel:'Labour Markets',concept:'Backwards Bending Labour Supply',diagramType:'backwardsBend',
explanation:'The backwards bending labour supply curve arises because the income and substitution effects of a wage change work in opposite directions, and their relative size changes as wages rise. The substitution effect: a higher wage makes leisure more expensive relative to work — workers substitute away from leisure toward more hours worked (always positive). The income effect: a higher wage raises real income — since leisure is a normal good, workers demand more of it as income rises, meaning fewer hours worked (always negative, opposing the substitution effect). At low wages, the substitution effect dominates — the supply curve slopes upward normally. As wages rise above the critical threshold W*, the income effect begins to outweigh the substitution effect — workers choose to work fewer hours despite the higher wage, bending the curve back leftward. The result is an S-shaped curve: upward sloping at low wages, reaching maximum hours at W*, then bending back at high wages. Note: H2 < H1 even though W2 > W1 — more pay, less work. Key assumption: leisure is a normal good — this is empirically well-supported. Evaluation: the backwards bend is most relevant for high-income workers (professionals, executives) who have genuine discretion over hours — low-wage workers typically have little control over hours, so their supply is approximately vertical in practice. Links to: labour supply, income and substitution effects, wage determination, labour market.',
keyPoint:'Low W: substitution > income effect → SL upward sloping. W*: effects balance → max hours. High W: income > substitution → SL bends back (fewer hours despite higher pay). H2 < H1 even though W2 > W1. Evaluation: the backwards bend has an important policy implication — above W*, cutting income tax may reduce labour supply (workers take the tax cut as more leisure) rather than boosting it, undermining the supply-side case for tax cuts for high earners. The OBR acknowledges this uncertainty in its labour supply elasticity estimates. Links: Income and Substitution Effects, Labour Supply, Income Tax, Supply-Side Policy. UK example: surveys of UK professional workers (lawyers, consultants, senior managers) consistently show many would work fewer hours if given the choice — consistent with being above W* on the backwards section. UK doctors reduce NHS sessions when pay rises above certain thresholds, a direct real-world example of the backwards bend.'},

{id:30,category:'costs',catLabel:'Cost Theory',concept:'Law of Diminishing Returns',diagramType:'diminishing',explanation:'In the short run, at least one factor (typically capital) is fixed. As successive units of a variable factor (labour) are added to the fixed factor, marginal product (MP) initially rises (due to specialisation and cooperation), then falls as the fixed factor becomes a binding constraint — each additional worker has less capital to work with. This is diminishing marginal returns. Total product (TP) still rises while MP is positive; TP peaks when MP = 0; TP falls if MP turns negative. Key assumption: technology is held constant — the law applies to a given production function. If technology improves, the MP curve shifts upward. Evaluation: the law of diminishing returns is a short-run concept only — in the long run, all factors are variable and economies of scale may apply. Confusing short-run diminishing returns with long-run diseconomies of scale is a common error. Links to: short-run cost curves, MC, marginal product, production function.',keyPoint:'SR only: fixed capital + ↑ variable labour → MP rises then falls (diminishing returns). MP max = MC min. TP peaks when MP = 0. Evaluation: the rate at which MP falls determines the slope of the MC curve — rapid diminishing returns produce a steeply rising MC (e.g. small kitchens); slow diminishing returns produce a flatter MC. The law underpins the U-shape of all short-run cost curves. Links: Short-Run Cost Curves, MC, ATC, Production & Cost Link. UK example: a small café kitchen (fixed capital) — adding chefs initially raises output per chef through specialisation. Beyond 4–5 chefs, they get in each other\'s way: MP falls sharply, MC rises steeply. A fixed kitchen is the binding constraint.'},
{id:28,category:'costs',catLabel:'Cost Theory',concept:'Short Run Cost Curves',diagramType:'srCosts',explanation:'In the short run, at least one factor is fixed, creating fixed costs (FC) that do not vary with output. Variable costs (VC) change with output. AFC = FC/Q falls continuously as the fixed cost is spread over more units — a rectangular hyperbola. AVC is U-shaped: initially falling (rising MP reduces cost per unit) then rising (diminishing returns increase cost per unit). ATC = AFC + AVC is also U-shaped. The vertical gap between ATC and AVC is AFC, which narrows as output rises. MC cuts both AVC and ATC at their minimum points — a mathematical necessity (when MC < ATC, average is falling; when MC > ATC, average is rising). Key assumption: factor prices are constant — if wages or input prices change, the cost curves shift. Evaluation: the U-shape of ATC is driven by two forces pulling in opposite directions — falling AFC and rising AVC. The minimum ATC is the productively efficient output level. Links to: MC, profit maximisation, productive efficiency, diminishing returns.',keyPoint:'AFC falls continuously. AVC and ATC U-shaped. MC cuts AVC and ATC at their minima. ATC − AVC = AFC (gap narrows). Evaluation: in capital-intensive industries (e.g. airlines, power stations), the fixed cost component is enormous — AFC falls steeply and dominates ATC at low output, incentivising high capacity utilisation. In labour-intensive industries, VC dominates and ATC is less U-shaped. Links: MC-ATC Relationship, Productive Efficiency, Diminishing Returns, LRAC. UK example: UK airlines have high fixed costs (aircraft leases, gate fees) — AFC falls steeply with passenger load factor. EasyJet targets 90%+ load factors to drive ATC toward minimum, explaining the strategy of filling seats at low marginal cost.'},
{id:42,category:'costs',catLabel:'Cost Theory',concept:'Short Run Cost Curves (AFC, AVC, ATC, MC)',diagramType:'srCostsFull',explanation:'The full four-curve diagram shows all short-run cost relationships simultaneously. AFC is a rectangular hyperbola, always positive and falling. AVC and ATC are both U-shaped — ATC lies above AVC by the AFC amount, which shrinks as output rises (curves converge). MC is U-shaped and more steeply shaped than AVC/ATC — it falls to its minimum before AVC reaches its minimum, then rises faster. MC intersects AVC at AVC minimum and ATC at ATC minimum — these intersection points are crucial for efficiency analysis. Key assumption: all four curves derive from the same underlying production function — they are not independent; a change in the production function shifts all simultaneously. Evaluation: the ATC minimum identifies the productively efficient output; the AVC minimum is important for the shut-down condition — if P < AVC, the firm cannot cover variable costs and should shut down immediately rather than produce at a loss. Links to: shut-down condition, productive efficiency, profit maximisation, MC.',keyPoint:'Four curves: AFC (hyperbola), AVC (U), ATC (U, above AVC by AFC), MC (U, steeper). MC cuts AVC and ATC at their minima. ATC − AVC = AFC → gap narrows as Q rises. Evaluation: the shut-down condition P < AVC is more important in practice than P < ATC — a firm should produce in the short run if P covers variable costs (even at a loss), because fixed costs are sunk. Only if P < AVC should it shut down immediately. Links: Shut-Down Condition, Productive Efficiency, Break-Even, MC. UK example: UK steel producers during the 2015–16 price slump — Tata Steel\'s Port Talbot plant faced P < ATC (making losses) but P > AVC (covering variable costs), so continued production short-run rather than shutting down immediately, consistent with the AVC shut-down rule.'},
{id:29,category:'costs',catLabel:'Cost Theory',concept:'MC and ATC Relationship',diagramType:'mc',explanation:'The relationship between MC and ATC is a mathematical law: when MC lies below ATC, each additional unit costs less than the average, pulling the average down. When MC lies above ATC, each unit costs more than average, pulling average up. Therefore MC must cross ATC at its exact minimum — the bottom of the U. This is not an assumption but a logical necessity, equivalent to how a student whose exam mark is below their average pulls their average down. The same relationship holds between MC and AVC. Key assumption: the curves are smooth and continuous — in practice, cost functions may have kinks or discontinuities (shift patterns, machine set-up costs) that create stepped cost curves rather than smooth U-shapes. Evaluation: the MC = ATC minimum identifies productive efficiency — firms operating at minimum ATC minimise average cost and produce at the technically most efficient scale for their plant. Links to: productive efficiency, profit maximisation, natural monopoly, LRAC.',keyPoint:'MC < ATC → ATC falling. MC > ATC → ATC rising. MC = ATC at minimum ATC (productive efficiency). Same logic applies to MC and AVC. Evaluation: firms maximise profit at MC = MR, not at minimum ATC — only under perfect competition in the long run does P = MC = minimum ATC, achieving productive efficiency. A monopoly produces where MC = MR, which is to the left of minimum ATC — productively inefficient. Links: Productive Efficiency, Profit Maximisation, Perfect Competition LR, LRAC. UK example: UK supermarkets operate large distribution centres at near-minimum ATC — achieving productive efficiency through scale. A small independent retailer operates on the falling portion of ATC (left of minimum), with higher average costs due to insufficient volume.'},
{id:51,category:'costs',catLabel:'Cost Theory',concept:'Production & Cost Curves: The Link',diagramType:'prodCost',explanation:'Production curves (TP, MP, AP) and cost curves (TC, MC, AC) are mirror images connected by the wage rate: MC = w/MP. When MP rises (increasing returns), the cost of producing each additional unit falls — MC falls. When MP falls (diminishing returns), MC rises. MP is maximised at the inflection point of TP — which is the same output where MC is minimised. AP is maximised where the AP curve peaks — the same output where AC is minimised. The wage rate (w) is the scaling factor linking the production and cost functions: doubling wages doubles all cost curves but does not change the production function. Evaluation: this link is fundamental but often ignored — it means that any policy or event that changes worker productivity (training, technology, management quality) directly shifts the cost curves via the production function, not just through input prices. Links to: diminishing returns, MC, productivity, cost curves.',keyPoint:'MP rises → MC falls. MP falls → MC rises. MP max = MC min. AP max = AC min. MC = w/MP. Evaluation: the production-cost link means productivity improvements shift all cost curves downward — firms that raise output per worker (↑MP) reduce their MC and gain competitive advantage. This is why productivity growth is central to long-run cost competitiveness. Links: Diminishing Returns, MC, Short-Run Costs, Productivity. UK example: the introduction of self-checkout tills in UK supermarkets raised AP per worker (one worker supervises 6 self-checkouts vs serving 1 customer at a staffed till) — MP of labour rose, shifting AC downward. Tesco saved an estimated £200m/year in labour costs via this productivity improvement.'},
{id:31,category:'costs',catLabel:'Cost Theory',concept:'Long Run Average Cost Curve',diagramType:'lrac',shift:'base',explanation:'The LRAC is the planning envelope of all possible SRAC curves — it shows the lowest achievable average cost at each output level when all factors are variable. Initially LRAC falls as economies of scale are realised (technical, managerial, financial, purchasing, risk-bearing). It reaches its minimum at the minimum efficient scale (MES) — the smallest output at which LRAC is minimised. Beyond MES, diseconomies of scale cause LRAC to rise (coordination failures, communication problems, X-inefficiency). The LRAC is tangent to each SRAC but does not pass through their minimum points except at the MES. Key assumption: technology is fixed — technological progress shifts the entire LRAC downward over time. Evaluation: the position of the MES relative to market demand determines the natural industry structure — if MES is large relative to demand, a natural monopoly may emerge; if MES is small, many firms can coexist. Links to: economies of scale, diseconomies, MES, natural monopoly.',keyPoint:'LRAC = envelope of SRAC curves. Falls (EoS) → minimum at MES → rises (DoS). Tangent to each SRAC. Evaluation: the MES determines market structure — industries with high MES relative to market size (utilities, rail) tend toward natural monopoly; industries with low MES (restaurants, hairdressers) support many small firms. The LRAC is only a planning tool — in reality, firms cannot instantly move to their optimal scale. Links: Economies of Scale, Diseconomies, MES, Natural Monopoly. UK example: UK water companies operate near MES — the network infrastructure means one firm can supply a region at lower LRAC than multiple competing firms, explaining the natural monopoly structure and regulatory oversight by Ofwat.'},
{id:32,category:'costs',catLabel:'Cost Theory',concept:'Economies of Scale',diagramType:'lrac',shift:'eos',explanation:'Internal economies of scale cause a firm\'s LRAC to fall as it expands output — the firm moves down its own LRAC curve. The five main types are: technical (larger, more efficient plant — 2/3 rule for containers), managerial (specialist managers replace generalists), financial (lower borrowing costs as creditworthiness rises), purchasing (bulk buying discounts), and risk-bearing (diversified product range reduces exposure to any single market). External economies of scale arise from industry growth — the whole LRAC shifts downward for all firms in the cluster regardless of individual firm size. Key assumption: management quality keeps pace with growth — if it does not, X-inefficiency and diseconomies emerge before technical EoS are exhausted. Evaluation: the most powerful EoS are typically technical (capital indivisibility) and financial — but these require very large minimum scale, which may limit competition and create barriers to entry. Links to: LRAC, MES, barriers to entry, natural monopoly.',keyPoint:'Internal EoS: firm moves down its own LRAC as Q↑. 5 types: technical, managerial, financial, purchasing, risk-bearing. External EoS: whole LRAC shifts down from industry growth. Evaluation: EoS create a tension with competition — large firms exploit scale but may abuse market power. Competition policy must balance efficiency (scale) against competition (fragmentation). The 2/3 rule: doubling container volume requires only 2^(2/3) ≈ 1.59× the material, giving a 21% cost advantage per unit. Links: LRAC, Diseconomies of Scale, Barriers to Entry, Natural Monopoly. UK example: Amazon UK exploits all five EoS — automated warehouses (technical), specialist logistics managers (managerial), AAA credit (financial), supplier volume discounts (purchasing), diversified product base (risk-bearing) — allowing it to undercut rivals.'},
{id:53,category:'costs',catLabel:'Cost Theory',concept:'External Economies of Scale',diagramType:'lrac',shift:'external',explanation:'External economies of scale reduce the costs of all firms in an industry as the industry itself grows, regardless of any individual firm\'s own output. Sources include: a pool of trained specialist workers (reducing recruitment and training costs), shared infrastructure investment (road, port, broadband), knowledge spillovers and R&D sharing within clusters, development of specialist supplier networks, and proximity to research institutions. The effect is a downward shift of every firm\'s LRAC curve — firms become more efficient not through their own expansion but through the growth of their operating environment. Key assumption: the external benefits are genuinely available to all firms in the cluster — in practice, some knowledge spillovers are appropriated by specific firms through patents or talent hoarding. Evaluation: external EoS provide the economic rationale for industrial clusters and regional policy — governments can shift LRAC downward for entire industries by investing in skills, infrastructure and R&D. Links to: industrial clusters, supply-side policy, agglomeration, LRAC.',keyPoint:'External EoS: industry growth → all firms\' LRAC shifts down. Sources: shared labour pool, infrastructure, knowledge spillovers, supplier networks. Evaluation: external EoS justify cluster policy — the Silicon Valley effect shows how geographic concentration creates self-reinforcing cost advantages. But clusters can also become vulnerable (single-industry towns) and difficult to replicate by policy alone. Links: LRAC, Industrial Policy, Agglomeration, Supply-Side Policy. UK example: London\'s fintech cluster (Shoreditch/Tech City) generates external EoS for all member firms — shared access to finance talent, proximity to regulators, specialist legal services, and VC networks reduces costs for startups and established firms alike, lowering the LRAC of financial innovation.'},
{id:'53a',category:'costs',catLabel:'Cost Theory',concept:'LRAC Envelope Curve',diagramType:'envelope',
    explanation:'The LRAC envelope traces the minimum achievable average cost across all possible plant sizes — it is tangent to each SRAC curve at one point. On the falling section of the LRAC (EoS), the tangency occurs to the left of the SRAC minimum — firms are not yet at their SRAC optimum but the LRAC is still falling, so choosing a larger plant is beneficial. At the MES, the LRAC minimum coincides with the SRAC minimum — the firm is at the globally optimal scale. On the rising section (DoS), the tangency occurs to the right of the SRAC minimum — the firm has overexpanded. Key assumption: firms can freely choose among all possible plant sizes in the long run — in practice, capital is lumpy (plants come in discrete sizes) and switching costs may trap firms in a suboptimal plant size. Evaluation: the envelope curve shows that there is always a better plant choice for a given output target — the error of operating on the wrong SRAC (too small or too large a plant) always raises costs above the LRAC minimum. Links to: LRAC, SRAC, MES, productive efficiency.',
    keyPoint:'LRAC tangent to each SRAC at one point. EoS section: tangency left of SRAC min. MES: tangency at SRAC min. DoS section: tangency right of SRAC min. Evaluation: the envelope concept explains why plant size decisions are long-run commitments — a firm that builds a small plant and then faces demand growth is stuck on a high-cost SRAC; it must invest in a new plant to reach a lower LRAC. Capital investment reversibility matters for how quickly firms can move along the LRAC. Links: LRAC, Economies of Scale, MES, Investment Decisions. UK example: UK steel producers must choose blast furnace scale years in advance — building a furnace too small means operating on a high SRAC above the LRAC; too large means underutilising capacity and paying fixed costs on idle equipment.'},
{id:'53b',category:'costs',catLabel:'Cost Theory',concept:'X-Inefficiency',diagramType:'xIneff',
    explanation:'X-inefficiency occurs when a firm fails to minimise costs for its given output level — actual average costs exceed the minimum LRAC. It arises not from scale but from organisational slack: weak management, lack of competitive pressure, over-staffing, poor procurement, or empire-building. Leibenstein (1966) identified it as the most important source of welfare loss from monopoly — greater even than the DWL triangle. X-inefficiency is most prevalent in: monopolies and near-monopolies shielded from competition, state-owned enterprises with soft budget constraints, and heavily regulated industries where inefficiency can be passed on to consumers. Key assumption: the LRAC represents the technically efficient minimum — X-inefficiency implies the firm is not exploiting available production possibilities. Evaluation: the implication for competition policy is powerful — the welfare gain from breaking up a monopoly or introducing competition may come primarily from reducing X-inefficiency rather than from the DWL triangle, which is typically smaller. Links to: monopoly, productive efficiency, competition policy, privatisation.',
    keyPoint:'X-inefficiency: actual AC > minimum LRAC. Caused by slack, not scale. Most common in monopolies and state enterprises. Reducing X-inefficiency shifts actual AC down toward LRAC. Evaluation: X-inefficiency may exceed the standard DWL welfare loss from monopoly — Leibenstein estimated it was 3–10× larger. This strengthens the case for competition over regulation: competition forces cost minimisation, while regulation may allow X-inefficiency to persist. Links: Monopoly, Productive Efficiency, Competition Policy, Privatisation. UK example: British Leyland (1970s) operated far above its LRAC — overmanning, poor management and restrictive union practices inflated costs well beyond technically achievable levels. Post-privatisation comparisons suggest BT, British Gas and British Airways all reduced X-inefficiency significantly after exposure to competition.'},
{id:55,category:'costs',catLabel:'Cost Theory',concept:'Decrease in Variable Costs',diagramType:'varCost',
explanation:'A decrease in variable costs — such as a fall in raw material prices, lower energy costs, or improved labour productivity — shifts both the MC and AC curves downward. Fixed costs are unaffected, so AFC is unchanged; the vertical gap between AC and AVC narrows (or rather: the AVC component within AC falls). Because MC = w/MP (or more generally reflects the marginal variable cost of producing one more unit), any fall in variable input prices directly reduces MC at every output level — the MC curve shifts down in parallel. AC = AFC + AVC: since AFC is constant and AVC falls, AC also shifts downward. Crucially, the output level Q* at which AC is minimised does not change — the same quantity minimises average cost, but at a lower absolute level. Key assumption: fixed costs are truly fixed — if some apparent fixed costs are actually quasi-fixed (e.g. energy standing charges), they too may fall. Evaluation: a decrease in variable costs simultaneously improves productive efficiency (lower minimum AC) and increases profitability at every output level. For a competitive firm this is passed on to consumers via lower prices; for a monopolist, it widens the profit margin. Links to: short-run cost curves, MC, AVC, supply curve shifts, profit.',
keyPoint:'↓ Variable costs → MC and AC both shift down. AFC unchanged. Q* (min AC output) unchanged. Evaluation: lower variable costs benefit firms through both higher profit margins and improved productive efficiency, but the distribution between consumers (lower prices) and producers (higher profit) depends on market structure — competitive markets pass cost reductions through; monopolists retain them. Supply-side cost shocks (e.g. energy prices) shift MC/AC across entire industries simultaneously, affecting the macroeconomic supply curve (SRAS shifts right). Links: Short-Run Cost Curves, MC-ATC Relationship, Production and Cost Link, Supply Curve. UK example: the fall in North Sea gas prices (2023–24) reduced variable energy costs for UK manufacturers — shifting MC and AC downward across energy-intensive industries such as chemicals, glass and ceramics, improving competitiveness and widening margins.'},
{id:56,category:'costs',catLabel:'Cost Theory',concept:'Increase in Fixed Costs',diagramType:'fixedCost',
explanation:'An increase in fixed costs — such as a rise in rent, business rates, insurance premiums, or lease payments — shifts both the ATC and AFC curves upward, but leaves MC completely unchanged. This is the defining characteristic that distinguishes fixed cost changes from variable cost changes. MC = change in total cost from producing one more unit — but since fixed costs do not vary with output, they contribute nothing to marginal cost at any level of production. Whether fixed costs are £1,000 or £1,000,000, the cost of producing the next unit is identical. AFC = FC/Q rises at every output level, shifting upward. ATC = AFC + AVC: since AFC rises and AVC is unchanged, ATC shifts up by exactly the same amount as AFC at every output. The output level that minimises ATC does not change — the U-shape simply sits higher. Key assumption: the cost is genuinely fixed and does not vary with output — in practice, some costs that appear fixed (e.g. stepped fixed costs) may increase in discrete jumps as output rises, blurring the distinction. Evaluation: because MC is unchanged, the profit-maximising output (MC=MR) is unaffected by a change in fixed costs. This means fixed cost increases reduce profit but do not change optimal output or pricing decisions — a counterintuitive but important result for firms considering cost structure. Links to: short-run cost curves, profit maximisation, break-even, barriers to entry.',
keyPoint:'↑ Fixed costs → ATC and AFC shift up. MC unchanged. Profit-max output (MC=MR) unaffected. Evaluation: this is a critical exam distinction — fixed cost changes affect profitability and break-even but not the output or price decision. A firm facing higher rent still produces where MC=MR; it absorbs the fixed cost hit as lower profit or, in the long run, exits if P < ATC. High fixed costs also act as a barrier to entry — new entrants must cover the sunk cost before earning any revenue. Links: Short-Run Cost Curves, Profit Maximisation, Break-Even, Barriers to Entry. UK example: the 2023 business rates revaluation raised fixed costs for many UK high street retailers — ATC shifted up at every output level, but pricing and stocking decisions (MC=MR) were unaffected. Firms unable to cover the higher ATC exited the market, contributing to the rise in UK retail vacancies.'},
{id:57,category:'costs',catLabel:'Cost Theory',concept:'Shut-Down and Break-Even Price',diagramType:'shutDown',
explanation:'Two critical price thresholds determine a firm\'s short-run production decision. The break-even price (P2) is the price at which TR = TC — it equals minimum ATC. At P2, the firm earns normal profit (zero economic profit) and has no incentive to enter or exit. The shut-down price (P1) is the price at which TR = TVC — it equals minimum AVC. At P1, the firm covers all variable costs but contributes nothing toward fixed costs. Between P1 and P2 (shut-down < P < break-even), the firm makes a loss but should continue producing in the short run because TR > TVC — every unit produced covers variable costs and makes some contribution toward fixed costs, reducing the loss compared to shutting down (where the firm still pays all fixed costs). Below P1, TR < TVC — the firm minimises losses by shutting down immediately, since producing increases losses beyond the fixed cost level. Both thresholds are identified graphically where the MC curve passes through the minimum points of AVC (P1) and ATC (P2). Key assumption: fixed costs are sunk in the short run — they are incurred whether or not the firm produces. In the long run, all costs become variable and the only relevant threshold is whether P ≥ LAC. Evaluation: the shut-down rule is about variable costs only — a firm that has already paid its rent will not stop producing just because P < ATC, as long as P > AVC. The distinction is practically important for firms with high fixed costs (airlines, steel mills) who continue operating at a loss during downturns to avoid even larger losses from closure. Links to: short-run cost curves, perfect competition SR, profit maximisation, MC.',
keyPoint:'P < P1 (min AVC): shut down immediately — TR < TVC, producing makes loss worse. P1 < P < P2 (between min AVC and min ATC): produce at a loss — TR > TVC so some contribution to fixed costs. P = P2 (min ATC): break even — normal profit. P > P2: supernormal profit. Evaluation: the shut-down decision is often misunderstood — a firm making a loss is not necessarily irrational to keep producing. UK airlines continued flying loss-making routes in 2020 partly to preserve slots and avoid fixed hangar/lease costs. The key question is always whether TR exceeds TVC, not whether TR exceeds TC. Links: SR Cost Curves, Perfect Competition SR, Profit Maximisation, Barriers to Exit. UK example: during the 2022 energy crisis, some UK ceramic and glass manufacturers temporarily shut down operations (not just cut output) because gas prices pushed AVC above the market price for their products — a rare real-world application of the P < min AVC shutdown condition.'},



{id:48,category:'revenue',catLabel:'Revenue & Profit',concept:'Revenue Curves: Price Taker',diagramType:'revenueCompare',explanation:'A price taker in perfect competition faces a perfectly elastic (horizontal) demand curve at the market price P — it can sell any quantity at P but nothing above P. Therefore AR = MR = P at every output level. Total revenue (TR) rises as a straight line from the origin with slope P. The firm has no pricing power — it is a passive receiver of the market price determined by industry supply and demand. Key assumption: the firm is so small relative to the market that its output decisions have no perceptible effect on price — a realistic assumption in commodity markets but increasingly rare in modern industries. Evaluation: the horizontal demand curve means the firm faces perfectly elastic demand — any price rise above P leads to zero sales. This creates a powerful incentive for cost minimisation as the only route to profit improvement. The profit-maximising rule MC = MR = P identifies the optimal output. Links to: perfect competition, MR, profit maximisation, AR.',keyPoint:'Price taker: AR = MR = P (horizontal). TR linear (slope = P). No pricing power. Profit max: MC = MR = P. Evaluation: the price-taker model is most applicable to commodity and financial markets — wheat, copper, foreign exchange. In these markets, price transparency and standardised products mean no individual firm influences price. In most other industries, some product differentiation gives firms price-making power. Links: Perfect Competition, MR, Profit Maximisation, Revenue Curves Price Maker. UK example: UK arable farmers are price takers — global wheat prices are set by Chicago futures markets. A UK wheat farmer selling 5,000 tonnes has no influence on the £200/tonne market price; AR = MR = P regardless of output.'},
{id:47,category:'revenue',catLabel:'Revenue & Profit',concept:'Revenue Curves: Price Maker',diagramType:'revPriceMaker',explanation:'A price maker (imperfect competitor) faces a downward-sloping AR (demand) curve — to sell more, it must lower price on all units. As a result, MR lies below AR at every quantity: the marginal revenue from an extra unit is the price received minus the revenue lost by cutting price on existing units (the inframarginal effect). For a linear demand curve, MR has the same vertical intercept but is twice as steep. TR rises while MR > 0 (elastic demand region), peaks where MR = 0 (unit elastic, midpoint of demand curve), then falls where MR < 0 (inelastic region). Key assumption: the firm can set price OR quantity, not both simultaneously — it chooses output (where MC = MR) and reads the price from the AR curve. Evaluation: the gap between AR and MR measures the firm\'s pricing power — a large gap indicates high market power and significant consumer surplus appropriation. Links to: MR, monopoly, profit maximisation, PED.',keyPoint:'Price maker: AR downward-sloping. MR below AR, same intercept, twice the slope (linear D). TR rises (MR > 0, elastic), peaks (MR = 0), falls (MR < 0, inelastic). Evaluation: the AR-MR gap is a measure of monopoly power — the further MR lies below AR at the profit-maximising output, the greater the markup over marginal cost (Lerner Index = (P − MC)/P). Links: MR, Profit Maximisation, Monopoly, PED Along Demand Curve. UK example: Sky UK is a price maker for Premier League rights — its downward-sloping AR curve reflects the fact that raising subscription prices loses some subscribers. MR lies well below AR, giving Sky pricing power and the ability to sustain supernormal profits behind barriers to entry.'},

{id:35,category:'revenue',catLabel:'Revenue & Profit',concept:'Profit Maximising Price Maker',diagramType:'monopoly',explanation:'A profit-maximising price maker (monopolist or imperfect competitor) produces where MC = MR — the standard profit-maximising condition for any firm. This output Q1 lies to the left of where a competitive market would operate. The price P1 is then read from the AR (demand) curve above Q1. Supernormal profit per unit = P1 − AC1; total supernormal profit = (P1 − AC1) × Q1 — the shaded rectangle. Barriers to entry protect this profit in the long run, preventing the competitive entry that would erode it in perfect competition. Key assumption: AC is known at Q1 — in practice, firms estimate average costs based on expected output, making profit calculation uncertain. Evaluation: monopoly profit maximisation creates three welfare problems: (1) P > MC (allocative inefficiency), (2) P > minimum AC (productive inefficiency unless operating at MES), and (3) consumer surplus is redistributed to producer surplus. Links to: monopoly welfare loss, DWL, barriers to entry, regulation.',keyPoint:'MC = MR → Q1. P1 from AR above Q1. SNP = (P1 − AC1) × Q1. Protected by barriers to entry in LR. Evaluation: the welfare loss from monopoly has two components — DWL (output not produced) and redistribution (CS → PS). The DWL is typically smaller than redistribution, making the equity argument against monopoly as important as the efficiency argument. Regulation (price cap, profit cap) can improve outcomes. Links: DWL, Barriers to Entry, Regulation, Perfect Competition LR. UK example: Thames Water holds a regional monopoly — it sets price above MC (allocative inefficiency) and has historically earned supernormal returns despite service failures, protected by the natural monopoly barrier of pipe infrastructure.'},
{id:50,category:'revenue',catLabel:'Revenue & Profit',concept:'Supernormal Profit at Revenue-Maximising Output',diagramType:'revMaxMono',explanation:'A revenue-maximising firm produces where MR = 0 — the point at which TR is maximised. This output exceeds the profit-maximising output (where MC = MR). At MR = 0, the firm is at the midpoint of the demand curve (|PED| = 1). Supernormal profit still exists (AR > AC) but is smaller than at the MC = MR output, because the firm has expanded beyond the profit-maximising point onto rising AC or falling AR. The rationale for revenue maximisation comes from managerial theories of the firm (Baumol) — managers may maximise revenue if pay and status are tied to firm size. Key assumption: revenue maximisation is the objective — in practice, firms may operate under a profit constraint (minimum acceptable profit) alongside revenue maximisation. Evaluation: revenue maximisation leads to more output and lower prices than profit maximisation — it is closer to the competitive outcome. However, it may not be sustainable if profit falls below the minimum needed to satisfy shareholders or maintain investment. Links to: MR, Baumol, profit maximisation, managerial theories.',keyPoint:'MR = 0 → revenue max output. Q > profit-max Q. P < profit-max P. SNP smaller but positive. Evaluation: revenue maximisation benefits consumers (lower P, higher Q than profit max) but may conflict with shareholder interests — firms pursuing revenue at the expense of profit face takeover threat (capital market discipline). The gap between revenue-max and profit-max output is smaller when MC is higher. Links: MR, Baumol Managerial Theory, Profit Maximisation, Shareholder Pressure. UK example: Amazon historically prioritised revenue growth over profit (MR = 0 strategy) — reinvesting all profits into expansion. AWS and Prime subscriptions eventually generated supernormal profit, consistent with a long-run shift toward profit maximisation once market dominance was secured.'},
{id:49,category:'revenue',catLabel:'Revenue & Profit',concept:'Monopoly at Productive Efficiency',diagramType:'prodEffMono',explanation:'If a regulator mandates output where P = AC (the break-even or normal profit condition), the firm earns only normal profit — no supernormal returns. At this output Q1, P1 > MC — allocative inefficiency remains (price exceeds marginal cost, so the last unit is worth less to society than its price implies). Productive efficiency (P = minimum AC) is only achieved if the regulatory output coincides with minimum AC — which requires operating at the MES. A monopoly regulated to P = AC is more efficient than an unregulated monopoly (which charges above AC) but still less allocatively efficient than P = MC pricing. Key assumption: the regulator can accurately observe costs — if the firm has private cost information, it may inflate costs to secure a higher price cap. Evaluation: the trade-off between allocative and productive efficiency is a central regulatory challenge — P = MC achieves allocative efficiency but causes losses for a natural monopoly (P < AC); P = AC avoids losses but retains allocative inefficiency. Links to: regulation, natural monopoly, allocative efficiency, productive efficiency.',keyPoint:'P = AC → normal profit, productive efficiency possible. But P > MC → allocative inefficiency remains. Evaluation: regulators face a dilemma — P = MC (allocative efficiency) requires a subsidy for natural monopolies (P < AC); P = AC (no subsidy needed) maintains allocative inefficiency. RPI − X price cap regulation attempts a compromise. Asymmetric information allows regulated firms to game cost reporting. Links: Natural Monopoly, Regulation, Allocative Efficiency, RPI-X. UK example: Ofwat uses a form of P = AC+ regulation for water companies — setting price caps to allow normal returns on regulated assets while targeting productive efficiency through benchmarking against comparable firms.'},
{id:52,category:'revenue',catLabel:'Revenue & Profit',concept:'Sales Maximisation (Baumol)',diagramType:'salesMax',
explanation:'Sales maximisation (Baumol, 1959) argues that managers in large firms maximise revenue (sales) subject to a minimum profit constraint, rather than maximising profit for shareholders. The firm produces where AR = AC — the highest output consistent with earning normal profit (zero economic profit). This output Qs exceeds the profit-maximising output (MC=MR) and the revenue-maximising output (MR=0 — which may generate supernormal profit). The rationale: managers derive salary, status and job security from firm size (revenue), not profit, creating a principal-agent problem between managers and owners. Key assumption: a profit constraint exists — without it, the firm would push output further, incurring losses. Evaluation: the model predicts larger output and lower prices than profit maximisation — more consumer-friendly but less efficient from shareholders\'s perspective. The separation of ownership and control is most relevant in large PLCs where diffuse shareholders cannot monitor management effectively. Hostile takeovers act as a discipline mechanism: if profit falls too far below maximum, the firm becomes a takeover target. Links to: principal-agent problem, profit maximisation, revenue maximisation, managerial theories.',
keyPoint:'Sales max: produce where AR = AC (normal profit constraint). Qs > revenue-max Q > profit-max Q. P lower than both alternatives. Evaluation: sales maximisation creates a principal-agent problem — managers benefit from size, shareholders from profit. Corporate governance mechanisms (performance pay, non-executive directors, takeover threat) aim to align incentives. Empirical evidence is mixed: some large firms clearly pursue growth over profit (Amazon 2000s), others maintain tight profit discipline. Links: Principal-Agent Problem, Profit Maximisation, Revenue Maximisation, Corporate Governance. UK example: BT Group pre-privatisation (1970s) exhibited classic sales maximisation behaviour — pursuing network expansion and revenue growth with weak profit discipline, protected from takeover as a state monopoly. Post-privatisation (1984), shareholder pressure and competition shifted focus toward profit maximisation.'},
{id:53,category:'revenue',catLabel:'Revenue & Profit',concept:'Firm Objectives Compared',diagramType:'microObj',
explanation:'A single diagram shows five different output levels, each corresponding to a different firm objective. Q1 (profit maximisation): MC=MR — the firm equates marginal cost to marginal revenue, maximising the surplus of revenue over costs. Q2 (revenue maximisation, Baumol): MR=0 — the firm maximises total revenue regardless of cost, typically reflecting managerial incentives. Q3 (sales maximisation): AR=AC — the firm maximises output subject to a normal profit constraint (zero economic profit). Q4 (productive efficiency): minimum AC — the firm operates at the lowest possible average cost, minimising resource waste. Q5 (allocative efficiency): AR=MC — price equals marginal cost, meaning the last unit produced is valued exactly at its resource cost, maximising social welfare. Key insight: all five outputs differ, and the order is always Q1 < Q4 < Q5 ≈ Q2 < Q3. A profit-maximising monopolist produces too little (Q1) relative to the social optimum (Q5). Evaluation: no single output satisfies all objectives simultaneously — there is an irreducible tension between profit, efficiency and managerial goals that regulation must navigate. Links to: profit maximisation, revenue maximisation, sales maximisation, productive efficiency, allocative efficiency.',
keyPoint:'Q1 (MC=MR): profit max. Q2 (MR=0): revenue max. Q3 (AR=AC): sales max. Q4 (min AC): productive efficiency. Q5 (AR=MC): allocative efficiency. Order: Q1 < Q4 < Q5 ≈ Q2 < Q3. Evaluation: the gap between Q1 (monopoly profit max) and Q5 (allocative efficiency) is the core welfare loss from monopoly — regulators use this to justify price caps, profit regulation or forced output expansion. Competition drives firms toward Q5; monopoly power pulls them toward Q1. Links: Profit Maximisation, Revenue Maximisation, Sales Maximisation, Productive Efficiency, Allocative Efficiency, Monopoly Regulation. UK example: Ofwat regulates Thames Water toward Q5 (P=MC pricing) rather than Q1 (profit max) — without regulation, the natural monopoly would restrict output to Q1, raising prices and creating the DWL triangle between Q1 and Q5.'},


{id:34,category:'structures',catLabel:'Market Structures',concept:'Perfect Competition: Short Run',diagramType:'pcShortRun',explanation:'In perfect competition, many firms sell a homogeneous product with perfect information and free entry/exit. Each firm is a price taker — it faces a perfectly elastic (horizontal) demand curve at the market price P = AR = MR. It maximises profit at MC = MR = P. If P > AC at Q*, the firm earns supernormal profit — the rectangle between the price line and the AC curve. If P < AC, the firm makes a loss but continues in the short run if P > AVC (covers variable costs). If P < AVC it shuts down immediately. Key assumption: perfect information and homogeneous products — in reality, even commodity markets have some product differentiation and information asymmetry. Evaluation: short-run supernormal profit is the signal mechanism that drives entry — it is not a permanent feature of perfect competition but a temporary disequilibrium. The SR diagram must be read alongside the LR diagram to understand the full dynamic. Links to: PC long run, barriers to entry, profit maximisation, shut-down condition.',keyPoint:'PC: P = AR = MR (horizontal). Profit max: MC = MR = P. SR: SNP if P > AC; loss if P < AC but P > AVC (continue); shut down if P < AVC. Evaluation: the PC model is an ideal type — no real market fully satisfies all conditions. Its value is as a benchmark for assessing allocative and productive efficiency, and for understanding how competition erodes profits over time. Links: Perfect Competition LR, Barriers to Entry, Shut-Down Condition, MC. UK example: UK wheat farming approximates perfect competition — homogeneous product, many producers, price set in global commodity markets. In high-harvest years (high global supply, low P), some farms earn losses but continue if P > AVC; in low-harvest years (high P), supernormal profits attract acreage expansion.'},
{id:33,category:'structures',catLabel:'Market Structures',concept:'Perfect Competition: Long Run',diagramType:'pcLongRun',explanation:'Supernormal profits attract new entrants, increasing market supply and driving down the equilibrium price. This continues until P = minimum AC — only normal profit remains. The long-run equilibrium condition P = MC = minimum AC means the firm simultaneously achieves: allocative efficiency (P = MC — last unit is worth exactly what it costs), and productive efficiency (P = minimum AC — lowest possible average cost). Economic profit is competed away entirely. Evaluation: the LR perfectly competitive equilibrium is the standard of economic efficiency — it is the benchmark against which all other market structures are judged. However, achieving it requires conditions rarely met: perfect information, identical products, free entry/exit, no economies of scale. Most markets occupy an intermediate position. Links to: allocative efficiency, productive efficiency, barriers to entry, market structures.',keyPoint:'LR: entry → ↑ market S → ↓ P → SNP eroded → P = min AC (normal profit). P = MC = min AC: allocatively + productively efficient. Evaluation: PC long-run equilibrium is the ideal but dynamic inefficiency is possible — perfectly competitive markets may underinvest in R&D because profits are competed away, leaving no surplus for innovation. Monopoly may be dynamically efficient despite static inefficiencies (Schumpeter\'s creative destruction). Links: Allocative Efficiency, Productive Efficiency, Monopolistic Competition LR, Monopoly. UK example: the UK app development market showed PC-like dynamics — high early profits attracted thousands of developers, supply expanded, prices fell toward MC. Most apps now earn zero economic profit, consistent with LR PC equilibrium.'},
{id:37,category:'structures',catLabel:'Market Structures',concept:'Monopolistic Competition: Short Run',diagramType:'monoComp',shift:'shortRun',explanation:'Monopolistic competition combines elements of both monopoly and perfect competition: many firms, low barriers to entry, but differentiated products giving each firm a downward-sloping AR curve and limited pricing power. In the short run, firms maximise profit at MC = MR, producing Q1 at price P1. If P1 > AC, supernormal profit is earned — the shaded rectangle. The downward-sloping AR reflects product differentiation (branding, location, quality) that creates consumer loyalty and some inelasticity of demand for each firm\'s specific product. Key assumption: product differentiation is meaningful to consumers — if products were truly homogeneous, the model collapses to perfect competition. Evaluation: the SR supernormal profit is a signal for entry — but new entrants offer slightly different differentiated products rather than identical ones, so they do not perfectly replicate the profitable firm\'s product. The entry still erodes demand for the original firm. Links to: monopolistic competition LR, product differentiation, barriers to entry.',keyPoint:'Many firms, differentiated products, low barriers. Downward-sloping AR. SR: MC = MR → Q1, P1. SNP if P1 > AC. Evaluation: the width of the SNP rectangle depends on the degree of differentiation — strongly differentiated brands (Apple in some sense) can sustain larger margins; weakly differentiated products face near-competitive conditions. Advertising and innovation are continuous processes to maintain differentiation and AR. Links: Monopolistic Competition LR, Product Differentiation, Advertising, Revenue & Profit. UK example: the UK coffee shop market (Costa, Caffè Nero, Pret, independents) displays monopolistic competition — each brand is differentiated by atmosphere, quality and location. Post-pandemic recovery generated short-run supernormal profits before new entrants expanded supply.'},
{id:38,category:'structures',catLabel:'Market Structures',concept:'Monopolistic Competition: Long Run',diagramType:'monoComp',shift:'longRun',explanation:'New entry in monopolistic competition shifts each firm\'s AR curve leftward — more competitors erode each firm\'s market share and demand. Entry continues until the AR curve is tangent to the ATC curve — the tangency condition. At the tangency point, P = AC and only normal profit is earned. The tangency necessarily occurs to the left of the ATC minimum, meaning the firm operates below its most efficient scale — excess capacity and productive inefficiency persist. This is the key long-run welfare cost of monopolistic competition: productive inefficiency from excess capacity. However, product variety is the counterbalancing benefit. Evaluation: whether the gains from variety outweigh the productive inefficiency cost is debated — Chamberlin argued variety is worth the excess capacity; critics (Samuelson) argued the welfare loss is significant in industries where variety adds little genuine value. Links to: productive efficiency, excess capacity, product differentiation, monopoly welfare comparison.',keyPoint:'LR: entry → AR shifts left → tangent to ATC → P = AC (normal profit). Tangency left of ATC min → excess capacity + productive inefficiency. Evaluation: excess capacity represents the social cost of product variety — the economy could produce more output if all firms operated at minimum ATC. But standardisation (eliminating variety) is also welfare-reducing. The optimal degree of variety is difficult to determine. Links: Productive Efficiency, Excess Capacity, Perfect Competition LR, Monopoly. UK example: UK independent restaurants reach LR equilibrium with razor-thin margins — entry erodes SNP until P ≈ AC. The industry\'s 60% failure rate within 3 years reflects this competitive pressure, consistent with the MC LR equilibrium of normal profit only.'},
{id:39,category:'structures',catLabel:'Market Structures',concept:'Oligopoly: Kinked Demand',diagramType:'kinkedDemand',explanation:'Sweezy\'s kinked demand model explains price stickiness in oligopoly. Each firm assumes rivals will match price cuts (preventing any demand gain from cutting price) but not match price rises (so the firm loses customers if it raises price). This creates a kink in the demand curve at the current price P*, with a more elastic curve above (rivals do not follow) and less elastic below (rivals follow). The kink in AR creates a vertical discontinuity (gap) in the MR curve at the current output. MC can shift anywhere within this MR gap without changing the profit-maximising price or output — explaining why oligopoly prices are sticky even when costs change significantly. Key assumption: rivals\' reactions are asymmetric and predictable — in practice, collusion, price leadership, and game theory models provide alternative explanations for oligopoly behaviour. Evaluation: the kinked demand model explains price stickiness but not price determination — it cannot explain where the kink price P* is set initially. Links to: oligopoly, game theory, collusion, price leadership.',keyPoint:'Kinked D at P*: elastic above (rivals don\'t follow ↑P), inelastic below (rivals match ↓P). Discontinuous MR gap at Q*. MC shifts within gap → P* and Q* unchanged → explains price stickiness. Evaluation: the model has been criticised for being ad hoc — it assumes the asymmetric reaction without explaining why rivals would always behave this way. Stigler (1947) found little empirical evidence for the kink. Game theory (Nash equilibrium, prisoner\'s dilemma) provides a more rigorous foundation for oligopoly behaviour. Links: Game Theory, Collusion, Price Leadership, Barriers to Entry. UK example: UK petrol forecourt pricing shows kinked demand — when one supermarket raises forecourt prices, rivals do not follow (elastic above kink); when prices fall, all follow immediately (inelastic below kink), consistent with Sweezy\'s asymmetric reaction.'},
{id:40,category:'structures',catLabel:'Market Structures',concept:'Natural Monopoly',diagramType:'naturalMono',explanation:'A natural monopoly arises when the LRAC curve falls continuously across the full range of market demand — one firm can supply the entire market at lower average cost than any number of competing firms. This occurs when fixed costs are very high (network infrastructure) and marginal costs are very low. MC pricing achieves allocative efficiency (P = MC) but produces a loss since LRAC > MC at all outputs — a subsidy is required. Average cost pricing (P = AC) achieves normal profit (no subsidy) but allocative inefficiency persists (P > MC). Key assumption: the natural monopoly is persistent — in practice, technological change can erode natural monopoly (mobile phones disrupted BT\'s fixed-line monopoly). Evaluation: the key regulatory debate is between P = MC (allocative efficiency, needs subsidy) and P = AC (financial viability without subsidy, allocative inefficiency). RPI − X price cap regulation attempts to mimic competitive outcomes without full government ownership. Links to: regulation, LRAC, allocative efficiency, privatisation.',keyPoint:'LRAC falls across full demand range → one firm cheapest. MC pricing: P = MC (allocatively efficient) but P < LRAC → loss → subsidy needed. AC pricing: P = AC → normal profit, allocatively inefficient (P > MC). Evaluation: technological disruption can destroy natural monopolies — the internet fragmented many previously monopolistic media and telecoms markets. Regulatory design must anticipate this possibility and avoid locking in monopoly structures that technology may make unnecessary. Links: Regulation, LRAC, RPI-X, Privatisation. UK example: UK water supply is a classic natural monopoly — duplicating pipe networks would cost hundreds of billions and be wasteful. Ofwat uses price cap regulation (a form of AC pricing) to limit monopoly profits while avoiding the need for direct subsidy.'},
{id:41,category:'structures',catLabel:'Market Structures',concept:'Price Discrimination — Peak & Off-Peak',diagramType:'peakPricing',explanation:'Third-degree price discrimination charges different prices to different market segments based on price elasticity of demand. Peak consumers (commuters, urgent travellers) have inelastic demand — they must travel at specific times, so firms charge P1 (high). Off-peak consumers (leisure travellers, flexible shoppers) have elastic demand — they can shift timing or mode, so firms charge P2 < P1. The firm sets MC = MR in each sub-market separately. Conditions required: ability to identify and separate segments, different PEDs across segments, and no resale between segments. Total output and profit are both higher than under single-price monopoly. Welfare effects are mixed: some consumers gain (off-peak get lower prices), some lose (peak consumers pay more). Evaluation: price discrimination reduces the DWL from monopoly — output is closer to the competitive level — but distributional concerns arise if those paying higher prices are poorer. Links to: PED, monopoly, consumer surplus, DWL.',keyPoint:'3rd degree PD: different prices for different segments based on PED. Peak: inelastic DL → high P1. Off-peak: elastic DL → low P2. MC = MR in each segment. Conditions: segment identifiability, different PED, no resale. Evaluation: price discrimination is welfare-ambiguous — it reduces DWL (more output) but reduces consumer surplus (firms capture more). Perfect price discrimination (1st degree) would eliminate DWL entirely but transfer all CS to the producer. Regulators allow PD when it expands output and access. Links: PED, Monopoly, Consumer Surplus, DWL. UK example: UK train operators charge peak fares up to 5× off-peak rates — commuters (inelastic, must travel 7–9am) pay P1; leisure travellers (elastic, can travel off-peak) pay P2. Advance tickets lock in leisure demand at P2, preventing resale at peak prices.'}
];

const D='#3b82f6',S='#10b981',R='#ef4444',MSC='#f97316',MSB='#8b5cf6',AM='#f59e0b',MU='#64748b',LB='#94a3b8',LC='#06b6d4',MO='#ec4899';
function miAx(x0,y0,x1,y1,xl,yl){return `<line x1="${x0}" y1="${y0}" x2="${x0}" y2="${y1}" stroke="${MU}" stroke-width="1.5"/><line x1="${x0}" y1="${y0}" x2="${x1}" y2="${y0}" stroke="${MU}" stroke-width="1.5"/><text x="${x1+2}" y="${y0+3}" fill="${LB}" font-size="8">${xl}</text><text x="${x0-3}" y="${y1-2}" fill="${LB}" font-size="8" text-anchor="end">${yl}</text>`;}
function miArw(id,c){return `<marker id="${id}" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto"><path d="M0,0 L0,7 L7,3.5 Z" fill="${c}"/></marker>`;}

function buildMicroDiagram(c){
  const t=c.diagramType,s=c.shift||'base';
  if(t==='demand')       return demD();
  if(t==='supply')       return supD();
  if(t==='market')       return mktD(s);
  if(t==='related')      return relD();
  if(t==='substitutes')  return substitutesD();
  if(t==='complements')  return complementsD();
  if(t==='normalGood')   return normalGoodD();
  if(t==='inferiorGood') return inferiorGoodD();
  if(t==='meritGood')    return meritGoodD();
  if(t==='demeritGood')  return demeritGoodD();
  if(t==='ped')          return pedD(s);
  if(t==='pedAlong')     return pedAlD();
  if(t==='pes')          return pesD(s);
  if(t==='surplus')      return surD(s);
  if(t==='totalRevenue') return trD();
  if(t==='externality')  return extD(s);
  if(t==='information')  return infD();
  if(t==='labour')       return labD(s);
  if(t==='tradeUnion')   return tradeUnionD();
  if(t==='kuznetsCurve')  return kuznetsCurveD();
  if(t==='backwardsBend') return backwardsBendD();
  if(t==='mrp')          return mrpD();
  if(t==='monopsony')    return monopD();
  if(t==='srCosts')      return srD();
  if(t==='mc')           return mcD();
  if(t==='srCostsFull')  return srCostsD();
  if(t==='elasticLab')   return elasticLabD();
  if(t==='inelasticLab') return inelasticLabD();
  if(t==='adValorem')    return adValoremD();
  if(t==='revenueCompare') return rcD();
  if(t==='revPriceMaker')  return rcPriceMakerD();
  if(t==='diminishing')  return dimD();
  if(t==='lrac')         return lracD(s);
  if(t==='envelope')      return envelopeD();
  if(t==='xIneff')        return xIneffD();
  if(t==='mcpD'||t==='mc') return mcpD(s);
  if(t==='kinkedDemand') return kdD();
  if(t==='indirectTax')  return taxD();
  if(t==='subsidy')      return subD();
  if(t==='priceControl') return pcD(s);
  if(t==='taxInelastic')  return taxInelasticD();
  if(t==='taxElastic')    return taxElasticD();
  if(t==='revenueCompare') return rcD();
  if(t==='marginalRevenue') return mrD();
  if(t==='maxWage')      return maxWageD();
  if(t==='prodCost')     return prodCostD();
  if(t==='atcShift')     return atcShiftD();
  if(t==='pcLongRun')    return pcLRD();
  if(t==='pcShortRun')   return pcSRD();
  if(t==='monopoly')     return monoD();
  if(t==='prodEffMono')  return prodEffMonoD();
  if(t==='revMaxMono')   return revMaxMonoD();
  if(t==='shutDown')      return shutDownD();
  if(t==='fixedCost')     return fixedCostD();
  if(t==='varCost')       return varCostD();
  if(t==='microObj')      return microObjD();
  if(t==='salesMax')      return salesMaxD();

  if(t==='monoComp')     return monoCompD(s);
  if(t==='naturalMono')  return natMonoD();
  if(t==='peakPricing')  return peakPricingD();
  return csD();
}

function mrD(){
  // Two-panel diagram matching screenshot: PRICE MAKERS revenue curves.
  // TOP panel (y=0–85): TR curve — inverted U (parabola). Starts at origin, rises to peak at midpoint Q, falls back to x-axis.
  // BOTTOM panel (y=88–168): AR and MR lines.
  //   AR: downward sloping grey line from top-left to bottom-right.
  //   MR: steeper downward sloping dark line, same y-intercept as AR, twice the slope — hits x-axis at midpoint, goes below.
  //   PED=-1 dashed vertical at midpoint (where MR=0, TR is max).
  //   "Elastic demand" label left of midpoint (MR>0), "Inelastic demand" label right (MR<0).
  //   Horizontal line at MR=0 (the x-axis of lower panel).
  // Shared x-axis midpoint: x=120. Both panels span x=28 to x=210.
  const mid=120; // x where MR=0, TR is max, PED=-1
  return `<svg viewBox="0 0 220 170">
    <!-- TOP PANEL: TR curve -->
    <text x="110" y="10" fill="${S}" font-size="8" font-weight="bold" text-anchor="middle">PRICE MAKERS</text>
    <!-- Top axes -->
    <line x1="28" y1="80" x2="210" y2="80" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="14" x2="28" y2="80" stroke="${MU}" stroke-width="1.5"/>
    <text x="14" y="17" fill="${LB}" font-size="6.5">Total</text>
    <text x="14" y="25" fill="${LB}" font-size="6.5">revenue</text>
    <text x="212" y="83" fill="${LB}" font-size="7">Output</text>
    <!-- TR: inverted U parabola. Origin (28,80), peak at (120,18), back to (212,80). -->
    <path d="M28 80 C55 80 80 14 ${mid} 14 C160 14 185 80 212 80" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="200" y="72" fill="${S}" font-size="8" font-weight="bold">TR</text>
    <!-- PED=-1 dashed vertical through both panels -->
    <line x1="${mid}" y1="18" x2="${mid}" y2="148" stroke="${D}" stroke-width="1" stroke-dasharray="4,3"/>
    <!-- BOTTOM PANEL: AR and MR -->
    <!-- Bottom axes -->
    <line x1="28" y1="148" x2="210" y2="148" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="88" x2="28" y2="155" stroke="${MU}" stroke-width="1.5"/>
    <text x="12" y="92" fill="${LB}" font-size="6">Costs and</text>
    <text x="12" y="100" fill="${LB}" font-size="6">Revenue</text>
    <text x="212" y="151" fill="${LB}" font-size="7">Output</text>
    <!-- AR: grey, downward sloping from (28,92) to (212,148) -->
    <path d="M28 92 L212 148" stroke="${MU}" stroke-width="2" fill="none"/>
    <text x="214" y="146" fill="${MU}" font-size="8" font-weight="bold">AR</text>
    <!-- MR: dark, same y-intercept (28,92), twice slope — hits x-axis (148) at midpoint (120,148), continues below -->
    <path d="M28 92 L${mid} 148" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <path d="M${mid} 148 L170 170" stroke="${MU}" stroke-width="2" stroke-dasharray="4,3" fill="none"/>
    <text x="172" y="170" fill="${MU}" font-size="8" font-weight="bold">MR</text>
    <!-- MR=0 dot -->
    <circle cx="${mid}" cy="148" r="3" fill="${MU}"/>
    <!-- PED=-1 label -->
    <text x="${mid+3}" y="112" fill="${D}" font-size="6.5">PED = −1</text>
    <!-- Elastic / Inelastic labels at bottom -->
    <text x="74" y="162" fill="${LB}" font-size="6.5" text-anchor="middle">Elastic</text>
    <text x="74" y="170" fill="${LB}" font-size="6.5" text-anchor="middle">demand</text>
    <text x="165" y="162" fill="${LB}" font-size="6.5" text-anchor="middle">Inelastic</text>
    <text x="165" y="170" fill="${LB}" font-size="6.5" text-anchor="middle">demand</text>
  </svg>`;
}


function maxWageD(){
  // Maximum wage (price ceiling in labour market). Set BELOW free-market W*.
  // At Wmax < W*: firms demand MORE labour (Qd on DL) but fewer workers supply (Qs on SL).
  // Result: labour shortage = excess demand (Qd > Qs). NOT in the PowerPoint — standard textbook.
  // DL downward: M30,25 L196,145. SL upward: M30,145 L196,25.
  // W* = intersection at (113,85). Wmax at y=108 (below W* in SVG, so lower wage).
  // At y=108 on DL: t=(108-25)/120=0.692 → x=30+166*0.692=145. Qd=145.
  // At y=108 on SL: t=(145-108)/120=0.308 → x=30+166*0.308=81. Qs=81.
  const wmax=108;
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','Wage')}
    <path d="M30 25 L196 145" stroke="${D}" stroke-width="2" fill="none"/>
    <text x="198" y="143" fill="${D}" font-size="9" font-weight="bold">DL</text>
    <path d="M30 145 L196 25" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="198" y="23" fill="${S}" font-size="9" font-weight="bold">SL</text>
    <!-- W* free market equilibrium -->
    <circle cx="113" cy="85" r="3" fill="white" opacity="0.5"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
    <text x="20" y="88" fill="${MU}" font-size="7" opacity="0.7">W*</text>
    <!-- Maximum wage line BELOW W* -->
    <line x1="28" y1="${wmax}" x2="212" y2="${wmax}" stroke="${R}" stroke-width="2"/>
    <text x="214" y="${wmax+3}" fill="${R}" font-size="7.5">Wmax</text>
    <text x="20" y="${wmax+3}" fill="${R}" font-size="7">Wmax</text>
    <!-- Qs on SL at wmax: x=81 -->
    <circle cx="81" cy="${wmax}" r="3.5" fill="${S}"/>
    <!-- Qd on DL at wmax: x=145 -->
    <circle cx="145" cy="${wmax}" r="3.5" fill="${D}"/>
    <!-- Shortage bracket -->
    <line x1="81" y1="${wmax+10}" x2="145" y2="${wmax+10}" stroke="${R}" stroke-width="2"/>
    <line x1="81" y1="${wmax+6}" x2="81" y2="${wmax+14}" stroke="${R}" stroke-width="1.5"/>
    <line x1="145" y1="${wmax+6}" x2="145" y2="${wmax+14}" stroke="${R}" stroke-width="1.5"/>
    <line x1="81" y1="${wmax}" x2="81" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="145" y1="${wmax}" x2="145" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="77" y="157" fill="${S}" font-size="7">Qs</text>
    <text x="141" y="157" fill="${D}" font-size="7">Qd</text>
    <text x="113" y="${wmax+24}" fill="${R}" font-size="7.5" text-anchor="middle">Labour shortage: Qd &gt; Qs</text>
  </svg>`;
}



function demD(){return `<svg viewBox="0 0 220 168"><defs>${miArw('a1',D)}</defs>${miAx(28,152,212,16,'Q','P')}<path d="M42 26 L196 142" stroke="${D}" stroke-width="2.5" fill="none"/><text x="198" y="140" fill="${D}" font-size="10" font-weight="bold">D</text><circle cx="118" cy="84" r="3.5" fill="${D}"/><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="8">P₁</text><text x="114" y="162" fill="${LB}" font-size="8">Q₁</text><text x="108" y="167" fill="${LB}" font-size="6.5" text-anchor="middle">Inverse relationship: ↑P → ↓Qd (movement along curve)</text></svg>`;}

function supD(){return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M42 142 L196 26" stroke="${S}" stroke-width="2.5" fill="none"/><text x="198" y="24" fill="${S}" font-size="10" font-weight="bold">S</text><circle cx="118" cy="84" r="3.5" fill="${S}"/><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="8">P₁</text><text x="114" y="162" fill="${LB}" font-size="8">Q₁</text><text x="108" y="167" fill="${LB}" font-size="6.5" text-anchor="middle">Positive relationship: ↑P → ↑Qs (movement along curve)</text></svg>`;}

function prodCostD(){
  // Two-panel: TOP = MP (black, bold) and AP (blue, thin) curves. BOTTOM = MC (black, bold) and AC (blue, thin).
  // Both panels share Q vertical (dashed) at the same x position.
  // TOP: MP rises to peak, falls steeply. AP rises more gently, peaks later (where AP=MP), then falls.
  //   MP peak at xQ=88. AP peak (=MP crosses AP) at ~xQ=88 too per image (same Q).
  //   Actually from image: dashed Q is at MP peak. AP peak is slightly to the right.
  //   Let MP peak at x=90. AP peaks just after at ~x=110. MP falls below AP after crossing.
  // BOTTOM: MC = mirror of MP (U-shaped). Falls to min at Q, rises. AC = mirror of AP (wider U).
  //   MC min at Q=90 (same x). AC min slightly right of MC min.
  const xQ=95;
  return `<svg viewBox="0 0 220 178">
    <!-- TOP PANEL: MP and AP -->
    <line x1="28" y1="16" x2="28" y2="84" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="84" x2="210" y2="84" stroke="${MU}" stroke-width="1.5"/>
    <text x="6" y="20" fill="${LB}" font-size="6">Output /</text>
    <text x="4" y="28" fill="${LB}" font-size="6">product</text>
    <text x="212" y="87" fill="${LB}" font-size="7">Labour</text>
    <!-- AP: blue, thin. Rises gently, peaks at ~x=112, y=28, falls gently. -->
    <path d="M30 72 C48 60 68 32 112 28 C145 26 175 36 205 50" stroke="${D}" stroke-width="1.8" fill="none"/>
    <text x="207" y="48" fill="${D}" font-size="8">AP</text>
    <!-- MP: black bold. Starts lower-left, rises steeply to peak at xQ, falls steeply below AP. -->
    <path d="M30 78 C45 70 62 22 ${xQ} 20 C118 20 145 38 175 58 C190 66 200 72 205 76" stroke="${MU}" stroke-width="3" fill="none"/>
    <text x="185" y="80" fill="${MU}" font-size="8" font-weight="bold">MP</text>
    <!-- Dashed Q vertical top panel -->
    <line x1="${xQ}" y1="20" x2="${xQ}" y2="84" stroke="#999" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="${xQ-4}" y="92" fill="#999" font-size="7">Q</text>
    <!-- BOTTOM PANEL: MC and AC -->
    <line x1="28" y1="96" x2="28" y2="168" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="168" x2="210" y2="168" stroke="${MU}" stroke-width="1.5"/>
    <text x="4" y="102" fill="${LB}" font-size="6">Costs</text>
    <text x="4" y="110" fill="${LB}" font-size="6">and</text>
    <text x="4" y="118" fill="${LB}" font-size="6">Revenue</text>
    <text x="212" y="171" fill="${LB}" font-size="7">Output</text>
    <!-- AC: blue, thin, wide U. Min at ~x=112. -->
    <path d="M30 112 C48 124 68 152 112 156 C145 158 175 148 205 134" stroke="${D}" stroke-width="1.8" fill="none"/>
    <text x="207" y="132" fill="${D}" font-size="8">AC</text>
    <!-- MC: black bold, steep U. Min at xQ (mirror of MP peak). -->
    <path d="M30 108 C45 114 62 162 ${xQ} 164 C118 164 145 146 175 126 C190 118 200 110 205 106" stroke="${MU}" stroke-width="3" fill="none"/>
    <text x="207" y="104" fill="${MU}" font-size="8" font-weight="bold">MC</text>
    <!-- Dashed Q vertical bottom panel -->
    <line x1="${xQ}" y1="96" x2="${xQ}" y2="168" stroke="#999" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="${xQ-4}" y="176" fill="#999" font-size="7">Q</text>
  </svg>`;
}


function atcShiftD(){
  // Two U-shaped ATC curves. ATC (upper, starts higher on y-axis), ATC1 (lower).
  // Both same shape — ATC1 is a parallel downward shift.
  // ATC: starts top-left ~(30,22), wide U, min at ~(120,88), rises to ~(205,30).
  // ATC1: same shape, shifted down ~35px. Starts ~(30,55), min at ~(120,118), rises to ~(205,62).
  // No dashed lines, no equilibrium points — clean diagram.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','C & R')}
    <!-- ATC: upper curve -->
    <path d="M30 22 C55 22 80 100 120 88 C155 78 182 22 205 28" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="207" y="26" fill="${MU}" font-size="9" font-weight="bold">ATC</text>
    <!-- ATC1: lower curve (shifted down ~35px) -->
    <path d="M30 55 C55 55 80 132 120 122 C155 112 182 56 205 62" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="207" y="60" fill="${MU}" font-size="9" font-weight="bold">ATC1</text>
  </svg>`;
}


function mktD(sh){
  let ex='';
  if(sh==='equilibrium'){ex=`<circle cx="118" cy="84" r="4" fill="white" opacity="0.9"/><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="8">P*</text><text x="114" y="162" fill="${LB}" font-size="8">Q*</text>`;}
  else if(sh==='demandRight'){ex=`<defs>${miArw('da',R)}</defs><path d="M70 26 L210 138" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/><text x="206" y="136" fill="${R}" font-size="9">D₂</text><circle cx="118" cy="84" r="3" fill="white" opacity="0.5"/><circle cx="133" cy="76" r="3.5" fill="${R}"/><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="76" x2="133" y2="76" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="7.5">P₁</text><text x="20" y="79" fill="${R}" font-size="7.5">P₂</text><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="133" y1="76" x2="133" y2="152" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><text x="114" y="162" fill="${LB}" font-size="7">Q₁</text><text x="129" y="162" fill="${R}" font-size="7">Q₂</text><line x1="98" y1="36" x2="124" y2="36" stroke="${R}" stroke-width="1.5" marker-end="url(#da)"/>`;}
  else if(sh==='supplyRight'){ex=`<defs>${miArw('sa',R)}</defs><path d="M70 142 L210 34" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/><text x="206" y="32" fill="${R}" font-size="9">S₂</text><circle cx="118" cy="84" r="3" fill="white" opacity="0.5"/><circle cx="133" cy="96" r="3.5" fill="${R}"/><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="96" x2="133" y2="96" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="7.5">P₁</text><text x="20" y="99" fill="${R}" font-size="7.5">P₂</text><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="133" y1="96" x2="133" y2="152" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><text x="114" y="162" fill="${LB}" font-size="7">Q₁</text><text x="129" y="162" fill="${R}" font-size="7">Q₂</text><line x1="98" y1="122" x2="124" y2="122" stroke="${R}" stroke-width="1.5" marker-end="url(#sa)"/>`;}
  else if(sh==='shortage'){const p=118;ex=`<line x1="28" y1="${p}" x2="210" y2="${p}" stroke="${R}" stroke-width="2" stroke-dasharray="5,3"/><text x="20" y="${p+3}" fill="${R}" font-size="7.5">P₁</text><circle cx="79" cy="${p}" r="3.5" fill="${S}"/><circle cx="156" cy="${p}" r="3.5" fill="${D}"/><line x1="79" y1="${p+8}" x2="156" y2="${p+8}" stroke="${R}" stroke-width="2"/><line x1="79" y1="${p+4}" x2="79" y2="${p+12}" stroke="${R}" stroke-width="1.5"/><line x1="156" y1="${p+4}" x2="156" y2="${p+12}" stroke="${R}" stroke-width="1.5"/><text x="117" y="${p+22}" fill="${R}" font-size="7.5" text-anchor="middle">Shortage: Qd &gt; Qs</text><text x="72" y="${p-4}" fill="${S}" font-size="7">Qs</text><text x="152" y="${p-4}" fill="${D}" font-size="7">Qd</text>`;}
  else if(sh==='surplus'){const p=58;ex=`<line x1="28" y1="${p}" x2="210" y2="${p}" stroke="${R}" stroke-width="2" stroke-dasharray="5,3"/><text x="20" y="${p+3}" fill="${R}" font-size="7.5">P₁</text><circle cx="83" cy="${p}" r="3.5" fill="${D}"/><circle cx="152" cy="${p}" r="3.5" fill="${S}"/><line x1="83" y1="${p+8}" x2="152" y2="${p+8}" stroke="${R}" stroke-width="2"/><line x1="83" y1="${p+4}" x2="83" y2="${p+12}" stroke="${R}" stroke-width="1.5"/><line x1="152" y1="${p+4}" x2="152" y2="${p+12}" stroke="${R}" stroke-width="1.5"/><text x="117" y="${p+22}" fill="${R}" font-size="7.5" text-anchor="middle">Surplus: Qs &gt; Qd</text><text x="79" y="${p-4}" fill="${D}" font-size="7">Qd</text><text x="148" y="${p-4}" fill="${S}" font-size="7">Qs</text>`;}
  return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M42 142 L196 26" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="24" fill="${S}" font-size="9" font-weight="bold">S</text><path d="M42 26 L196 142" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="140" fill="${D}" font-size="9" font-weight="bold">D</text>${ex}</svg>`;}

function relD(){
  // Single panel: shows substitutes (D right) and complements (D left) on one diagram
  // Both use Good B market. When P_A rises:
  //   Substitutes → D_B shifts RIGHT (↑Q_B ↑P_B)
  //   Complements → D_B shifts LEFT  (↓Q_B ↓P_B)
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <defs>${miArw('rra',R)}${miArw('lra',S)}</defs>
    ${miAx(28,148,212,16,'Q_B','P_B')}
    <!-- D1: original demand for Good B -->
    <path d="M42 28 L196 142" stroke="${MU}" stroke-width="2" fill="none"/>
    <text x="192" y="155" fill="${MU}" font-size="8" font-weight="bold">D₁</text>
    <!-- D2: substitute — D shifts RIGHT when P_A rises (Cross-PED > 0) -->
    <path d="M72 28 L212 128" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="207" y="142" fill="${R}" font-size="7.5" font-weight="bold">D₂ sub</text>
    <!-- D3: complement — D shifts LEFT when P_A rises (Cross-PED < 0) -->
    <path d="M28 50 L166 142" stroke="${S}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="122" y="155" fill="${S}" font-size="7.5" font-weight="bold">D₂ comp</text>
    <!-- Shift arrows -->
    <line x1="138" y1="60" x2="162" y2="60" stroke="${R}" stroke-width="1.5" marker-end="url(#rra)"/>
    <line x1="108" y1="75" x2="84" y2="75" stroke="${S}" stroke-width="1.5" marker-end="url(#lra)"/>
    <!-- Labels -->
    <text x="168" y="58" fill="${R}" font-size="6.5">Sub ↑P_A</text>
    <text x="50" y="73" fill="${S}" font-size="6.5">Comp ↑P_A</text>
  </svg>`;
}


function substitutesD(){
  // Cross-price demand for Good B. Y = P of Good A. X = Q of Good B.
  // Upward sloping: ↑P_A → switch to B → ↑Q_B. Cross-PED > 0.
  // Curve M42,142 L192,22. At y=110: x=82. At y=55: x=151.
  return `<svg viewBox="0 0 220 175" xmlns="http://www.w3.org/2000/svg">
    <text x="110" y="11" fill="${D}" font-size="8.5" font-weight="bold" text-anchor="middle">SUBSTITUTES — Cross-Price Demand (Cross-PED &gt; 0)</text>
    <!-- Axes -->
    <line x1="36" y1="152" x2="36" y2="22" stroke="${MU}" stroke-width="1.5"/>
    <line x1="36" y1="152" x2="212" y2="152" stroke="${MU}" stroke-width="1.5"/>
    <!-- Y-axis label: P of Good A — rotated text along axis -->
    <text transform="rotate(-90,10,87)" x="10" y="87" fill="${LB}" font-size="7.5" font-weight="bold" text-anchor="middle">P of Good A</text>
    <!-- X-axis label: Q of Good B — centred below axis -->
    <!-- Upward-sloping cross-demand curve -->
    <path d="M 50 142 L 200 22" stroke="${D}" stroke-width="2.5" fill="none"/>
    <text x="196" y="20" fill="${D}" font-size="9" font-weight="bold">D_B</text>
    <!-- Point 1: low P of A → low Q of B -->
    <circle cx="90" cy="110" r="4" fill="${MU}"/>
    <line x1="36" y1="110" x2="90" y2="110" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="90" y1="110" x2="90" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="38" y="108" fill="${MU}" font-size="7" font-weight="bold">P_A₁</text>
    <text x="82" y="163" fill="${MU}" font-size="7">Q_B₁</text>
    <!-- Point 2: high P of A → high Q of B -->
    <circle cx="159" cy="55" r="4" fill="${R}"/>
    <line x1="36" y1="55" x2="159" y2="55" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="159" y1="55" x2="159" y2="152" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="38" y="53" fill="${R}" font-size="7" font-weight="bold">P_A₂</text>
    <text x="151" y="163" fill="${R}" font-size="7">Q_B₂</text>
    <text x="172" y="118" fill="${D}" font-size="6.5">↑P_A → ↑Q_B</text>
  </svg>`;
}
function complementsD(){
  // Cross-price demand for Good B. Y = P of Good A. X = Q of Good B.
  // Downward sloping: ↑P_A → buy less A and less B → ↓Q_B. Cross-PED < 0.
  // Curve M42,22 L192,142. At y=55 (high P_A): x=83 (low Q_B). At y=110 (low P_A): x=152 (high Q_B). ✓
  return `<svg viewBox="0 0 220 175" xmlns="http://www.w3.org/2000/svg">
    <text x="110" y="11" fill="${S}" font-size="8.5" font-weight="bold" text-anchor="middle">COMPLEMENTS — Cross-Price Demand (Cross-PED &lt; 0)</text>
    <!-- Axes -->
    <line x1="36" y1="152" x2="36" y2="22" stroke="${MU}" stroke-width="1.5"/>
    <line x1="36" y1="152" x2="212" y2="152" stroke="${MU}" stroke-width="1.5"/>
    <!-- Y-axis label: P of Good A — rotated -->
    <text transform="rotate(-90,10,87)" x="10" y="87" fill="${LB}" font-size="7.5" font-weight="bold" text-anchor="middle">P of Good A</text>
    <!-- X-axis label: Q of Good B -->
    <!-- Downward-sloping cross-demand curve -->
    <path d="M 50 22 L 200 142" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="186" y="148" fill="${S}" font-size="9" font-weight="bold">D_B</text>
    <!-- Point 1: low P of A → high Q of B -->
    <circle cx="160" cy="110" r="4" fill="${MU}"/>
    <line x1="36" y1="110" x2="160" y2="110" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="160" y1="110" x2="160" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="38" y="108" fill="${MU}" font-size="7" font-weight="bold">P_A₁</text>
    <text x="152" y="163" fill="${MU}" font-size="7">Q_B₁</text>
    <!-- Point 2: high P of A → low Q of B -->
    <circle cx="91" cy="55" r="4" fill="${R}"/>
    <line x1="36" y1="55" x2="91" y2="55" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="91" y1="55" x2="91" y2="152" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="38" y="53" fill="${R}" font-size="7" font-weight="bold">P_A₂</text>
    <text x="83" y="163" fill="${R}" font-size="7">Q_B₂</text>
    <text x="52" y="90" fill="${S}" font-size="6.5">↑P_A → ↓Q_B</text>
  </svg>`;
}

function normalGoodD(){
  // Engel curve: Y-axis = Income, X-axis = Quantity. Upward sloping (positive YED).
  // As income rises, quantity demanded rises. Normal good.
  // Curve upward: M42,142 L192,22 in SVG (top=high income, bottom=low income).
  // At Income1 (y=110): x=42+150*(142-110)/120=42+40=82. At Income2 (y=55): x=42+150*87/120=151.
  return `<svg viewBox="0 0 220 172" xmlns="http://www.w3.org/2000/svg">
    <text x="110" y="11" fill="${D}" font-size="8.5" font-weight="bold" text-anchor="middle">NORMAL GOOD — Income &amp; Demand (YED &gt; 0)</text>
    ${miAx(28,148,212,18,'Quantity Demanded','Income')}
    <!-- Upward-sloping Engel curve: as income rises, Q demanded rises -->
    <path d="M 42 142 L 192 22" stroke="${D}" stroke-width="3" fill="none"/>
    <text x="194" y="20" fill="${D}" font-size="9" font-weight="bold">Engel</text>
    <!-- Point A: lower income, lower Q -->
    <circle cx="82" cy="110" r="4" fill="${MU}"/>
    <line x1="28" y1="110" x2="82" y2="110" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="82" y1="110" x2="82" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="15" y="113" fill="${MU}" font-size="7.5" font-weight="bold">Y₁</text>
    <text x="77" y="159" fill="${MU}" font-size="7.5">Q₁</text>
    <!-- Point B: higher income, higher Q -->
    <circle cx="151" cy="55" r="4" fill="${R}"/>
    <line x1="28" y1="55" x2="151" y2="55" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="151" y1="55" x2="151" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="15" y="58" fill="${R}" font-size="7.5" font-weight="bold">Y₂</text>
    <text x="146" y="159" fill="${R}" font-size="7.5">Q₂</text>
    <text x="165" y="110" fill="${D}" font-size="7" opacity="0.8">↑Income</text>
    <text x="165" y="120" fill="${D}" font-size="7" opacity="0.8">→ ↑Qd</text>
    <text x="110" y="171" fill="${MU}" font-size="7" text-anchor="middle">↑Income → ↑Qd. Positive relationship. YED &gt; 0. e.g. restaurant meals, new cars, holidays.</text>
  </svg>`;
}

function inferiorGoodD(){
  // Engel curve for inferior good: Y-axis = Income, X-axis = Quantity. DOWNWARD sloping (negative YED).
  // As income rises, consumers switch to superior goods — Q demanded of inferior good falls.
  // Curve: M42,22 L192,142 (downward sloping: high income/small y → low Q/small x).
  // At Income1 (y=110, lower income): x = 42+150*88/120 = 42+110 = 152. Q_B₁=152 (higher Q at lower income).
  // At Income2 (y=55, higher income): x = 42+150*33/120 = 42+41 = 83. Q_B₂=83 (lower Q at higher income).
  return `<svg viewBox="0 0 220 172" xmlns="http://www.w3.org/2000/svg">
    <text x="110" y="11" fill="${R}" font-size="8.5" font-weight="bold" text-anchor="middle">INFERIOR GOOD — Income &amp; Demand (YED &lt; 0)</text>
    ${miAx(28,148,212,18,'Quantity Demanded','Income')}
    <!-- Downward-sloping Engel curve: as income rises, Q demanded falls -->
    <path d="M 42 22 L 192 142" stroke="${R}" stroke-width="3" fill="none"/>
    <text x="194" y="140" fill="${R}" font-size="9" font-weight="bold">Engel</text>
    <!-- Point A: lower income, higher Q (buying more cheap inferior good) -->
    <circle cx="152" cy="110" r="4" fill="${MU}"/>
    <line x1="28" y1="110" x2="152" y2="110" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="152" y1="110" x2="152" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="15" y="113" fill="${MU}" font-size="7.5" font-weight="bold">Y₁</text>
    <text x="147" y="159" fill="${MU}" font-size="7.5">Q₁</text>
    <!-- Point B: higher income, lower Q (switching to superior alternatives) -->
    <circle cx="83" cy="55" r="4" fill="${R}"/>
    <line x1="28" y1="55" x2="83" y2="55" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="83" y1="55" x2="83" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="15" y="58" fill="${R}" font-size="7.5" font-weight="bold">Y₂</text>
    <text x="78" y="159" fill="${R}" font-size="7.5">Q₂</text>
    <text x="50" y="90" fill="${R}" font-size="7" opacity="0.9">↑Income</text>
    <text x="50" y="100" fill="${R}" font-size="7" opacity="0.9">→ ↓Qd</text>
    <text x="110" y="171" fill="${MU}" font-size="7" text-anchor="middle">↑Income → ↓Qd. Negative relationship. YED &lt; 0. e.g. bus travel, own-brand food.</text>
  </svg>`;
}
function pedD(sh){
  let cv='',nt='';
  if(sh==='inelastic'){
    // D line: M92,22 L136,144. x=92+44t, y=22+122t. At y=60: t=0.311→x=106. At y=92: t=0.574→x=117
    cv=`<path d="M92 22 L136 144" stroke="${D}" stroke-width="2.5" fill="none"/><text x="138" y="142" fill="${D}" font-size="9" font-weight="bold">D</text><line x1="28" y1="60" x2="106" y2="60" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="92" x2="117" y2="92" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><line x1="106" y1="60" x2="106" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="117" y1="92" x2="117" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><circle cx="106" cy="60" r="3" fill="${MU}"/><circle cx="117" cy="92" r="3" fill="${R}"/><text x="20" y="63" fill="${MU}" font-size="7.5">P₂</text><text x="20" y="95" fill="${R}" font-size="7.5">P₁</text><text x="100" y="157" fill="${MU}" font-size="7">Q₂</text><text x="113" y="157" fill="${R}" font-size="7">Q₁</text><text x="150" y="58" fill="${D}" font-size="7">↑P → small ↓Q</text>`;nt='Steep D — inelastic (PED &lt; 1)';}
  else if(sh==='elastic'){cv=`<path d="M38 55 L196 102" stroke="${D}" stroke-width="2.5" fill="none"/><text x="198" y="100" fill="${D}" font-size="9" font-weight="bold">D</text><line x1="28" y1="68" x2="78" y2="68" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="85" x2="148" y2="85" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><line x1="78" y1="68" x2="78" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="148" y1="85" x2="148" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="71" fill="${MU}" font-size="7.5">P₂</text><text x="20" y="88" fill="${R}" font-size="7.5">P₁</text><text x="74" y="157" fill="${MU}" font-size="7">Q₂</text><text x="144" y="157" fill="${R}" font-size="7">Q₁</text><text x="95" y="46" fill="${D}" font-size="7">↑P → large ↓Q</text>`;nt='Flat D — elastic (PED &gt; 1)';}
  else if(sh==='perfectlyInelastic'){cv=`<line x1="112" y1="22" x2="112" y2="148" stroke="${D}" stroke-width="2.5"/><text x="114" y="20" fill="${D}" font-size="8" font-weight="bold">D (PED=0)</text><line x1="28" y1="55" x2="112" y2="55" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="98" x2="112" y2="98" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="58" fill="${MU}" font-size="7.5">P₂</text><text x="20" y="101" fill="${R}" font-size="7.5">P₁</text><text x="108" y="157" fill="${D}" font-size="7">Q*</text>`;nt='Vertical D — perfectly inelastic (PED = 0)';}
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}${cv}<text x="110" y="167" fill="${LB}" font-size="7.5" text-anchor="middle">${nt}</text></svg>`;}

function pedAlD(){return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}<path d="M50 22 L192 148" stroke="${D}" stroke-width="2.5" fill="none"/><text x="194" y="146" fill="${D}" font-size="9" font-weight="bold">D</text><circle cx="121" cy="85" r="4" fill="${AM}"/><text x="125" y="83" fill="${AM}" font-size="8" font-weight="bold">PED = 1</text><rect x="50" y="22" width="71" height="63" fill="rgba(59,130,246,0.08)" rx="4"/><text x="85" y="50" fill="${D}" font-size="8" text-anchor="middle" font-weight="bold">ELASTIC</text><text x="85" y="62" fill="${D}" font-size="7" text-anchor="middle">PED &gt; 1</text><rect x="121" y="85" width="71" height="63" fill="rgba(239,68,68,0.08)" rx="4"/><text x="156" y="115" fill="${R}" font-size="8" text-anchor="middle" font-weight="bold">INELASTIC</text><text x="156" y="127" fill="${R}" font-size="7" text-anchor="middle">PED &lt; 1</text><text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">PED is NOT the gradient — it varies along a linear D curve</text></svg>`;}

function pesD(sh){
  let cv='',nt='';
  if(sh==='inelastic'){
    // S line: M82,148 L142,22. x=82+60t, y=148-126t. At y=62: t=(148-62)/126=0.683→x=82+41=123. At y=92: t=(148-92)/126=0.444→x=82+26.7=109
    cv=`<path d="M82 148 L142 22" stroke="${S}" stroke-width="2.5" fill="none"/><text x="144" y="20" fill="${S}" font-size="9" font-weight="bold">S</text><line x1="28" y1="62" x2="123" y2="62" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="92" x2="109" y2="92" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><line x1="123" y1="62" x2="123" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="109" y1="92" x2="109" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><circle cx="123" cy="62" r="3" fill="${MU}"/><circle cx="109" cy="92" r="3" fill="${R}"/><text x="20" y="65" fill="${MU}" font-size="7.5">P₂</text><text x="20" y="95" fill="${R}" font-size="7.5">P₁</text><text x="117" y="157" fill="${MU}" font-size="7">Q₂</text><text x="103" y="157" fill="${R}" font-size="7">Q₁</text>`;nt='Steep S — inelastic supply (PES &lt; 1)';}
  else{
    // S line: M38,115 L196,52. x=38+158t, y=115-63t. At y=68: t=(115-68)/63=0.746→x=38+118=156. At y=88: t=(115-88)/63=0.429→x=38+67.7=106
    cv=`<path d="M38 115 L196 52" stroke="${S}" stroke-width="2.5" fill="none"/><text x="198" y="50" fill="${S}" font-size="9" font-weight="bold">S</text><line x1="28" y1="68" x2="156" y2="68" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="28" y1="88" x2="106" y2="88" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><line x1="156" y1="68" x2="156" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="106" y1="88" x2="106" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><circle cx="156" cy="68" r="3" fill="${MU}"/><circle cx="106" cy="88" r="3" fill="${R}"/><text x="20" y="71" fill="${MU}" font-size="7.5">P₂</text><text x="20" y="91" fill="${R}" font-size="7.5">P₁</text><text x="150" y="157" fill="${MU}" font-size="7">Q₂</text><text x="100" y="157" fill="${R}" font-size="7">Q₁</text>`;nt='Flat S — elastic supply (PES &gt; 1)';}
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}${cv}<text x="110" y="167" fill="${LB}" font-size="7.5" text-anchor="middle">${nt}</text></svg>`;}

function surD(sh){
  if(sh==='base')return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M42 142 L196 26" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="24" fill="${S}" font-size="9" font-weight="bold">S</text><path d="M42 26 L196 142" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="140" fill="${D}" font-size="9" font-weight="bold">D</text><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="8">P*</text><text x="114" y="162" fill="${LB}" font-size="7">Q*</text><polygon points="42,26 42,84 118,84" fill="rgba(59,130,246,0.28)"/><text x="68" y="72" fill="${D}" font-size="9" font-weight="bold">CS</text><polygon points="42,142 42,84 118,84" fill="rgba(16,185,129,0.28)"/><text x="68" y="110" fill="${S}" font-size="9" font-weight="bold">PS</text><circle cx="118" cy="84" r="4" fill="white" opacity="0.9"/><text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">Total welfare = CS + PS — maximised at free market equilibrium</text></svg>`;
  const p2=60;return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M42 142 L196 26" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="24" fill="${S}" font-size="9">S</text><path d="M42 26 L196 142" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="140" fill="${D}" font-size="9">D</text><line x1="28" y1="${p2}" x2="84" y2="${p2}" stroke="${R}" stroke-width="1.5"/><text x="20" y="${p2+3}" fill="${R}" font-size="8">P₂</text><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${MU}" font-size="8">P₁</text><polygon points="42,26 42,${p2} 84,${p2}" fill="rgba(59,130,246,0.28)"/><text x="57" y="${p2-12}" fill="${D}" font-size="8">CS</text><polygon points="42,${p2} 42,84 118,84 84,${p2}" fill="rgba(16,185,129,0.28)"/><text x="68" y="76" fill="${S}" font-size="7.5">PS↑</text><polygon points="84,${p2} 118,84 84,84" fill="rgba(239,68,68,0.45)"/><text x="92" y="80" fill="${R}" font-size="7.5">DWL</text><circle cx="118" cy="84" r="3" fill="white" opacity="0.6"/><circle cx="84" cy="${p2}" r="3.5" fill="${R}"/><text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">↑P: CS shrinks. Part transfers to PS. DWL = permanently lost welfare.</text></svg>`;}

function trD(){return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M42 26 L196 142" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="140" fill="${D}" font-size="9" font-weight="bold">D = AR</text><line x1="28" y1="84" x2="118" y2="84" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="118" y1="84" x2="118" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="87" fill="${LB}" font-size="8">P*</text><text x="114" y="162" fill="${LB}" font-size="7">Q*</text><rect x="28" y="84" width="90" height="68" fill="rgba(245,158,11,0.28)"/><text x="72" y="126" fill="${AM}" font-size="9" font-weight="bold">TR = P×Q</text><circle cx="118" cy="84" r="3.5" fill="white" opacity="0.9"/><text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">Inelastic D: ↑P → ↑TR. Elastic D: ↑P → ↓TR.</text></svg>`;}

function extD(sh){
  let ex='',sb='';
  // ALL extra curves use IDENTICAL gradient to base MPC & MPB: slope = ±120/166 = ±0.7229.
  // MPC=S: M30,145 L196,25. MPB=D: M30,25 L196,145. Market eq: Qm=113, Pm=85.
  // Each extra curve is a pure 25px vertical shift of its paired base curve.
  if(sh==='negProd'){
    // MSC = MPC + MEC. Parallel to MPC, 25px HIGHER cost (lower y in SVG).
    // MSC: M30,120 L196,0. slope=-120/166=-0.7229 ✓ EXACT. 25px above MPC.
    // Social opt MSC∩MPB: 120-s*(x-30)=25+s*(x-30) → 95=2s*(x-30) → x=96, y_MPB=72. Qs=96, Ps=72.
    // DWL parallelogram between MPC and MSC from Qs to Qm:
    //   Qs=96: MPC y=98, MSC y=72. Qm=113: MPC y=85, MSC y=60.
    ex=`<path d="M30 120 L196 0" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="168" y="9" fill="${R}" font-size="8" font-weight="bold">MSC</text>
    <!-- Market eq (MPB∩MPC): Qm=113, Pm=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" opacity="0.8"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="88" fill="${MU}" font-size="7">P_m</text>
    <text x="109" y="157" fill="${MU}" font-size="7">Q_m</text>
    <!-- Social opt (MSC∩MPB): Qs=96, Ps=72 -->
    <circle cx="96" cy="72" r="3.5" fill="${R}"/>
    <line x1="28" y1="72" x2="96" y2="72" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="96" y1="72" x2="96" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="75" fill="${R}" font-size="7">P_s</text>
    <text x="92" y="157" fill="${R}" font-size="7">Q_s</text>
    <!-- DWL triangle: apex at Qs=96 where MSC∩MPB, base at Qm=113 between MSC and MPC -->
    <polygon points="96,72 113,60 113,85" fill="rgba(239,68,68,0.4)"/>
    <text x="103" y="80" fill="${R}" font-size="6.5">DWL</text>`;
    sb='MSC &gt; MPC: producer ignores external harm. Overproduction at Q_m &gt; Q_s. Tax reduces to social optimum.';}
  else if(sh==='posProd'){
    // MSC < MPC. Parallel to MPC, 25px LOWER cost (higher y in SVG).
    // MSC: M30,170 L196,50. slope=-120/166=-0.7229 ✓ EXACT. Clips at y=148: start x=60.
    // Visible path: M60,148 L196,50. (y=170-0.7229*(60-30)=170-21.7=148.3≈148 ✓)
    // Social opt MSC∩MPB: 170-s*(x-30)=25+s*(x-30) → 145=2s*(x-30) → x=130, y_MPB=98. Qs=130, Ps=98.
    // DWL parallelogram between MPC and MSC from Qm to Qs:
    //   Qm=113: MPC y=85, MSC y=110. Qs=130: MPC y=72, MSC y=97.
    ex=`<path d="M60 148 L196 50" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="198" y="50" fill="${R}" font-size="8" font-weight="bold">MSC</text>
    <!-- Market eq (MPB∩MPC): Qm=113, Pm=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" opacity="0.8"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="88" fill="${MU}" font-size="7">P_m</text>
    <text x="109" y="157" fill="${MU}" font-size="7">Q_m</text>
    <!-- Social opt (MSC∩MPB): Qs=130, Ps=98 -->
    <circle cx="130" cy="98" r="3.5" fill="${R}"/>
    <line x1="28" y1="98" x2="130" y2="98" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="130" y1="98" x2="130" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="101" fill="${R}" font-size="7">P_s</text>
    <text x="126" y="157" fill="${R}" font-size="7">Q_s</text>
    <!-- DWL triangle: apex at Qs=130 where MSC∩MPB, base at Qm=113 between MPC and MSC -->
    <polygon points="130,98 113,85 113,110" fill="rgba(239,68,68,0.4)"/>
    <text x="115" y="100" fill="${R}" font-size="6.5">DWL</text>`;
    sb='MSC &lt; MPC: positive spillover lowers social cost. Underproduction at Q_m &lt; Q_s. Subsidy raises to social optimum.';}
  else if(sh==='negCons'){
    // MSB < MPB. Parallel to MPB, 25px LOWER benefit (higher y in SVG).
    // MSB: M30,50 L196,170. slope=+120/166=+0.7229 ✓ EXACT. Clips at y=148: end x=166.
    // Visible path: M30,50 L166,148. (y=50+0.7229*(166-30)=50+98.3=148.3≈148 ✓)
    // Social opt MSB∩MPC: 50+s*(x-30)=145-s*(x-30) → 95=2s*(x-30) → x=96, y_MPC=98. Q*=96, P*=98.
    // DWL parallelogram between MPB and MSB, from Q* to Qm:
    //   Q*=96: MPB y=72, MSB y=98. Qm=113: MPB y=85, MSB y=110.
    ex=`<path d="M30 50 L166 148" stroke="${MSB}" stroke-width="2.5" fill="none"/>
    <text x="168" y="146" fill="${MSB}" font-size="8" font-weight="bold">MSB</text>
    <!-- Market eq (MPB∩MPC): Qm=113, Pm=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${R}" stroke-width="1.5"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="88" fill="${R}" font-size="7">P_m</text>
    <text x="109" y="157" fill="${R}" font-size="7">Q_m</text>
    <!-- Social optimum (MSB∩MPC): Q*=96, P*=98 -->
    <circle cx="96" cy="98" r="3.5" fill="${MSB}"/>
    <line x1="28" y1="98" x2="96" y2="98" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="96" y1="98" x2="96" y2="148" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="101" fill="${MSB}" font-size="7">P*</text>
    <text x="92" y="157" fill="${MSB}" font-size="7">Q*</text>
    <!-- DWL triangle: apex at Q*=96 where MSB∩MPC, base at Qm=113 between MPB and MSB -->
    <polygon points="96,98 113,85 113,110" fill="rgba(239,68,68,0.35)"/>
    <text x="103" y="103" fill="${R}" font-size="6.5">DWL</text>`;
    sb='MSB &lt; MPB: third-party harm ignored. Free market overconsumes at Q_m &gt; Q*. Tax reduces to social optimum.';}
  else if(sh==='posCons'){
    // MSB > MPB. Parallel to MPB, 25px HIGHER benefit (lower y in SVG).
    // MSB: M30,0 L196,120. slope=+120/166=+0.7229 ✓ EXACT. Clips at y=5: start x=57.
    // Visible path: M57,5 L196,120. (y=0+0.7229*(57-30)=19.5≈5? No: y=0.7229*(x-30). At y=5: x=30+5/0.7229=37.)
    // Actually: MSB y=0.7229*(x-30). At y=5: x=30+6.9=37. Clip start: M37,5 L196,120.
    // Social opt MSB∩MPC: 0.7229*(x-30)=145-0.7229*(x-30) → 145=2*0.7229*(x-30) → x=130, y_MSB=72. Q*=130, P*=72.
    // DWL parallelogram between MPB and MSB, from Qm to Q*:
    //   Qm=113: MPB y=85, MSB y=60. Q*=130: MPB y=98, MSB y=72.
    ex=`<path d="M37 5 L196 120" stroke="${MSB}" stroke-width="2.5" fill="none"/>
    <text x="198" y="118" fill="${MSB}" font-size="8" font-weight="bold">MSB</text>
    <!-- Market eq (MPB∩MPC): Qm=113, Pm=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="88" fill="${MU}" font-size="7">P_m</text>
    <text x="109" y="157" fill="${MU}" font-size="7">Q_m</text>
    <!-- Social optimum (MSB∩MPC): Q*=130, P*=72 -->
    <circle cx="130" cy="72" r="3.5" fill="${MSB}"/>
    <line x1="28" y1="72" x2="130" y2="72" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="130" y1="72" x2="130" y2="148" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="75" fill="${MSB}" font-size="7">P*</text>
    <text x="126" y="157" fill="${MSB}" font-size="7">Q*</text>
    <!-- DWL triangle: apex at Q*=130 where MSB∩MPC, base at Qm=113 between MSB and MPB -->
    <polygon points="130,73 113,60 113,85" fill="rgba(239,68,68,0.35)"/>
    <text x="116" y="78" fill="${R}" font-size="6.5">DWL</text>`;
    sb='MSB &gt; MPB: positive spill-over benefit ignored. Free market underconsumes at Q_m &lt; Q*. Subsidy raises to social optimum.';}
  else if(sh==='corrTax'){
    // MSC = MPC + Tax (per unit). Parallel to MPC, 25px HIGHER cost (lower y in SVG).
    // MSC: M30,120 L196,0. slope=-120/166=-0.7229 ✓ EXACT. Same shift as negProd MSC.
    // Social opt MSC∩MPB: 120-s*(x-30)=25+s*(x-30) → 95=2s*(x-30) → x=96, y_MPB=72. Qs=96, Ps=72.
    // Tax bracket at x=150: MPC y=58, MSC y=33. Gap=25px = per-unit tax.
    ex=`<path d="M30 120 L196 0" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="198" y="9" fill="${R}" font-size="7.5" font-weight="bold">MSC</text>
    <text x="198" y="18" fill="${R}" font-size="6.5">(MPC+Tax)</text>
    <!-- Original market eq Qm=113 (faint) — before tax -->
    <circle cx="113" cy="85" r="2.5" fill="white" opacity="0.5"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="0.8" stroke-dasharray="2,2" opacity="0.5"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="0.8" stroke-dasharray="2,2" opacity="0.4"/>
    <text x="109" y="157" fill="${MU}" font-size="6.5" opacity="0.7">Q_m</text>
    <!-- Social opt Qs=96, Ps=72 after tax (MSC∩MPB) -->
    <circle cx="96" cy="72" r="3.5" fill="${R}"/>
    <line x1="28" y1="72" x2="96" y2="72" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="96" y1="72" x2="96" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="92" y="157" fill="${R}" font-size="7">Q_s</text>
    <text x="18" y="75" fill="${R}" font-size="7">P_s</text>
    <!-- Tax bracket at x=150: gap between MPC and MSC = per-unit tax = MEC -->
    <line x1="150" y1="33" x2="150" y2="58" stroke="${R}" stroke-width="2.5"/>
    <line x1="145" y1="33" x2="155" y2="33" stroke="${R}" stroke-width="1.5"/>
    <line x1="145" y1="58" x2="155" y2="58" stroke="${R}" stroke-width="1.5"/>
    <text x="157" y="43" fill="${R}" font-size="7.5" font-weight="bold">Tax</text>
    <text x="157" y="53" fill="${R}" font-size="7">= MEC</text>`;
    sb='Per-unit tax = MEC → MPC shifts up to MSC → Q_m falls to Q_s. Polluter pays full social cost. DWL eliminated.';}
  return `<svg viewBox="0 0 220 165">${miAx(28,148,212,16,'Q','P')}<path d="M30 145 L196 25" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="23" fill="${S}" font-size="8" font-weight="bold">MPC=S</text><path d="M30 25 L196 145" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="143" fill="${D}" font-size="8" font-weight="bold">MPB=D</text>${ex}<text x="110" y="163" fill="${LB}" font-size="7" text-anchor="middle">${sb}</text></svg>`;}

function infD(){
  // Slide 70: Two panels. LEFT=merit good (underconsumption). RIGHT=demerit good (overconsumption).
  // Each: S=MSC upward, D_actual downward. D_full_info ABOVE D_actual (merit) or BELOW (demerit).
  // S∩D_actual = market eq. S∩D_full = social optimum.
  // LEFT merit: Q* > Q (underconsume). P* > P. RIGHT demerit: Q* < Q (overconsume). P* < P.
  const la = miAx(14,100,107,16,'Q','P');
  const ra = miAx(116,100,210,16,'Q','P');

  // LEFT: S: M14,98 L100,20. D_actual: M14,18 L100,96. D_full: M14,10 L98,80 (above D_actual).
  // S: x=14+86t, y=98-78t. D_actual: x=14+86t, y=18+78t. S∩D_actual: 98-78t=18+78t → 80=156t → t=0.513 → x=58,y=58.
  // D_full (above): M14,8 L96,78. S∩D_full: 98-78t=8+70t → 90=148t → t=0.608 → x=14+86*0.608=66,y=98-78*0.608=50.
  // So market (Q,P)=(58,58), social opt (Q*,P*)=(66,50). Q*>Q ✓ P* has lower y=50 > P y=58 → P*>P ✓

  // RIGHT: S: M116,98 L202,20. D_actual: M116,18 L202,96. D_full (below): M116,28 L202,100.
  // S∩D_actual: same as left → (160,58). D_full below: M116,28 L202,100. y=28+72t, x=116+86t.
  // S∩D_full: 98-78t=28+72t → 70=150t → t=0.467 → x=116+86*0.467=156,y=98-78*0.467=62.
  // Market (Q,P)=(160,58). Social opt (Q*,P*)=(156,62). Q*<Q ✓ P* has higher y=62 > y=58 → P*<P ✓

  return `<svg viewBox="0 0 220 168">
    <text x="60" y="9" fill="${MSB}" font-size="7.5" font-weight="bold" text-anchor="middle">MERIT GOOD</text>
    <text x="163" y="9" fill="${R}" font-size="7.5" font-weight="bold" text-anchor="middle">DEMERIT GOOD</text>
    ${la}${ra}

    <!-- LEFT: S=MSC -->
    <path d="M14 98 L100 20" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="102" y="18" fill="${S}" font-size="7">S=MSC</text>
    <!-- D_actual (MPB): dashed -->
    <path d="M14 18 L100 96" stroke="${D}" stroke-width="1.8" stroke-dasharray="5,3" fill="none"/>
    <text x="102" y="96" fill="${D}" font-size="7">D actual</text>
    <!-- D_full_info (MSB): above D_actual, solid -->
    <path d="M14 8 L96 78" stroke="${MSB}" stroke-width="2" fill="none"/>
    <text x="98" y="76" fill="${MSB}" font-size="7">D full info</text>
    <!-- Market eq (Q,P): S∩D_actual at (58,58) — green dashed -->
    <circle cx="58" cy="58" r="2.5" fill="${S}"/>
    <line x1="14" y1="58" x2="58" y2="58" stroke="${S}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="58" y1="58" x2="58" y2="100" stroke="${S}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="14" y="61" fill="${S}" font-size="6.5">P</text>
    <text x="54" y="108" fill="${S}" font-size="6.5">Q</text>
    <!-- Social opt (Q*,P*): S∩D_full at (66,50) — red dashed -->
    <circle cx="66" cy="50" r="2.5" fill="${MSB}"/>
    <line x1="14" y1="50" x2="66" y2="50" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="66" y1="50" x2="66" y2="100" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="14" y="53" fill="${R}" font-size="6.5">P*</text>
    <text x="63" y="108" fill="${R}" font-size="6.5">Q*</text>
    <text x="60" y="120" fill="${MSB}" font-size="6" text-anchor="middle">Underconsumption</text>
    <text x="60" y="129" fill="${LB}" font-size="6" text-anchor="middle">Q &lt; Q* — full info raises D</text>

    <!-- RIGHT: S=MSC -->
    <path d="M116 98 L202 20" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="204" y="18" fill="${S}" font-size="7">S=MSC</text>
    <!-- D_actual (MPB): dashed -->
    <path d="M116 18 L202 96" stroke="${D}" stroke-width="1.8" stroke-dasharray="5,3" fill="none"/>
    <text x="204" y="96" fill="${D}" font-size="7">D actual</text>
    <!-- D_full_info (MSB): below D_actual, solid -->
    <path d="M116 28 L202 100" stroke="${R}" stroke-width="2" fill="none"/>
    <text x="204" y="100" fill="${R}" font-size="7">D full info</text>
    <!-- Market eq (Q,P): S∩D_actual at (160,58) — red dashed -->
    <circle cx="160" cy="58" r="2.5" fill="${D}"/>
    <line x1="116" y1="58" x2="160" y2="58" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="160" y1="58" x2="160" y2="100" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="116" y="61" fill="${R}" font-size="6.5">P</text>
    <text x="157" y="108" fill="${R}" font-size="6.5">Q</text>
    <!-- Social opt (Q*,P*): S∩D_full at (156,62) — green dashed -->
    <circle cx="156" cy="62" r="2.5" fill="${R}"/>
    <line x1="116" y1="62" x2="156" y2="62" stroke="${S}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="156" y1="62" x2="156" y2="100" stroke="${S}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="116" y="65" fill="${S}" font-size="6.5">P*</text>
    <text x="152" y="108" fill="${S}" font-size="6.5">Q*</text>
    <text x="163" y="120" fill="${R}" font-size="6" text-anchor="middle">Overconsumption</text>
    <text x="163" y="129" fill="${LB}" font-size="6" text-anchor="middle">Q &gt; Q* — full info lowers D</text>

    <text x="110" y="155" fill="${LB}" font-size="6.5" text-anchor="middle">Merit: consumers undervalue → D too low → underconsume. Demerit: underestimate harm → D too high → overconsume.</text>
  </svg>`;
}



function infoFailureD(){
  // Overview diagram: two mini panels showing info failure concept.
  // Left: Merit (D_actual too low). Right: Demerit (D_actual too high).
  // Kept simple — full detail in meritGoodD and demeritGoodD cards.
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <text x="110" y="10" fill="${LB}" font-size="8.5" font-weight="bold" text-anchor="middle">INFORMATION FAILURE</text>
    <!-- Left panel: Merit Good -->
    <line x1="14" y1="105" x2="105" y2="105" stroke="${MU}" stroke-width="1.2"/>
    <line x1="14" y1="105" x2="14" y2="18" stroke="${MU}" stroke-width="1.2"/>
    <text x="106" y="108" fill="${LB}" font-size="6.5">Q</text><text x="12" y="16" fill="${LB}" font-size="6.5">P</text>
    <text x="59" y="14" fill="${MSB}" font-size="7.5" font-weight="bold" text-anchor="middle">MERIT GOOD</text>
    <!-- Supply -->
    <path d="M 14 102 L 100 26" stroke="${S}" stroke-width="1.5" fill="none"/>
    <text x="102" y="24" fill="${S}" font-size="6.5">S</text>
    <!-- D_actual (too low) -->
    <path d="M 14 26 L 100 96" stroke="${D}" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <text x="102" y="96" fill="${D}" font-size="6">D_actual</text>
    <!-- D_full info (higher) -->
    <path d="M 14 18 L 98 80" stroke="${MSB}" stroke-width="1.8" fill="none"/>
    <text x="100" y="79" fill="${MSB}" font-size="6">D_full</text>
    <!-- Market eq -->
    <circle cx="57" cy="64" r="2.5" fill="${D}"/>
    <line x1="57" y1="64" x2="57" y2="105" stroke="${D}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="53" y="113" fill="${D}" font-size="6">Qm</text>
    <!-- Social opt -->
    <circle cx="66" cy="56" r="2.5" fill="${MSB}"/>
    <line x1="66" y1="56" x2="66" y2="105" stroke="${MSB}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="63" y="113" fill="${MSB}" font-size="6">Q*</text>
    <text x="59" y="125" fill="${MSB}" font-size="6" text-anchor="middle">Qm &lt; Q* (under)</text>
    <!-- Right panel: Demerit Good -->
    <line x1="116" y1="105" x2="207" y2="105" stroke="${MU}" stroke-width="1.2"/>
    <line x1="116" y1="105" x2="116" y2="18" stroke="${MU}" stroke-width="1.2"/>
    <text x="208" y="108" fill="${LB}" font-size="6.5">Q</text><text x="114" y="16" fill="${LB}" font-size="6.5">P</text>
    <text x="161" y="14" fill="${R}" font-size="7.5" font-weight="bold" text-anchor="middle">DEMERIT GOOD</text>
    <!-- Supply -->
    <path d="M 116 102 L 202 26" stroke="${S}" stroke-width="1.5" fill="none"/>
    <text x="204" y="24" fill="${S}" font-size="6.5">S</text>
    <!-- D_actual (too high) -->
    <path d="M 116 26 L 202 96" stroke="${D}" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <text x="204" y="96" fill="${D}" font-size="6">D_actual</text>
    <!-- D_full info (lower) -->
    <path d="M 116 34 L 202 100" stroke="${R}" stroke-width="1.8" fill="none"/>
    <text x="204" y="100" fill="${R}" font-size="6">D_full</text>
    <!-- Market eq -->
    <circle cx="159" cy="64" r="2.5" fill="${D}"/>
    <line x1="159" y1="64" x2="159" y2="105" stroke="${D}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="155" y="113" fill="${D}" font-size="6">Qm</text>
    <!-- Social opt -->
    <circle cx="151" cy="68" r="2.5" fill="${R}"/>
    <line x1="151" y1="68" x2="151" y2="105" stroke="${R}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="147" y="113" fill="${R}" font-size="6">Q*</text>
    <text x="161" y="125" fill="${R}" font-size="6" text-anchor="middle">Qm &gt; Q* (over)</text>
    <text x="110" y="145" fill="${LB}" font-size="6.5" text-anchor="middle">Merit: underestimate benefit → underconsume. Demerit: underestimate harm → overconsume.</text>
    <text x="110" y="157" fill="${LB}" font-size="6" text-anchor="middle">Corrected by: information campaigns, labelling laws, advertising bans, education provision.</text>
  </svg>`;
}

function meritGoodD(){
  // MERIT GOOD — underconsumption due to information failure.
  // S=MSC: M28,145 L196,22. slope=-0.732. y=145-0.732*(x-28).
  // MPB₁ (imperfect info — consumers undervalue benefit): M28,22 L196,145. slope=+0.732.
  //   S∩MPB₁: 145-0.732*(x-28)=22+0.732*(x-28) → 123=1.464*(x-28) → x=112, y=84. → Qm=112, Pm=84.
  // MPB₂ (with information provision — consumers correctly value benefit): SAME slope, shifted UP 25px.
  //   MPB₂: y = (22-25) + 0.732*(x-28) = -3 + 0.732*(x-28). Clip at y=18: x=28+(18+3)/0.732=57.
  //   S∩MPB₂: 145-0.732*(x-28)=-3+0.732*(x-28) → 148=1.464*(x-28) → x=129, y=71. → Q*=129, P*=71.
  //   MPB₂: M57,18 L196,120. slope=(120-18)/(196-57)=102/139=0.734≈0.732 ✓ parallel.
  //   At x=112: MPB₁=84, MPB₂=58. Gap=26px — curves do not touch ✓.
  // DWL triangle: between MPB₁ and MPB₂ from Qm to Q*: (112,84)-(129,71)-(129,96).
  //   MPB₂ at Q*=129: y=22+0.732*(129-28)=95.9≈96 (point on MPB₂ that meets S).
  //   Actually DWL = (Qm,P on MPB₂ at Qm)-(Q*,P*)-(Qm,Pm). Let me use S: S at Q*=129: y=145-0.732*101=71 ✓.
  //   DWL triangle: (112,71)-(129,71)-(112,84). Simple right-angled triangle.
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Q','P')}
    <text x="110" y="9" fill="${MSB}" font-size="8" font-weight="bold" text-anchor="middle">MERIT GOOD — Underconsumption (Information Failure)</text>
    <!-- Supply = MSC -->
    <path d="M 28 145 L 196 22" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="198" y="20" fill="${S}" font-size="8" font-weight="bold">S=MSC</text>
    <!-- MPB₁: imperfect information — demand too low, curves NEVER touch MPB₂ -->
    <path d="M 28 22 L 196 145" stroke="${D}" stroke-width="2.5" fill="none" stroke-dasharray="6,3"/>
    <text x="198" y="145" fill="${D}" font-size="7.5" font-weight="bold">MPB₁</text>
    <text x="148" y="155" fill="${D}" font-size="6.5">(imperfect info)</text>
    <!-- MPB₂: with information provision — parallel, above MPB₁, same gradient -->
    <path d="M 57 18 L 196 120" stroke="${MSB}" stroke-width="2.5" fill="none"/>
    <text x="198" y="120" fill="${MSB}" font-size="7.5" font-weight="bold">MPB₂</text>
    <text x="152" y="130" fill="${MSB}" font-size="6.5">(info provision)</text>
    <!-- Market eq (S∩MPB₁): Qm=112, Pm=84 -->
    <circle cx="112" cy="84" r="3.5" fill="${D}"/>
    <line x1="28" y1="84" x2="112" y2="84" stroke="${D}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="112" y1="84" x2="112" y2="148" stroke="${D}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="87" fill="${D}" font-size="7">P_m</text>
    <text x="108" y="157" fill="${D}" font-size="7">Q_m</text>
    <!-- Social optimum (S∩MPB₂): Q*=129, P*=71 -->
    <circle cx="129" cy="71" r="3.5" fill="${MSB}"/>
    <line x1="28" y1="71" x2="129" y2="71" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="129" y1="71" x2="129" y2="148" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="69" fill="${MSB}" font-size="7">P*</text>
    <text x="125" y="157" fill="${MSB}" font-size="7">Q*</text>
    <!-- DWL triangle: apex at Q*=129 where S∩MPB₂ (social optimum), base at Qm=112 between MPB₁ and MPB₂ -->
    <polygon points="129,71 112,84 112,58" fill="rgba(239,68,68,0.4)"/>
    <text x="114" y="76" fill="${R}" font-size="6.5">DWL</text>
  </svg>`;
}

function demeritGoodD(){
  // DEMERIT GOOD — overconsumption due to information failure.
  // S=MSC: M28,145 L196,22. slope=-0.732. y=145-0.732*(x-28).
  // MPB₁ (imperfect info — consumers overestimate benefit / underestimate harm): M28,22 L196,145. slope=+0.732.
  //   S∩MPB₁: 145-0.732*(x-28)=22+0.732*(x-28) → 123=1.464*(x-28) → x=112, y=84. → Qm=112, Pm=84.
  // MPB₂ (with information provision — true valuation, LOWER): SAME slope, shifted DOWN 25px.
  //   MPB₂: y = (22+25) + 0.732*(x-28) = 47 + 0.732*(x-28). At y=148: x=28+(148-47)/0.732=28+138=166.
  //   MPB₂: M28,47 L166,148. slope=(148-47)/(166-28)=101/138=0.732 ✓ exactly parallel.
  //   S∩MPB₂: 145-0.732*(x-28)=47+0.732*(x-28) → 98=1.464*(x-28) → x=95, y=145-0.732*67=96. → Q*=95, P*=96.
  //   At x=112: MPB₁=84, MPB₂=47+0.732*84=108.5≈109. Gap=25px — clearly separate ✓.
  //   Q*=95 < Qm=112 ✓ (overconsumption corrected by info provision).
  // DWL triangle: (95,84)-(112,84)-(95,109) — simple right triangle between Qm and Q*.
  //   At Q*=95: MPB₂ y=47+0.732*67=96 (meets S at P*=96). MPB₁ y=22+0.732*67=71.
  //   Better DWL: between MPB₁ and MPB₂ from Q* to Qm: (95,71)-(112,84)-(112,109)-(95,96).
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Q','P')}
    <text x="110" y="9" fill="${R}" font-size="8" font-weight="bold" text-anchor="middle">DEMERIT GOOD — Overconsumption (Information Failure)</text>
    <!-- Supply = MSC -->
    <path d="M 28 145 L 196 22" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="198" y="20" fill="${S}" font-size="8" font-weight="bold">S=MSC</text>
    <!-- MPB₁: imperfect information — demand too HIGH (consumers underestimate harm) -->
    <path d="M 28 22 L 196 145" stroke="${D}" stroke-width="2.5" fill="none" stroke-dasharray="6,3"/>
    <text x="198" y="145" fill="${D}" font-size="7.5" font-weight="bold">MPB₁</text>
    <text x="148" y="155" fill="${D}" font-size="6.5">(imperfect info)</text>
    <!-- MPB₂: with information provision — parallel, BELOW MPB₁, same gradient -->
    <path d="M 28 47 L 166 148" stroke="${R}" stroke-width="2.5" fill="none"/>
    <text x="168" y="148" fill="${R}" font-size="7.5" font-weight="bold">MPB₂</text>
    <text x="123" y="157" fill="${R}" font-size="6.5">(info provision)</text>
    <!-- Market eq (S∩MPB₁): Qm=112, Pm=84 — overconsumption point -->
    <circle cx="112" cy="84" r="3.5" fill="${D}"/>
    <line x1="28" y1="84" x2="112" y2="84" stroke="${D}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="112" y1="84" x2="112" y2="148" stroke="${D}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="87" fill="${D}" font-size="7">P_m</text>
    <text x="108" y="157" fill="${D}" font-size="7">Q_m</text>
    <!-- Social optimum (S∩MPB₂): Q*=95, P*=96 -->
    <circle cx="95" cy="96" r="3.5" fill="${R}"/>
    <line x1="28" y1="96" x2="95" y2="96" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="95" y1="96" x2="95" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="99" fill="${R}" font-size="7">P*</text>
    <text x="91" y="157" fill="${R}" font-size="7">Q*</text>
    <!-- DWL triangle: apex at Q*=95 where S∩MPB₂ (social optimum), base at Qm=112 between MPB₁ and MPB₂ -->
    <polygon points="95,96 112,84 112,108" fill="rgba(239,68,68,0.4)"/>
    <text x="103" y="97" fill="${R}" font-size="6.5">DWL</text>
  </svg>`;
}

function labD(sh){
  let ex='',sb='';
  if(sh==='base'){ex=`<circle cx="112" cy="85" r="4" fill="white" opacity="0.9"/><line x1="28" y1="85" x2="112" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="112" y1="85" x2="112" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><text x="20" y="88" fill="${LB}" font-size="8">W*</text><text x="108" y="157" fill="${LB}" font-size="7">Q*</text>`;sb='DL=MRP. SL upward sloping. W* and Q* at intersection.';}
  else if(sh==='minWage'){const w=58;ex=`<line x1="28" y1="${w}" x2="210" y2="${w}" stroke="${R}" stroke-width="2"/><text x="20" y="${w+3}" fill="${R}" font-size="7">Wmin</text><circle cx="75" cy="${w}" r="3.5" fill="${D}"/><circle cx="150" cy="${w}" r="3.5" fill="${S}"/><line x1="75" y1="${w+8}" x2="150" y2="${w+8}" stroke="${R}" stroke-width="2"/><line x1="75" y1="${w+4}" x2="75" y2="${w+12}" stroke="${R}" stroke-width="1.5"/><line x1="150" y1="${w+4}" x2="150" y2="${w+12}" stroke="${R}" stroke-width="1.5"/><text x="112" y="${w+22}" fill="${R}" font-size="7.5" text-anchor="middle">Classical U = Qs − Qd</text><text x="68" y="${w-4}" fill="${D}" font-size="7">Qd</text><text x="146" y="${w-4}" fill="${S}" font-size="7">Qs</text>`;sb='Min wage above W* → labour surplus = classical unemployment.';}
  else if(sh==='dlRight'){
    // DL1: M30,25 L196,145. slope=(145-25)/(196-30)=120/166=0.7229. y=25+0.7229*(x-30).
    // DL2: SAME SLOPE, shifted right 30px. Start=(60,25). End: same Δy=120 over same Δx=166.
    //   End x=60+166=226 (clips at x=212): y=25+0.7229*(212-60)=25+109.9=134.9≈135.
    //   DL2: M60,25 L212,135. slope=(135-25)/(212-60)=110/152=0.7237≈0.7229 ✓ parallel.
    // New eq DL2∩SL: SL y=145-0.7229*(x-30). DL2 y=25+0.7229*(x-60).
    //   145-0.7229x+21.7=25+0.7229x-43.4 → 185.1=1.4458x → x=128.0, y=74.2≈74.
    ex=`<defs>${miArw('dl',R)}</defs>
    <path d="M60 25 L212 135" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="208" y="133" fill="${R}" font-size="8" font-weight="bold">DL₂</text>
    <!-- Original eq (DL1∩SL): W₁=85, Q₁=113 -->
    <circle cx="113" cy="85" r="3" fill="white" opacity="0.8"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="88" fill="${LB}" font-size="7.5">W₁</text>
    <text x="109" y="157" fill="${LB}" font-size="7">Q₁</text>
    <!-- New eq (DL2∩SL): W₂=74, Q₂=128 — higher wage AND more employment -->
    <circle cx="128" cy="74" r="3.5" fill="${R}"/>
    <line x1="28" y1="74" x2="128" y2="74" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="128" y1="74" x2="128" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="77" fill="${R}" font-size="7.5">W₂</text>
    <text x="124" y="157" fill="${R}" font-size="7">Q₂</text>
    <!-- Horizontal shift arrow showing DL moves right -->
    <line x1="74" y1="38" x2="100" y2="38" stroke="${R}" stroke-width="1.5" marker-end="url(#dl)"/>`;
    sb='↑MRP (or ↑product price) → DL shifts right → W* rises AND Q* rises. Both wages and employment increase.';
  }
  else if(sh==='union'){const w=48;ex=`<line x1="28" y1="${w}" x2="210" y2="${w}" stroke="${MSB}" stroke-width="2"/><text x="20" y="${w+3}" fill="${MSB}" font-size="7">Wu</text><circle cx="62" cy="${w}" r="3.5" fill="${D}"/><text x="58" y="${w-4}" fill="${D}" font-size="7">Qd</text><line x1="112" y1="85" x2="112" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/><line x1="62" y1="${w}" x2="62" y2="148" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/><text x="108" y="157" fill="${LB}" font-size="7">Q*</text><text x="58" y="157" fill="${MSB}" font-size="7">Qd</text><line x1="62" y1="140" x2="112" y2="140" stroke="${MSB}" stroke-width="2"/><text x="87" y="152" fill="${MSB}" font-size="7" text-anchor="middle">Jobs lost: Q*−Qd</text>`;sb='Union wage Wu &gt; W* → fewer hired. Q*−Qd = unemployment.';}
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','Wage')}<path d="M30 25 L196 145" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="143" fill="${D}" font-size="9" font-weight="bold">DL</text><path d="M30 145 L196 25" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="23" fill="${S}" font-size="9" font-weight="bold">SL</text>${ex}<text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">${sb}</text></svg>`;}

function monopD(){
  // MONOPSONY: single buyer of labour. MCL rises at TWICE the slope of ACL=SL.
  // ACL=SL: M30,145 L196,25. slope_SVG=-120/166=-0.7229. y=145-0.7229*(x-30).
  // MCL: same intercept as ACL at Q=0 (x=30,y=145), slope_SVG=-2*0.7229=-1.4458.
  //   y=145-1.4458*(x-30). At y=16: x=30+(145-16)/1.4458=30+89.2=119. MCL: M30,145 L119,16.
  // DL=MRP: M30,25 L196,145. slope_SVG=+0.7229. y=25+0.7229*(x-30).
  // Monopsony Q2: MCL∩DL: 145-1.4458*(x-30)=25+0.7229*(x-30) → 120=2.1687*(x-30) → x=85, y_DL=65.
  // Monopsony W2: read from ACL at Q2=85: y=145-0.7229*55=105.
  // Competitive Q1: ACL∩DL: x=113, y=85. W1=85.
  // Wage gap: W1 y=85 (higher on screen=higher wage) vs W2 y=105 (lower) → W1>W2 ✓. Q2=85<Q1=113 ✓.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','Wage')}
    <!-- D=MRP: downward sloping demand for labour -->
    <path d="M30 25 L196 145" stroke="${D}" stroke-width="2" fill="none"/>
    <text x="198" y="143" fill="${D}" font-size="8">D=MRP</text>
    <!-- ACL=SL: upward sloping supply / average cost of labour -->
    <path d="M30 145 L196 25" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="198" y="23" fill="${S}" font-size="8">ACL=SL</text>
    <!-- MCL: TWICE the slope of ACL — rises much more steeply -->
    <path d="M30 145 L119 16" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="121" y="14" fill="${R}" font-size="8" font-weight="bold">MCL</text>
    <!-- Monopsony employment Q2: MCL∩DL at (85,65) — drop vertically to ACL for W2 -->
    <line x1="85" y1="65" x2="85" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="81" y="157" fill="${R}" font-size="7">Q2</text>
    <!-- Monopsony wage W2: read from ACL at Q2=85, y=105 -->
    <circle cx="85" cy="105" r="3.5" fill="${R}"/>
    <line x1="28" y1="105" x2="85" y2="105" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="108" fill="${R}" font-size="7.5">W2</text>
    <!-- MCL∩DL intersection point (where employment is decided) -->
    <circle cx="85" cy="65" r="3" fill="${R}" opacity="0.7"/>
    <!-- Competitive equilibrium Q1,W1: ACL∩DL at (113,85) -->
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="2,2" opacity="0.6"/>
    <text x="109" y="157" fill="${MU}" font-size="7" opacity="0.8">Q1</text>
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5" opacity="0.8"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="2,2" opacity="0.6"/>
    <text x="18" y="88" fill="${MU}" font-size="7.5" opacity="0.9">W1</text>
    <!-- Exploitation rectangle: wage gap W1-W2 at Q2 -->
    <rect x="28" y="85" width="57" height="20" fill="rgba(239,68,68,0.15)"/>
  </svg>`;
}

function srD(){
  // Coordinates mapped exactly from Total_Cost_Curves.svg.
  // TC cubic:  M29,125 C39,106 48,87 69,76 C89,64 130,64 152,53 C174,43 187,29 200,14
  // TVC cubic: M29,149 C38,130 48,111 68,99 C89,87 129,87 151,77 C173,66 187,52 200,37
  // TFC horizontal: y=126, x=27→211 (red)
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','Costs')}
    <!-- TFC: flat horizontal red line -->
    <line x1="27" y1="126" x2="211" y2="126" stroke="${R}" stroke-width="2.5"/>
    <text x="212" y="130" fill="${R}" font-size="8" font-weight="bold">TFC</text>
    <!-- TVC: S-curve starting near origin -->
    <path d="M29 149 C38 130 48 111 68 99 C89 87 129 87 151 77 C173 66 187 52 200 37" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="201" y="35" fill="${LC}" font-size="8" font-weight="bold">TVC</text>
    <!-- TC: same shape shifted up by TFC gap -->
    <path d="M29 125 C39 106 48 87 69 76 C89 64 130 64 152 53 C174 43 187 29 200 14" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="201" y="12" fill="${MU}" font-size="8" font-weight="bold">TC</text>
  </svg>`;
}


function mcD(){
  // Coordinates mapped exactly from MC_and_ATC_relationship.svg.
  // MC cubic: M32.8,99.6 C44.7,122.6 56.6,145.7 77.4,133.9 C98.1,122.2 127.8,75.6 157.4,29.1
  // ATC cubic: M47.4,27.3 C69.2,60.3 90.9,93.3 115.2,93.4 C139.4,93.5 166.0,60.6 192.6,27.7
  // MC crosses ATC at ATC minimum ≈ (115,93).
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','Cost')}
    <!-- ATC: wide U-shape -->
    <path d="M47.4 27.3 C69.2 60.3 90.9 93.3 115.2 93.4 C139.4 93.5 166.0 60.6 192.6 27.7" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="178" y="52" fill="${LC}" font-size="8" font-weight="bold">ATC</text>
    <!-- MC: narrower U, crosses ATC at its minimum -->
    <path d="M32.8 99.6 C44.7 122.6 56.6 145.7 77.4 133.9 C98.1 122.2 127.8 75.6 157.4 29.1" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="159" y="39" fill="${MU}" font-size="8" font-weight="bold">MC</text>
    <!-- Crossing point: MC = ATC = minimum ATC -->
    <circle cx="115" cy="93.4" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="115" y1="93.4" x2="115" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="111" y="157" fill="${LB}" font-size="7">Q*</text>
    <!-- Annotations -->
    <text x="38" y="82" fill="${MU}" font-size="7">MC &lt; ATC</text>
    <text x="38" y="91" fill="${MU}" font-size="6.5">→ ATC falling</text>
    <text x="130" y="82" fill="${MU}" font-size="7">MC &gt; ATC</text>
    <text x="130" y="91" fill="${MU}" font-size="6.5">→ ATC rising</text>
  </svg>`;
}

function dimD(){
  // Single panel: MP and AP on one diagram showing diminishing returns
  // Reuse original SVG-mapped coordinates from top panel only
  // MP: M42.6 92.8 C49.2 62.0 55.8 31.3 81.5 34.3 C107.2 37.3 152.2 74.0 197.1 110.7
  // AP: M50.8 104.0 C75.7 81.3 100.6 58.5 127.3 55.7 C154.0 52.9 182.6 69.9 211.1 87.0
  // Q dashed at x=77.2 (MP max, where MC is minimum)
  // AP max at ~x=127 (where AP=MP)
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Labour','Output / Product')}
    <!-- MP: rises then falls sharply — diminishing returns -->
    <path d="M42.6 92.8 C49.2 62.0 55.8 31.3 81.5 34.3 C107.2 37.3 152.2 74.0 197.1 110.7"
          stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="199" y="109" fill="${S}" font-size="8" font-weight="bold">MP</text>
    <!-- AP: flatter inverted-U, peaks after MP -->
    <path d="M50.8 104.0 C75.7 81.3 100.6 58.5 127.3 55.7 C154.0 52.9 182.6 69.9 211.1 87.0"
          stroke="${D}" stroke-width="2" fill="none"/>
    <text x="199" y="86" fill="${D}" font-size="8" font-weight="bold">AP</text>
    <!-- Q dashed: MP max (diminishing returns begin) -->
    <line x1="77.2" y1="34.3" x2="77.2" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="63" y="158" fill="${MU}" font-size="6.5">DR begin</text>
    <!-- AP=MP point (AP max) at ~x=127 -->
    <line x1="127" y1="55.7" x2="127" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <circle cx="127" cy="55.7" r="3" fill="${D}"/>
    <text x="129" y="53" fill="${D}" font-size="6.5">AP max</text>
  </svg>`;
}


function srCostsD(){
  // Coordinates mapped exactly from Short_Run_Cost_Curves.svg.
  // ATC cubic: M33.5,20.2 C58.9,53.2 84.3,86.2 112.5,86.2 C140.8,86.3 171.9,53.4 202.9,20.6
  // AVC cubic: M34.0,55.8 C38.6,83.6 43.1,111.3 70.9,126.3 C98.7,141.2 149.9,143.3 201.0,145.4
  // MC cubic:  M30.8,87.3 C49.8,105.8 68.8,124.3 97.4,115.9 C125.9,107.4 163.8,71.9 201.9,36.4
  // AFC hyperbola: M29.8,113.6 C30.8,130.9 31.8,148.0 54.6,134.2 C77.3,120.5 121.8,75.6 166.3,30.7
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','Costs')}
    <!-- AVC: U-shaped (falls then rises) — sits below ATC by AFC gap -->
    <path d="M29.8 113.6 C30.8 130.9 31.8 148.0 54.6 134.2 C77.3 120.5 121.8 75.6 166.3 30.7" stroke="${D}" stroke-width="2.5" fill="none"/>
    <text x="168" y="29" fill="${D}" font-size="7.5" font-weight="bold">AVC</text>
    <!-- AFC: rectangular hyperbola, always falling -->
    <path d="M34.0 55.8 C38.6 83.6 43.1 111.3 70.9 126.3 C98.7 141.2 149.9 143.3 201.0 145.4" stroke="${R}" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="202" y="143" fill="${R}" font-size="7.5" font-weight="bold">AFC</text>
    <!-- ATC: U-shaped, wider, sits above AVC -->
    <path d="M33.5 20.2 C58.9 53.2 84.3 86.2 112.5 86.2 C140.8 86.3 171.9 53.4 202.9 20.6" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="197" y="39" fill="${LC}" font-size="7.5" font-weight="bold">ATC</text>
    <!-- MC: narrower U, cuts AVC and ATC at their minimums -->
    <path d="M30.8 87.3 C49.8 105.8 68.8 124.3 97.4 115.9 C125.9 107.4 163.8 71.9 201.9 36.4" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="195" y="37" fill="${S}" font-size="7.5" font-weight="bold">MC</text>
  </svg>`;
}

function elasticLabD(){
  // Coordinates mapped exactly from Elastic_Labour_Demand_and_Supply.svg.
  // Elastic: both DL and SL are nearly flat (horizontal).
  // SL: M184.2,66.3 L53.7,110.5  (shallow upward slope left to right)
  // DL: M43.9,70.0 L196.1,113.2  (shallow downward slope left to right)
  // Equilibrium at intersection ≈ x=120, y=90
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','WR')}

    <!-- SL: shallow upward slope (elastic supply) -->
    <line x1="53.7" y1="110.5" x2="184.2" y2="66.3" stroke="${S}" stroke-width="2.5"/>
    <text x="186" y="67" fill="${S}" font-size="8" font-weight="bold">SL</text>
    <!-- DL: shallow downward slope (elastic demand) -->
    <line x1="43.9" y1="70.0" x2="196.1" y2="113.2" stroke="${D}" stroke-width="2.5"/>
    <text x="198" y="120" fill="${D}" font-size="8" font-weight="bold">DL</text>
    <!-- Equilibrium -->
    <circle cx="120" cy="90" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="90" x2="120" y2="90" stroke="${MU}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <line x1="120" y1="90" x2="120" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <text x="17" y="93" fill="${MU}" font-size="7.5" font-weight="bold">W*</text>
    <text x="116" y="158" fill="${MU}" font-size="7.5" font-weight="bold">Q*</text>
  </svg>`;
}

function inelasticLabD(){
  // Coordinates mapped exactly from Inelastic_Labour_Demand_and_Supply.svg.
  // Inelastic: both DL and SL are steep (nearly vertical).
  // DL: M70.7,22.7 L148.7,139.0  (steep downward)
  // SL: M148.7,22.0 L72.8,137.4  (steep upward)
  // Equilibrium ≈ x=110, y=80
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','WR')}

    <!-- SL: steep upward slope (inelastic supply) -->
    <line x1="72.8" y1="137.4" x2="148.7" y2="22.0" stroke="${S}" stroke-width="2.5"/>
    <text x="150" y="26" fill="${S}" font-size="8" font-weight="bold">SL</text>
    <!-- DL: steep downward slope (inelastic demand) -->
    <line x1="70.7" y1="22.7" x2="148.7" y2="139.0" stroke="${D}" stroke-width="2.5"/>
    <text x="150" y="139" fill="${D}" font-size="8" font-weight="bold">DL</text>
    <!-- Equilibrium -->
    <circle cx="110" cy="80" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="80" x2="110" y2="80" stroke="${MU}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <line x1="110" y1="80" x2="110" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <text x="17" y="83" fill="${MU}" font-size="7.5" font-weight="bold">W*</text>
    <text x="106" y="158" fill="${MU}" font-size="7.5" font-weight="bold">Q*</text>
  </svg>`;
}

function lracD(sh){
  // Coordinates mapped exactly from Economies_and_Diseconomies_of_Scale.svg for eos/base shifts.
  // External_Economies_of_Scale.svg for external shift.
  // LRAC path (EoS SVG, different X range — 2376px wide):
  //   Falling: M35.7,25.7 C40.0,39.0 44.3,52.6 54.7,65.4 C65.2,78.2 81.7,90.5 98.2,102.9
  //   Flat:    M98.5,102.8 L139.0,102.8
  //   Rising:  M138.8,102.9 C155.1,91.4 171.3,80.0 181.4,67.3 C191.5,54.5 195.3,40.3 199.1,26.3
  const lracFall = `M35.7 25.7 C40.0 39.0 44.3 52.6 54.7 65.4 C65.2 78.2 81.7 90.5 98.2 102.9`;
  const lracFlat = `M98.5 102.8 L139.0 102.8`;
  const lracRise = `M138.8 102.9 C155.1 91.4 171.3 80.0 181.4 67.3 C191.5 54.5 195.3 40.3 199.1 26.3`;
  let ex='', nt='';
  if(sh==='base'){
    nt='LRAC falls (EoS) to minimum at MES (Q1) then rises (DisEoS)';
    ex=`
    <line x1="98.5" y1="102.8" x2="98.5" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="88" y="158" fill="${MU}" font-size="6.5">Q1 (MES)</text>
    <circle cx="98.5" cy="102.8" r="3" fill="${MU}"/>`;
  } else if(sh==='eos'){
    // Coordinates mapped exactly from Economies_and_Diseconomies_of_Scale.svg.
    // Different X range — axes: origin(1041,1864), X to 3417=2376px, Y to 340=1524px.
    // LRAC falling: M35.7,25.7 C40.0,39.0 44.3,52.6 54.7,65.4 C65.2,78.2 81.7,90.5 98.2,102.9
    // LRAC flat:    M98.5,102.8 L139.0,102.8
    // LRAC rising:  M138.8,102.9 C155.1,91.4 171.3,80.0 181.4,67.3 C191.5,54.5 195.3,40.3 199.1,26.3
    // Q1/MES: x=98.5, Q2: x=138.9 (blue dashed verticals, from SVG #4472C4)
    nt='EoS → Constant Returns to Scale (MES) → DisEoS';
    ex=`<defs>${miArw('ea',LC)}</defs>
    <!-- Q1/MES vertical dashed (blue in SVG → LC theme) -->
    <line x1="98.5" y1="102.8" x2="98.5" y2="148" stroke="${LC}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="92" y="157" fill="${LC}" font-size="6.5">Q1</text>
    <text x="90" y="165" fill="${LC}" font-size="6.5">MES</text>
    <!-- Q2 vertical dashed -->
    <line x1="138.9" y1="102.8" x2="138.9" y2="148" stroke="${LC}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="135" y="157" fill="${LC}" font-size="6.5">Q2</text>
    <!-- Constant Returns label between Q1 and Q2 (with arrows) -->
    <text x="119" y="88" fill="${MU}" font-size="6.5" text-anchor="middle">Constant</text>
    <text x="119" y="96" fill="${MU}" font-size="6.5" text-anchor="middle">Returns to Scale</text>
    <line x1="109" y1="99" x2="100" y2="99" stroke="${MU}" stroke-width="1" marker-end="url(#ea)"/>
    <line x1="129" y1="99" x2="138" y2="99" stroke="${MU}" stroke-width="1" marker-end="url(#ea)"/>
    <!-- Economies of Scale label left -->
    <text x="50" y="125" fill="${LC}" font-size="6.5" text-anchor="middle">Economies of</text>
    <text x="50" y="133" fill="${LC}" font-size="6.5" text-anchor="middle">Scale</text>
    <!-- Diseconomies label right -->
    <text x="172" y="125" fill="${R}" font-size="6.5" text-anchor="middle">Diseconomies</text>
    <text x="172" y="133" fill="${R}" font-size="6.5" text-anchor="middle">of Scale</text>`;
  } else {
    // Coordinates mapped exactly from External_Economies_of_Scale.svg.
    // Standard axes: origin(1041,1864), X:1041→3028=1987px, Y:1864→340=1524px.
    // ATC  (original, higher U): M33.5,36.7 C58.9,69.7 84.3,102.7 112.5,102.8 C140.8,102.9 171.9,70.0 202.9,37.0
    // ATC1 (lower U, after external EoS): M32.7,66.1 C58.2,99.1 83.6,132.1 111.8,132.2 C140.0,132.3 171.2,99.4 202.2,66.5
    // Both curves are #000000 in SVG → use theme colours. ATC=MU (original), ATC1=LC (lower).
    nt='External EoS: industry growth shifts whole LRAC down. All firms benefit.';
    ex=`<defs>${miArw('arwUp','${LC}')}</defs>
    <!-- ATC1: lower U-shaped curve (external EoS shifts entire curve down) -->
    <path d="M32.7 66.1 C58.2 99.1 83.6 132.1 111.8 132.2 C140.0 132.3 171.2 99.4 202.2 66.5" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="194.4" y="84.3" fill="${LC}" font-size="8" font-weight="bold">ATC1</text>
    <!-- Downward arrow at trough showing shift -->
    <line x1="112" y1="106" x2="112" y2="128" stroke="${LC}" stroke-width="1.5" marker-end="url(#arwUp)"/>
    <text x="116" y="118" fill="${LC}" font-size="6.5">External</text>
    <text x="116" y="126" fill="${LC}" font-size="6.5">EoS</text>`;
  }
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','Costs')}
    <!-- LRAC: falling section -->
    <path d="${lracFall}" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <!-- LRAC: flat MES section -->
    <path d="${lracFlat}" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <!-- LRAC: rising section -->
    <path d="${lracRise}" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="178.2" y="31.6" fill="${MU}" font-size="8" font-weight="bold">LRAC</text>
    ${ex}
  </svg>`;
}




function pcSRD(){
  // Coordinates mapped exactly from Perfect_competition_short_run_supernormal_profits.svg.
  // MC cubic: M33.4,99.6 C46.7,122.6 59.9,145.7 83.2,133.9 C106.3,122.2 139.5,75.6 172.6,29.1
  // AC cubic: M49.6,27.3 C74.0,60.3 98.4,93.3 125.4,93.4 C152.5,93.5 182.3,60.6 212.0,27.7
  // MR=AR horizontal: y=78.4, x=28→207.
  // SNP rect: x=28.5,y=78.4,w=108.8,h=13.6 (P to C at Q).
  // Q vert dashed: x=137.3, y=78.4→148. C dashed: y=91.9, x=28→137.
  // Points: A(133,75.9)=MC=MR, B(140.1,97.8)=AC min.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','C & R')}
    <!-- SNP rectangle: P to C at Q -->
    <rect x="28.5" y="78.4" width="108.8" height="13.5" fill="rgba(68,114,196,0.40)"/>
    <!-- MR=AR horizontal -->
    <line x1="28" y1="78.4" x2="207" y2="78.4" stroke="${MU}" stroke-width="2.5"/>
    <text x="175" y="88" fill="${MU}" font-size="7" font-weight="bold">MR = AR</text>
    <!-- C dashed horizontal at AC level -->
    <line x1="28" y1="91.9" x2="137.3" y2="91.9" stroke="#4472C4" stroke-width="1.5" stroke-dasharray="4,3"/>
    <!-- Q vertical dashed -->
    <line x1="137.3" y1="78.4" x2="137.3" y2="148" stroke="#4472C4" stroke-width="1.5" stroke-dasharray="4,3"/>
    <!-- MC cubic -->
    <path d="M33.4 99.6 C46.7 122.6 59.9 145.7 83.2 133.9 C106.3 122.2 139.5 75.6 172.6 29.1" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="174" y="35" fill="${MU}" font-size="8" font-weight="bold">MC</text>
    <!-- AC cubic -->
    <path d="M49.6 27.3 C74.0 60.3 98.4 93.3 125.4 93.4 C152.5 93.5 182.3 60.6 212.0 27.7" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="197" y="52" fill="${MU}" font-size="8" font-weight="bold">AC</text>
    <!-- Labels -->
    <text x="20" y="81" fill="${MU}" font-size="8" font-weight="bold">P</text>
    <text x="20" y="95" fill="${MU}" font-size="8" font-weight="bold">C</text>
    <text x="133" y="158" fill="${MU}" font-size="8" font-weight="bold">Q</text>
    <!-- Point A: MC=MR -->
    <circle cx="133" cy="78.4" r="3.5" fill="${MU}"/>
    <text x="136" y="75" fill="${MU}" font-size="8" font-weight="bold">A</text>
    <!-- Point B: AC min -->
    <circle cx="125.4" cy="93.4" r="3.5" fill="${MU}"/>
    <text x="128" y="103" fill="${MU}" font-size="8" font-weight="bold">B</text>
  </svg>`;
}

function pcLRD(){
  // Coordinates mapped exactly from Perfect_competition_normal_profit.svg.
  // Same MC and AC cubic paths as SR diagram.
  // MR=AR horizontal: y=93.5, x=28→204.
  // Q vertical: x=125.5, y=93.5→148.
  // At LR equilibrium MR=AR touches AC minimum → P=C=AC min at Q.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','C & R')}
    <!-- MR=AR horizontal — touches AC at its minimum -->
    <line x1="28" y1="93.5" x2="204" y2="93.5" stroke="${MU}" stroke-width="2.5"/>
    <text x="175" y="88" fill="${MU}" font-size="7" font-weight="bold">MR = AR</text>
    <!-- Q vertical -->
    <line x1="125.5" y1="93.5" x2="125.5" y2="148" stroke="#4472C4" stroke-width="1.5"/>
    <!-- MC cubic (same as SR) -->
    <path d="M33.4 99.6 C46.7 122.6 59.9 145.7 83.2 133.9 C106.3 122.2 139.5 75.6 172.6 29.1" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="174" y="35" fill="${MU}" font-size="8" font-weight="bold">MC</text>
    <!-- AC cubic (same as SR) -->
    <path d="M49.6 27.3 C74.0 60.3 98.4 93.3 125.4 93.4 C152.5 93.5 182.3 60.6 212.0 27.7" stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="197" y="52" fill="${MU}" font-size="8" font-weight="bold">AC</text>
    <!-- Single point where MR=AR touches AC min -->
    <circle cx="125.4" cy="93.4" r="3.5" fill="${MU}"/>
    <!-- Labels -->
    <text x="12" y="97" fill="${MU}" font-size="7.5" font-weight="bold">P=C</text>
    <text x="121" y="158" fill="${MU}" font-size="8" font-weight="bold">Q</text>
  </svg>`;
}


function monoD(){
  // PROFIT-MAXIMISING MONOPOLY — coordinates mapped exactly from Profit_Maximising_Monopoly.svg.
  // All 4 monopoly diagrams share identical AR, MR, AC, MC paths (same base axes ox=1041,oy=1864).
  // AR:  M33.1,20.8 L206.3,134.2
  // MR:  M33.7,24.6 L131.7,148.0  (clips at x-axis)
  // AC:  M35.1,44.3 C58.7,76.9 82.3,109.5 110.5,109.8 C138.8,110.1 171.7,78.2 204.6,46.2
  // MC:  M34.1,112.3 C46.8,132.7 59.5,153.0 82.4,138.6 C105.2,124.3 138.3,75.1 171.3,26.0
  // Q1 vert: x=106.4, P1 horiz: y=70.3, C1 horiz: y=109.1
  // SNP rect: x=28,y=70.3,w=78.4,h=38.8
  // pt a (on AR at Q1): (106.4,68.5), pt b (on AC at Q1): (95.0,117.8)
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','C/R')}
    <!-- SNP rectangle: P1 down to C1 at Q1 -->
    <rect x="28" y="70.3" width="78.4" height="38.8" fill="rgba(34,197,94,0.20)"/>
    <!-- AR: downward sloping demand -->
    <line x1="33.1" y1="20.8" x2="206.3" y2="134.2" stroke="${D}" stroke-width="2.5"/>
    <text x="200" y="144" fill="${D}" font-size="8" font-weight="bold">AR</text>
    <!-- MR: steeper, clips at x-axis -->
    <line x1="33.7" y1="24.6" x2="131.7" y2="148.0" stroke="${MO}" stroke-width="2.5"/>
    <text x="131" y="162" fill="${MO}" font-size="8" font-weight="bold">MR</text>
    <!-- AC: U-shaped -->
    <path d="M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="198" y="56" fill="${LC}" font-size="8" font-weight="bold">AC</text>
    <!-- MC: U-shaped, crosses AC at min, passes through MC=MR -->
    <path d="M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.6 C105.2 124.3 138.3 75.1 171.3 26.0" stroke="${S}" stroke-width="2.5" fill="none" clip-path="url(#mc)"/>
    <defs><clipPath id="mc"><rect x="0" y="0" width="220" height="168"/></clipPath></defs>
    <text x="165" y="38" fill="${S}" font-size="8" font-weight="bold">MC</text>
    <!-- Q1 vertical dashed -->
    <line x1="106.4" y1="68.5" x2="106.4" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="102" y="158" fill="${MU}" font-size="7.5" font-weight="bold">Q1</text>
    <!-- P1 horizontal dashed -->
    <line x1="28" y1="70.3" x2="106.4" y2="70.3" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="17" y="73" fill="${MU}" font-size="7.5" font-weight="bold">P1</text>
    <!-- C1 horizontal dashed -->
    <line x1="28" y1="109.1" x2="106.4" y2="109.1" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="17" y="112" fill="${MU}" font-size="7.5" font-weight="bold">C1</text>
    <!-- Points a and b -->
    <circle cx="106.4" cy="68.5" r="3" fill="${D}"/>
    <text x="109" y="66" fill="${MU}" font-size="7" font-weight="bold">a</text>
    <circle cx="106.4" cy="109.5" r="3" fill="${LC}"/>
    <text x="109" y="113" fill="${MU}" font-size="7" font-weight="bold">b</text>
    <text x="54" y="93" fill="rgba(21,128,61,0.9)" font-size="7.5" text-anchor="middle">SNP</text>
  </svg>`;
}

function prodEffMonoD(){
  // MONOPOLY AT PRODUCTIVE EFFICIENCY — exact from Monopoly_Operating_at_Productively_Effeicient_Output.svg.
  // Same AR/MR/AC/MC paths as monoD.
  // Q1 vert: x=112.5. P1 horiz: y=74.4. C1 horiz: y=109.1 (from x=30→106.4).
  // Circle (blue filled) at AC=MC intersection ≈ (111.5,109.2) — productive efficiency point.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P / C / R')}
    <!-- AR -->
    <line x1="33.1" y1="20.8" x2="206.3" y2="134.2" stroke="${D}" stroke-width="2.5"/>
    <text x="200" y="144" fill="${D}" font-size="8" font-weight="bold">AR</text>
    <!-- MR -->
    <line x1="33.7" y1="24.6" x2="131.7" y2="148.0" stroke="${MO}" stroke-width="2.5"/>
    <text x="131" y="162" fill="${MO}" font-size="8" font-weight="bold">MR</text>
    <!-- AC -->
    <path d="M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="198" y="56" fill="${LC}" font-size="8" font-weight="bold">AC</text>
    <!-- MC -->
    <path d="M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.6 C105.2 124.3 138.3 75.1 171.3 26.0" stroke="${S}" stroke-width="2.5" fill="none" clip-path="url(#mcp)"/>
    <defs><clipPath id="mcp"><rect x="0" y="0" width="220" height="168"/></clipPath></defs>
    <text x="165" y="38" fill="${S}" font-size="8" font-weight="bold">MC</text>
    <!-- Q1 vertical dashed -->
    <line x1="112.5" y1="72.9" x2="112.5" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="108" y="158" fill="${MU}" font-size="7.5" font-weight="bold">Q1</text>
    <!-- P1 horizontal dashed (from AR at Q1) -->
    <line x1="28" y1="74.4" x2="112.5" y2="74.4" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="17" y="77" fill="${MU}" font-size="7.5" font-weight="bold">P1</text>
    <!-- C1 horizontal dashed (from AC at Q1) -->
    <line x1="30" y1="109.1" x2="106.4" y2="109.1" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="17" y="112" fill="${MU}" font-size="7.5" font-weight="bold">C1</text>
    <!-- Productive efficiency point: AC=MC (blue filled circle, from SVG) -->
    <circle cx="111.5" cy="109.2" r="5" fill="#4472C4" stroke="#2F528F" stroke-width="1.5"/>
    <text x="117" y="121" fill="#4472C4" font-size="7.5" font-weight="bold">C</text>
  </svg>`;
}

function revMaxMonoD(){
  // SUPERNORMAL PROFIT AT REVENUE-MAXIMISING OUTPUT — exact from Supernormal_Profit_at_Revenue_Maximising_Output.svg.
  // Same AR/MR/AC/MC paths as monoD.
  // Revenue max: where MR=0 (MR hits x-axis). From MR line: M33.7,24.6 L131.7,148.
  //   x-intercept at y=148 → x=131.7. So rev-max Q is at x≈131.7.
  // Rev max Q vert: x=132.5, y=84.9→147.
  // SNP rect: x=28.4,y=86.9, w=104.1, h=17.6 (from y=86.9 to y=104.5)
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','C & R')}
    <!-- SNP rectangle at revenue-maximising output (grey fill from SVG) -->
    <rect x="28.4" y="86.9" width="104.1" height="17.6" fill="rgba(127,127,127,0.50)"/>
    <!-- AR -->
    <line x1="33.1" y1="20.8" x2="206.3" y2="134.2" stroke="${D}" stroke-width="2.5"/>
    <text x="200" y="144" fill="${D}" font-size="8" font-weight="bold">AR</text>
    <!-- MR: hits x-axis at rev-max Q -->
    <line x1="33.7" y1="24.6" x2="131.7" y2="148.0" stroke="${MO}" stroke-width="2.5"/>
    <text x="131" y="162" fill="${MO}" font-size="8" font-weight="bold">MR</text>
    <!-- AC -->
    <path d="M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="198" y="56" fill="${LC}" font-size="8" font-weight="bold">AC</text>
    <!-- MC -->
    <path d="M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.6 C105.2 124.3 138.3 75.1 171.3 26.0" stroke="${S}" stroke-width="2.5" fill="none" clip-path="url(#mcrm)"/>
    <defs><clipPath id="mcrm"><rect x="0" y="0" width="220" height="168"/></clipPath></defs>
    <text x="165" y="38" fill="${S}" font-size="8" font-weight="bold">MC</text>
    <!-- Rev-max Q vertical dashed (where MR=0) -->
    <line x1="132.5" y1="84.9" x2="132.5" y2="147" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <!-- Dot: AR at revenue-max Q -->
    <circle cx="132.5" cy="85.9" r="3.5" fill="white" stroke="${D}" stroke-width="1.5"/>
    <text x="117" y="157" fill="${MU}" font-size="7" font-weight="bold">Rev max</text>
    <text x="117" y="165" fill="${MU}" font-size="7" font-weight="bold">quantity</text>
    <!-- SNP label inside rect -->
    <text x="80" y="99" fill="${MU}" font-size="7.5" text-anchor="middle">Rev max profit</text>
  </svg>`;
}


function kdD(){
  // Kinked demand: coordinates mapped exactly from Kinked_Demand.svg.
  // Kink point: (121.1, 62.6). P horizontal dashed: y=62, x=28→121. Q vertical dashed: x=121, y=62→148.
  // AR upper: M33.1,20.3 L121.1,62.6 (steep). AR lower: M121.1,62.6 L171.0,136.1 (shallower).
  // MR upper: M34.1,23.1 L121.0,91.3 (point a). MR gap: 91.3→148 at x=121 (dashed).
  // MR lower: M120,148 L138.4,168 (below x-axis, clipped).
  // MC cubic: M34.1,119.5 C46.8,135.5 59.5,151.4 82.4,140.1 C105.2,128.9 138.3,90.2 171.3,51.7
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','C & R')}
    <!-- AR upper: steep from top-left to kink -->
    <line x1="33.1" y1="20.3" x2="121.1" y2="62.6" stroke="${D}" stroke-width="2.5"/>
    <!-- AR lower: shallower from kink to bottom-right -->
    <line x1="121.1" y1="62.6" x2="171.0" y2="136.1" stroke="${D}" stroke-width="2.5"/>
    <text x="173" y="142" fill="${D}" font-size="8" font-weight="bold">AR</text>
    <!-- MR upper: from same intercept as AR, to point a -->
    <line x1="34.1" y1="23.1" x2="121.0" y2="91.3" stroke="${MO}" stroke-width="2.5"/>
    <!-- MR gap: dashed from a to b -->
    <line x1="121.0" y1="91.3" x2="121.0" y2="148" stroke="${MO}" stroke-width="2" stroke-dasharray="4,3"/>
    <text x="124" y="90" fill="${MO}" font-size="8" font-weight="bold">a</text>
    <text x="124" y="146" fill="${MO}" font-size="8" font-weight="bold">b</text>
    <!-- MR lower: below x-axis (clipped) -->
    <line x1="120" y1="148" x2="138.4" y2="168" stroke="${MO}" stroke-width="2.5"/>
    <text x="137" y="165" fill="${MO}" font-size="8" font-weight="bold">MR</text>
    <!-- MC: cubic through the MR gap -->
    <path d="M34.1 119.5 C46.8 135.5 59.5 151.4 82.4 140.1 C105.2 128.9 138.3 90.2 171.3 51.7" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="172" y="50" fill="${S}" font-size="8" font-weight="bold">MC</text>
    <!-- P horizontal dashed -->
    <line x1="28" y1="62" x2="121.1" y2="62" stroke="${MU}" stroke-width="1.5" stroke-dasharray="5,4"/>
    <text x="19" y="65" fill="${MU}" font-size="8" font-weight="bold">P</text>
    <!-- Q vertical dashed -->
    <line x1="121.1" y1="62.6" x2="121.1" y2="148" stroke="${MU}" stroke-width="1.5" stroke-dasharray="5,4"/>
    <text x="117" y="158" fill="${MU}" font-size="8" font-weight="bold">Q</text>
    <!-- Kink point dot -->
    <circle cx="121.1" cy="62.6" r="3.5" fill="white" stroke="${D}" stroke-width="1.5"/>
  </svg>`;
}

function nmD(){return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P/Cost')}<path d="M32 28 Q80 52 140 88 Q176 108 206 120" stroke="${LC}" stroke-width="2.5" fill="none"/><text x="208" y="118" fill="${LC}" font-size="9" font-weight="bold">LRAC</text><path d="M32 55 Q90 80 160 112 L206 130" stroke="${S}" stroke-width="2" stroke-dasharray="4,3" fill="none"/><text x="208" y="128" fill="${S}" font-size="8">MC</text><path d="M35 28 L196 148" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="146" fill="${D}" font-size="9">D=AR</text><path d="M35 28 L115 148" stroke="${MO}" stroke-width="1.5" stroke-dasharray="4,3" fill="none"/><text x="117" y="146" fill="${MO}" font-size="8">MR</text><circle cx="140" cy="108" r="3.5" fill="${S}"/><line x1="140" y1="108" x2="140" y2="148" stroke="${S}" stroke-width="1.5" stroke-dasharray="3,2"/><text x="136" y="157" fill="${S}" font-size="7">Q_eff</text><line x1="28" y1="108" x2="140" y2="108" stroke="${S}" stroke-width="1.5" stroke-dasharray="3,2"/><text x="20" y="111" fill="${S}" font-size="7">P=MC</text><line x1="28" y1="90" x2="140" y2="90" stroke="${LC}" stroke-width="1" stroke-dasharray="2,2"/><text x="20" y="93" fill="${LC}" font-size="7">LRAC</text><rect x="28" y="90" width="112" height="18" fill="rgba(239,68,68,0.2)"/><text x="84" y="102" fill="${R}" font-size="7" text-anchor="middle">Loss from MC pricing</text><text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">LRAC falls across full range. MC pricing → eff. but loss. Reg. needed.</text></svg>`;}

function taxD(){
  // S+tax shifts up 30px. Original S: M42,145 L196,26. S+T: M42,115 L196,0 (clip). D: M42,26 L196,145.
  // S+T ∩ D: at t. S+T x=42+154t, y=115-115t. D x=42+154s, y=26+119s. t=s. 115-115t=26+119t → 89=234t → t=0.380. x=42+154*0.380=101, y=115-115*0.380=71.
  // Orig S at x=101: t=(101-42)/154=0.383. y=145-119*0.383=99.4≈99. Consumer pays 71, producer gets 99, tax=28.
  return `<svg viewBox="0 0 220 168">${miAx(28,155,212,16,'Q','P')}<path d="M42 145 L196 26" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="24" fill="${S}" font-size="9">S</text><path d="M42 115 L190 4" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/><text x="172" y="12" fill="${R}" font-size="9">S+Tax</text><path d="M42 26 L196 145" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="143" fill="${D}" font-size="9">D</text><circle cx="118" cy="86" r="3" fill="white" opacity="0.6"/><circle cx="101" cy="71" r="3.5" fill="${R}"/><line x1="28" y1="71" x2="101" y2="71" stroke="${R}" stroke-width="1.5" stroke-dasharray="3,2"/><line x1="28" y1="99" x2="101" y2="99" stroke="${S}" stroke-width="1.5" stroke-dasharray="3,2"/><line x1="28" y1="86" x2="118" y2="86" stroke="${MU}" stroke-width="1" stroke-dasharray="2,2"/><text x="20" y="74" fill="${R}" font-size="7.5">Pc</text><text x="20" y="102" fill="${S}" font-size="7.5">Pp</text><text x="20" y="89" fill="${MU}" font-size="7">P₀</text><line x1="101" y1="71" x2="101" y2="155" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/><line x1="118" y1="86" x2="118" y2="155" stroke="${MU}" stroke-width="1" stroke-dasharray="2,2"/><text x="97" y="165" fill="${R}" font-size="7">Q₁</text><text x="114" y="165" fill="${MU}" font-size="7">Q₀</text><rect x="28" y="71" width="73" height="28" fill="rgba(59,130,246,0.25)"/><text x="64" y="88" fill="${D}" font-size="7.5" text-anchor="middle">Tax revenue</text><polygon points="101,71 118,86 101,86" fill="rgba(239,68,68,0.4)"/><text x="107" y="85" fill="${R}" font-size="6.5">DWL</text><text x="110" y="167" fill="${LB}" font-size="7" text-anchor="middle">Tax → S shifts up. ↑Pc, ↓Pp, ↓Q. Burden shared. DWL created.</text></svg>`;}

function subD(){
  // PRODUCER SUBSIDY. Per-unit subsidy shifts S DOWN by 25px (lower cost → supply increases).
  // ALL curves: slope = ±120/166 = ±0.7229 (consistent throughout).
  // S:     M30,145 L196,25.   y=145-0.7229*(x-30).
  // D:     M30,25  L196,145.  y=25+0.7229*(x-30).
  // S+Sub: M60,148 L196,50.   y=170-0.7229*(x-30). 25px BELOW S (same slope). Clip at y=148→x=60.
  // Orig eq (S∩D):    Q₀=113, P₀_y=85.
  // New eq (S+Sub∩D): Q₁=130. Pc_y=98 (consumer pays less). Pp_y=73 (producer receives more).
  //   Subsidy per unit = Pp−Pc = 25px (gap between S+Sub and S at any Q) ✓.
  //   Consumer benefit: P₀→Pc = 85→98 = 12px lower price.
  //   Producer benefit: P₀→Pp = 85→73 = 13px higher net receipt.
  // Govt cost rectangle: full subsidy × Q₁ = 25px height × 102px wide (x=28 to x=130).
  //   Top at Pp_y=73, bottom at Pc_y=98. Split at P₀_y=85.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}
    <!-- Govt cost rectangle: full subsidy × Q₁. Split into producer + consumer shares. -->
    <rect x="28" y="73" width="102" height="12" fill="rgba(16,185,129,0.30)"/>
    <rect x="28" y="85" width="102" height="13" fill="rgba(59,130,246,0.25)"/>
    <!-- S: upward sloping supply -->
    <path d="M30 145 L196 25" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="198" y="23" fill="${S}" font-size="8.5" font-weight="bold">S</text>
    <!-- S+Sub: same gradient, 25px below S -->
    <path d="M60 148 L196 50" stroke="${R}" stroke-width="2.5" stroke-dasharray="5,3" fill="none"/>
    <text x="168" y="57" fill="${R}" font-size="8.5" font-weight="bold">S+Sub</text>
    <!-- D: downward sloping demand -->
    <path d="M30 25 L196 145" stroke="${D}" stroke-width="2.5" fill="none"/>
    <text x="198" y="143" fill="${D}" font-size="8.5" font-weight="bold">D</text>
    <!-- Original equilibrium (S∩D): Q₀=113, P₀_y=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="85" x2="130" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="88" fill="${MU}" font-size="7.5">P₀</text>
    <text x="109" y="157" fill="${MU}" font-size="7.5">Q₀</text>
    <!-- New equilibrium (S+Sub∩D): Q₁=130, Pc_y=98 -->
    <circle cx="130" cy="98" r="3.5" fill="${R}"/>
    <line x1="130" y1="73" x2="130" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="126" y="157" fill="${R}" font-size="7.5">Q₁</text>
    <!-- Pc: consumer price (from D at Q₁) — lower than P₀ -->
    <line x1="28" y1="98" x2="130" y2="98" stroke="${D}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="16" y="101" fill="${D}" font-size="7.5">Pc</text>
    <!-- Pp: producer net price (Pc + subsidy) — higher than P₀ -->
    <circle cx="130" cy="73" r="3.5" fill="${S}"/>
    <line x1="28" y1="73" x2="130" y2="73" stroke="${S}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="16" y="76" fill="${S}" font-size="7.5">Pp</text>
    <!-- Subsidy bracket on right -->
    <line x1="140" y1="73" x2="140" y2="98" stroke="${R}" stroke-width="2"/>
    <line x1="135" y1="73" x2="145" y2="73" stroke="${R}" stroke-width="1.5"/>
    <line x1="135" y1="98" x2="145" y2="98" stroke="${R}" stroke-width="1.5"/>
    <text x="148" y="88" fill="${R}" font-size="7.5">Sub</text>
    <!-- Labels inside rectangles -->
    <text x="74" y="81" fill="${S}" font-size="7" text-anchor="middle">Producer gain</text>
    <text x="74" y="95" fill="${D}" font-size="7" text-anchor="middle">Consumer gain</text>
    <!-- Govt cost brace label -->
  </svg>`;
}

function pcD(sh){
  let ex='',nt='';
  if(sh==='ceiling'){const p=118;ex=`<line x1="28" y1="${p}" x2="210" y2="${p}" stroke="${R}" stroke-width="2"/><text x="212" y="${p+3}" fill="${R}" font-size="8">Max P</text><text x="20" y="${p+3}" fill="${R}" font-size="7.5">Pmax</text><circle cx="79" cy="${p}" r="3.5" fill="${S}"/><circle cx="156" cy="${p}" r="3.5" fill="${D}"/><line x1="79" y1="${p+8}" x2="156" y2="${p+8}" stroke="${R}" stroke-width="2"/><line x1="79" y1="${p+4}" x2="79" y2="${p+12}" stroke="${R}" stroke-width="1.5"/><line x1="156" y1="${p+4}" x2="156" y2="${p+12}" stroke="${R}" stroke-width="1.5"/><text x="117" y="${p+22}" fill="${R}" font-size="7.5" text-anchor="middle">Shortage: Qd &gt; Qs</text><text x="72" y="${p-4}" fill="${S}" font-size="7">Qs</text><text x="152" y="${p-4}" fill="${D}" font-size="7">Qd</text>`;nt='Max P below P* → shortage. Rationing, black markets.';}
  else{const p=56;ex=`<line x1="28" y1="${p}" x2="210" y2="${p}" stroke="${S}" stroke-width="2"/><text x="212" y="${p+3}" fill="${S}" font-size="8">Min P</text><text x="20" y="${p+3}" fill="${S}" font-size="7.5">Pmin</text><circle cx="83" cy="${p}" r="3.5" fill="${D}"/><circle cx="152" cy="${p}" r="3.5" fill="${S}"/><line x1="83" y1="${p+8}" x2="152" y2="${p+8}" stroke="${S}" stroke-width="2"/><line x1="83" y1="${p+4}" x2="83" y2="${p+12}" stroke="${S}" stroke-width="1.5"/><line x1="152" y1="${p+4}" x2="152" y2="${p+12}" stroke="${S}" stroke-width="1.5"/><text x="117" y="${p+22}" fill="${S}" font-size="7.5" text-anchor="middle">Surplus: Qs &gt; Qd</text><text x="79" y="${p-4}" fill="${D}" font-size="7">Qd</text><text x="148" y="${p-4}" fill="${S}" font-size="7">Qs</text>`;nt='Min P above P* → surplus. Govt may need to buy excess.';}
  return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M42 145 L196 26" stroke="${S}" stroke-width="2" fill="none"/><text x="198" y="24" fill="${S}" font-size="9">S</text><path d="M42 26 L196 145" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="143" fill="${D}" font-size="9">D</text><circle cx="118" cy="84" r="3" fill="white" opacity="0.4"/>${ex}<text x="110" y="167" fill="${LB}" font-size="7.5" text-anchor="middle">${nt}</text></svg>`;}

function taxInelasticD(){
  // TAX INCIDENCE — INELASTIC DEMAND.
  // ALL curves: slope = ±120/166 = ±0.7229 for S and S+Tax. D steeper: slope=2.52 (inelastic).
  // S:     M30,145 L196,25.   y=145-0.7229*(x-30).
  // S+Tax: M30,120 L196,0.    y=120-0.7229*(x-30). 25px above S, same slope ✓.
  // D (inelastic, steep): slope=2.52. Passes through Q₀=113, P₀y=85.
  //   y=85+2.52*(x-113). At y=22: x=88. At y=148: x=138. → M88,22 L138,148.
  // Orig eq (S∩D):    Q₀=113, P₀y=85.
  // New eq (S+Tax∩D): Q₁=105, Pc_y=66, Pp_y=91.
  //   Consumer burden: 85−66=19px. Producer burden: 91−85=6px. Tax=25px ✓.
  //   Steep D → consumers bear most (19/25 = 76%).
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}
    <!-- S: upward sloping supply -->
    <path d="M30 145 L196 25" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="198" y="23" fill="${S}" font-size="8.5" font-weight="bold">S</text>
    <!-- S+Tax: same gradient as S, 25px above -->
    <path d="M30 120 L196 0" stroke="${R}" stroke-width="2.5" stroke-dasharray="5,3" fill="none"/>
    <text x="152" y="8" fill="${R}" font-size="8.5" font-weight="bold">S+Tax</text>
    <!-- D: steep (inelastic). M88,22 L138,148. slope=2.52. -->
    <path d="M88 22 L138 148" stroke="${D}" stroke-width="2.5" fill="none"/>
    <text x="140" y="146" fill="${D}" font-size="8.5" font-weight="bold">D</text>
    <!-- Original equilibrium (S∩D): Q₀=113, P₀y=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="88" fill="${MU}" font-size="7.5">P₀</text>
    <text x="109" y="157" fill="${MU}" font-size="7.5">Q₀</text>
    <!-- New eq (S+Tax∩D): Q₁=105, Pc=66 -->
    <circle cx="105" cy="66" r="3.5" fill="${R}"/>
    <line x1="105" y1="66" x2="105" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="99" y="157" fill="${R}" font-size="7.5">Q₁</text>
    <!-- Pc: consumer price -->
    <line x1="28" y1="66" x2="105" y2="66" stroke="${D}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="16" y="69" fill="${D}" font-size="7.5">Pc</text>
    <!-- Pp: producer net price (S at Q₁) -->
    <line x1="28" y1="91" x2="105" y2="91" stroke="${S}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="16" y="94" fill="${S}" font-size="7.5">Pp</text>
    <!-- Consumer burden (large): Pc→P₀ -->
    <rect x="28" y="66" width="77" height="19" fill="rgba(59,130,246,0.30)"/>
    <text x="66" y="77" fill="${D}" font-size="7.5" text-anchor="middle" font-weight="bold">Consumer ↑ (76%)</text>
    <!-- Producer burden (small): P₀→Pp -->
    <rect x="28" y="85" width="77" height="6" fill="rgba(16,185,129,0.40)"/>
    <text x="66" y="98" fill="${S}" font-size="7" text-anchor="middle">Producer ↓ (24%)</text>
    <!-- Tax bracket on left -->
    <line x1="18" y1="66" x2="18" y2="91" stroke="${R}" stroke-width="2"/>
    <line x1="13" y1="66" x2="23" y2="66" stroke="${R}" stroke-width="1.5"/>
    <line x1="13" y1="91" x2="23" y2="91" stroke="${R}" stroke-width="1.5"/>
    <text x="8" y="81" fill="${R}" font-size="7" text-anchor="middle" transform="rotate(-90,8,81)">Tax</text>
  </svg>`;
}

function taxElasticD(){
  // TAX INCIDENCE — ELASTIC DEMAND.
  // ALL curves: slope = ±120/166 = ±0.7229 for S and S+Tax. D flatter: slope=0.241 (elastic).
  // S:     M30,145 L196,25.   y=145-0.7229*(x-30).
  // S+Tax: M30,120 L196,0.    y=120-0.7229*(x-30). 25px above S, same slope ✓.
  // D (elastic, flat): slope=0.241. Passes through Q₀=113, P₀y=85.
  //   y=85+0.241*(x-113). At x=30: y=65. At x=196: y=105. → M30,65 L196,105.
  // Orig eq (S∩D):    Q₀=113, P₀y=85.
  // New eq (S+Tax∩D): Q₁=87,  Pc_y=79, Pp_y=104.
  //   Consumer burden: 85−79=6px. Producer burden: 104−85=19px. Tax=25px ✓.
  //   Flat D → producers bear most (19/25 = 76%).
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}
    <!-- S: upward sloping supply -->
    <path d="M30 145 L196 25" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="198" y="23" fill="${S}" font-size="8.5" font-weight="bold">S</text>
    <!-- S+Tax: same gradient as S, 25px above -->
    <path d="M30 120 L196 0" stroke="${R}" stroke-width="2.5" stroke-dasharray="5,3" fill="none"/>
    <text x="152" y="8" fill="${R}" font-size="8.5" font-weight="bold">S+Tax</text>
    <!-- D: flat (elastic). M30,65 L196,105. slope=0.241. -->
    <path d="M30 65 L196 105" stroke="${D}" stroke-width="2.5" fill="none"/>
    <text x="198" y="105" fill="${D}" font-size="8.5" font-weight="bold">D</text>
    <!-- Original equilibrium (S∩D): Q₀=113, P₀y=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="85" x2="113" y2="85" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="88" fill="${MU}" font-size="7.5">P₀</text>
    <text x="109" y="157" fill="${MU}" font-size="7.5">Q₀</text>
    <!-- New eq (S+Tax∩D): Q₁=87, Pc=79 -->
    <circle cx="87" cy="79" r="3.5" fill="${R}"/>
    <line x1="87" y1="79" x2="87" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="81" y="157" fill="${R}" font-size="7.5">Q₁</text>
    <!-- Pc: consumer price -->
    <line x1="28" y1="79" x2="87" y2="79" stroke="${D}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="16" y="82" fill="${D}" font-size="7.5">Pc</text>
    <!-- Pp: producer net price (S at Q₁) -->
    <line x1="28" y1="104" x2="87" y2="104" stroke="${S}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="16" y="107" fill="${S}" font-size="7.5">Pp</text>
    <!-- Consumer burden (small): Pc→P₀ -->
    <rect x="28" y="79" width="59" height="6" fill="rgba(59,130,246,0.30)"/>
    <text x="57" y="92" fill="${D}" font-size="7" text-anchor="middle">Consumer ↑ (24%)</text>
    <!-- Producer burden (large): P₀→Pp -->
    <rect x="28" y="85" width="59" height="19" fill="rgba(16,185,129,0.40)"/>
    <text x="57" y="97" fill="${S}" font-size="7.5" text-anchor="middle" font-weight="bold">Producer ↓ (76%)</text>
    <!-- Tax bracket on left -->
    <line x1="18" y1="79" x2="18" y2="104" stroke="${R}" stroke-width="2"/>
    <line x1="13" y1="79" x2="23" y2="79" stroke="${R}" stroke-width="1.5"/>
    <line x1="13" y1="104" x2="23" y2="104" stroke="${R}" stroke-width="1.5"/>
    <text x="8" y="94" fill="${R}" font-size="7" text-anchor="middle" transform="rotate(-90,8,94)">Tax</text>
  </svg>`;
}
function csD(){
  // CORRECTIVE SUBSIDY (merit good / positive externality).
  // ALL curves slope = ±120/166 = ±0.7229 — identical to all other externality diagrams.
  // S=MSC:  M30,145 L196,25.  y=145-slope*(x-30). 
  // MPB=D:  M30,25  L196,145. y=25+slope*(x-30).
  // Market eq S∩MPB: Qm=113, Pm=85.
  // MSB: 25px above MPB (same slope). y=slope*(x-30). M37,5 L196,120. 
  //   Social opt MSB∩S: Q*=130, P*=73.
  // S+Sub: 25px below S (same slope). y=170-slope*(x-30). M60,148 L196,50.
  //   S+Sub∩MPB: Q*=130, P*=73 — subsidy shifts S exactly to social optimum ✓.
  // Subsidy bracket at x=150: S y=58, S+Sub y=83. Gap=25px = per-unit subsidy.
  // DWL triangle: apex (130,73) at Q* where MSB=S, base at Qm=113 between MSB y=60 and MPB y=85.
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','P')}
    <!-- S=MSC: upward sloping supply -->
    <path d="M30 145 L196 25" stroke="${S}" stroke-width="2" fill="none"/>
    <text x="198" y="23" fill="${S}" font-size="8" font-weight="bold">S=MSC</text>
    <!-- MPB=D: downward sloping private demand -->
    <path d="M30 25 L196 145" stroke="${D}" stroke-width="2" fill="none"/>
    <text x="198" y="143" fill="${D}" font-size="8" font-weight="bold">MPB=D</text>
    <!-- MSB: 25px above MPB, same slope — social demand including external benefit -->
    <path d="M37 5 L196 120" stroke="${MSB}" stroke-width="2.5" fill="none"/>
    <text x="198" y="118" fill="${MSB}" font-size="8" font-weight="bold">MSB</text>
    <!-- S+Sub: 25px below S, same slope — supply after per-unit subsidy -->
    <path d="M60 148 L196 50" stroke="${R}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="180" y="46" fill="${R}" font-size="7.5" font-weight="bold">S+Sub</text>
    <!-- Market eq (S∩MPB): Qm=113, Pm=85 -->
    <circle cx="113" cy="85" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <line x1="113" y1="85" x2="113" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="109" y="157" fill="${MU}" font-size="7">Q_m</text>
    <!-- Social optimum (MSB∩S = S+Sub∩MPB): Q*=130, P*=73 -->
    <circle cx="130" cy="73" r="3.5" fill="${MSB}"/>
    <line x1="28" y1="73" x2="130" y2="73" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="130" y1="73" x2="130" y2="148" stroke="${MSB}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="76" fill="${MSB}" font-size="7">P*</text>
    <text x="126" y="157" fill="${MSB}" font-size="7">Q*</text>
    <!-- DWL triangle: apex at Q*=130 (MSB∩S), base at Qm=113 between MSB and MPB -->
    <polygon points="130,73 113,60 113,85" fill="rgba(239,68,68,0.35)"/>
    <text x="116" y="78" fill="${R}" font-size="6.5">DWL</text>
    <!-- Subsidy bracket at x=150: gap between S and S+Sub = per-unit subsidy -->
    <line x1="150" y1="58" x2="150" y2="83" stroke="${R}" stroke-width="2.5"/>
    <line x1="145" y1="58" x2="155" y2="58" stroke="${R}" stroke-width="1.5"/>
    <line x1="145" y1="83" x2="155" y2="83" stroke="${R}" stroke-width="1.5"/>
    <text x="157" y="68" fill="${R}" font-size="7.5" font-weight="bold">Sub</text>
    <text x="157" y="78" fill="${R}" font-size="7">= MEB</text>
  </svg>`;
}

function tarD(){
  // Domestic S: M30,148 L165,22. Domestic D: M30,22 L195,148. Domestic eq approx (105,82).
  // WP below eq: y=120. WP+T: y=98.
  // At WP(y=120): S: t=(148-120)/126=0.222 → x=30+135*0.222=60. D: t=(120-22)/126=0.778 → x=30+165*0.778=158.
  // At WP+T(y=98): S: t=(148-98)/126=0.397 → x=30+135*0.397=84. D: t=(98-22)/126=0.603 → x=30+165*0.603=130.
  return `<svg viewBox="0 0 220 168">${miAx(28,152,212,16,'Q','P')}<path d="M30 148 L165 22" stroke="${S}" stroke-width="2" fill="none"/><text x="167" y="20" fill="${S}" font-size="9">S_dom</text><path d="M30 22 L196 148" stroke="${D}" stroke-width="2" fill="none"/><text x="198" y="146" fill="${D}" font-size="9">D_dom</text>
  <line x1="28" y1="120" x2="210" y2="120" stroke="${MU}" stroke-width="1.5" stroke-dasharray="5,3"/><text x="213" y="123" fill="${MU}" font-size="7.5">WP</text>
  <line x1="28" y1="98" x2="210" y2="98" stroke="${R}" stroke-width="1.5" stroke-dasharray="5,3"/><text x="213" y="101" fill="${R}" font-size="7.5">WP+T</text>
  <circle cx="60" cy="120" r="3" fill="${S}"/><circle cx="158" cy="120" r="3" fill="${D}"/><circle cx="84" cy="98" r="3" fill="${S}"/><circle cx="130" cy="98" r="3" fill="${D}"/>
  <line x1="60" y1="120" x2="60" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="2,2"/><line x1="158" y1="120" x2="158" y2="152" stroke="${MU}" stroke-width="1" stroke-dasharray="2,2"/><line x1="84" y1="98" x2="84" y2="152" stroke="${R}" stroke-width="1" stroke-dasharray="2,2"/><line x1="130" y1="98" x2="130" y2="152" stroke="${R}" stroke-width="1" stroke-dasharray="2,2"/>
  <text x="56" y="162" fill="${MU}" font-size="6.5">Q1</text><text x="80" y="162" fill="${R}" font-size="6.5">Q2</text><text x="126" y="162" fill="${R}" font-size="6.5">Q3</text><text x="154" y="162" fill="${MU}" font-size="6.5">Q4</text>
  <rect x="84" y="98" width="46" height="22" fill="rgba(59,130,246,0.25)"/><text x="107" y="113" fill="${D}" font-size="7" text-anchor="middle">Govt Rev</text>
  <polygon points="60,98 60,120 84,120 84,98" fill="rgba(16,185,129,0.25)"/><text x="72" y="113" fill="${S}" font-size="6.5" text-anchor="middle">PS↑</text>
  <polygon points="84,98 60,98 60,120" fill="rgba(239,68,68,0.3)"/><polygon points="130,98 158,98 158,120" fill="rgba(239,68,68,0.3)"/><text x="108" y="167" fill="${LB}" font-size="7" text-anchor="middle">Tariff → ↑P from WP. ↑Dom S, ↓Dom D, ↓Imports. DWL triangles.</text></svg>`;}

function rcD(){
  // Single panel: Price Taker revenue — AR=MR horizontal + TR rising linearly
  // Two mini-graphs stacked within one viewBox using a dividing line
  // Top half (y 16-84): TR straight line from origin
  // Bottom half (y 92-148): AR=MR horizontal
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <!-- Dividing label -->
    <text x="110" y="12" fill="${LC}" font-size="7.5" font-weight="bold" text-anchor="middle">PRICE TAKER</text>
    <!-- TOP: TR panel (y 18–82) -->
    <line x1="28" y1="18" x2="28" y2="82" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="82" x2="212" y2="82" stroke="${MU}" stroke-width="1.5"/>
    <text x="6" y="50" fill="${LB}" font-size="6.5" text-anchor="middle">TR</text>
    <text x="208" y="91" fill="${LB}" font-size="6" text-anchor="middle">Output</text>
    <!-- TR: straight line (constant price per unit) -->
    <line x1="28" y1="82" x2="190" y2="22" stroke="${S}" stroke-width="2.5"/>
    <text x="192" y="20" fill="${S}" font-size="8" font-weight="bold">TR</text>
    <!-- Divider -->
    <line x1="28" y1="90" x2="212" y2="90" stroke="${MU}" stroke-width="0.5" stroke-dasharray="2,2"/>
    <!-- BOTTOM: AR=MR panel (y 96–148) -->
    <line x1="28" y1="96" x2="28" y2="148" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="148" x2="212" y2="148" stroke="${MU}" stroke-width="1.5"/>
    <text x="6" y="118" fill="${LB}" font-size="6.5" text-anchor="middle">P / R</text>
    <text x="208" y="157" fill="${LB}" font-size="6" text-anchor="middle">Output</text>
    <!-- AR=MR: horizontal at market price -->
    <line x1="28" y1="122" x2="212" y2="122" stroke="${MU}" stroke-width="2.5"/>
    <text x="155" y="118" fill="${MU}" font-size="8" font-weight="bold">AR = MR = P</text>
    <!-- Representative Q point: where firm chooses to produce (MC=MR, not shown here) -->
    <line x1="120" y1="122" x2="120" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <circle cx="120" cy="122" r="3" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <text x="116" y="157" fill="${MU}" font-size="6.5">Q*</text>
  </svg>`;
}


function rcPriceMakerD(){
  // Single panel: Price Maker — AR downward, MR below AR, TR inverted-U
  // Two mini-graphs stacked within one viewBox
  // Top half (y 18–82): TR inverted-U parabola
  // Bottom half (y 92–148): AR and MR
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <text x="110" y="12" fill="${LC}" font-size="7.5" font-weight="bold" text-anchor="middle">PRICE MAKER</text>
    <!-- TOP: TR panel (y 18–82) — inverted U -->
    <line x1="28" y1="18" x2="28" y2="82" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="82" x2="212" y2="82" stroke="${MU}" stroke-width="1.5"/>
    <text x="6" y="50" fill="${LB}" font-size="6.5" text-anchor="middle">TR</text>
    <text x="208" y="91" fill="${LB}" font-size="6" text-anchor="middle">Output</text>
    <!-- TR: inverted-U scaled to top panel — peaks at Q* -->
    <!-- Rescaled from 0 0 220 316 top panel: y coords /2 + 18, x same -->
    <path d="M29 80 C52 53 75 27 105 27 C135 27 171 53 207 80"
          stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="190" y="46" fill="${S}" font-size="7.5" font-weight="bold">TR</text>
    <!-- Q* at peak of TR — aligned with MR=0 at x=119 -->
    <line x1="119" y1="27" x2="119" y2="82" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="115" y="90" fill="${MU}" font-size="6.5">Q*</text>
    <!-- Divider -->
    <line x1="28" y1="90" x2="212" y2="90" stroke="${MU}" stroke-width="0.5" stroke-dasharray="2,2"/>
    <!-- BOTTOM: AR and MR panel (y 96–148) -->
    <line x1="28" y1="96" x2="28" y2="148" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="148" x2="212" y2="148" stroke="${MU}" stroke-width="1.5"/>
    <text x="6" y="118" fill="${LB}" font-size="6.5" text-anchor="middle">P / R</text>
    <text x="208" y="157" fill="${LB}" font-size="6" text-anchor="middle">Output</text>
    <!-- AR: downward sloping demand — scaled to bottom panel -->
    <line x1="33" y1="100" x2="206" y2="148" stroke="${D}" stroke-width="2.5"/>
    <text x="200" y="160" fill="${D}" font-size="8" font-weight="bold">AR</text>
    <!-- MR: twice as steep, same intercept, hits x-axis at Q* -->
    <line x1="33" y1="100" x2="119" y2="148" stroke="${MO}" stroke-width="2.5"/>
    <text x="116" y="160" fill="${MO}" font-size="8" font-weight="bold">MR</text>
    <!-- Q* vertical where MR=0 — at x=119 matching MR intercept -->
    <line x1="119" y1="124" x2="119" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <!-- Dot at MR=0 (x-axis intercept of MR) -->
    <circle cx="119" cy="148" r="3" fill="white" stroke="${MO}" stroke-width="1.5"/>
    <!-- Dot at TR peak in top panel — aligned at x=119 -->
    <circle cx="119" cy="27" r="3" fill="${MO}"/>
  </svg>`;
}


function adValoremD(){
  // Coordinates mapped exactly from Ad_Valorem_Tax.svg.
  // axes: origin(1409,1864), X:1409→3047=1638px, Y:1864→340=1524px
  // D:  M50.0,36.0 L168.5,142.8
  // S1 (original): M191.3,81.6 L75.2,143.6
  // S2 (S+higher tax, steeper/pivoted): M182.1,33.2 L56.8,139.5
  // P1 green: y=91.9, x=28→113.3  |  Q1 green: x=113.3, y=148→91.9
  // P2 red:   y=111.1, x=28→136.1 |  Q2 red:   x=136.1, y=148→111.1
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Quantity','Price')}
    <!-- S: original supply -->
    <line x1="75.2" y1="143.6" x2="191.3" y2="81.6" stroke="${S}" stroke-width="2.5"/>
    <text x="194" y="80" fill="${S}" font-size="8" font-weight="bold">S</text>
    <!-- S+higher tax: pivoted steeper (ad valorem = % of price, so bigger effect at higher prices) -->
    <line x1="56.8" y1="139.5" x2="182.1" y2="33.2" stroke="${R}" stroke-width="2.5" stroke-dasharray="5,3"/>
    <text x="183" y="32" fill="${R}" font-size="7.5" font-weight="bold">S+higher</text>
    <text x="183" y="41" fill="${R}" font-size="7.5" font-weight="bold">tax</text>
    <!-- D: downward sloping -->
    <line x1="50.0" y1="36.0" x2="168.5" y2="142.8" stroke="${D}" stroke-width="2.5"/>
    <text x="170" y="141" fill="${D}" font-size="8" font-weight="bold">D</text>
    <!-- P1 / Q1 dashed (original eq, green) -->
    <line x1="28.0" y1="91.9" x2="113.3" y2="91.9" stroke="${S}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <line x1="113.3" y1="148.0" x2="113.3" y2="91.9" stroke="${S}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="15" y="95" fill="${S}" font-size="7.5" font-weight="bold">P1</text>
    <text x="109" y="158" fill="${S}" font-size="7.5" font-weight="bold">Q1</text>
    <!-- P2 / Q2 dashed (post-tax eq, red) -->
    <line x1="28.0" y1="111.1" x2="136.1" y2="111.1" stroke="${R}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <line x1="136.1" y1="148.0" x2="136.1" y2="111.1" stroke="${R}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="15" y="115" fill="${R}" font-size="7.5" font-weight="bold">P</text>
    <text x="132" y="158" fill="${R}" font-size="7.5" font-weight="bold">Q</text>
    <!-- Equilibrium dots -->
    <circle cx="113.3" cy="91.9" r="3.5" fill="white" stroke="${S}" stroke-width="1.5"/>
    <circle cx="136.1" cy="111.1" r="3.5" fill="white" stroke="${R}" stroke-width="1.5"/>
  </svg>`;
}

function kuznetsCurveD(){
  // Kuznets Curve — inverted-U: inequality rises then falls as income per capita grows
  // Redesigned layout:
  //   - Taller viewBox (220×190) to accommodate legend strip below chart
  //   - Chart area: y 16→128. Legend strip: y 133→185.
  //   - Three coloured stage bands on x-axis zone (y 120→128)
  //   - Clean dots on curve with short leader lines to x-axis band labels
  //   - All annotation text moved OUT of curve area into legend rows
  //
  // Path scaled to chart area (bottom=128 not 148):
  //   M35,115 C60,30 90,18 115,28 C140,38 170,68 200,83
  //   (35,115)  = low income, low-moderate inequality
  //   (115,28)  = middle income, peak inequality
  //   (200,83)  = high income, lower inequality
  return `<svg viewBox="0 0 220 215" xmlns="http://www.w3.org/2000/svg">
    <!-- Axes (chart area bottom=128, top=16) -->
    <line x1="28" y1="16" x2="28" y2="128" stroke="${MU}" stroke-width="1.5"/>
    <line x1="28" y1="128" x2="212" y2="128" stroke="${MU}" stroke-width="1.5"/>
    <text x="120" y="136" fill="${MU}" font-size="7" text-anchor="middle">← Low income per capita — High income per capita →</text>
    <text x="10" y="75" fill="${MU}" font-size="7" text-anchor="middle" transform="rotate(-90,10,75)">Inequality (Gini)</text>
    <!-- Stage background bands — below x-axis label -->
    <rect x="28"  y="143" width="58"  height="8" fill="rgba(59,130,246,0.25)" rx="1"/>
    <rect x="86"  y="143" width="58"  height="8" fill="rgba(239,68,68,0.25)"  rx="1"/>
    <rect x="144" y="143" width="68"  height="8" fill="rgba(34,197,94,0.25)"  rx="1"/>
    <text x="57"  y="150" fill="${D}" font-size="5.5" text-anchor="middle" font-weight="bold">Stage 1</text>
    <text x="115" y="150" fill="${R}" font-size="5.5" text-anchor="middle" font-weight="bold">Stage 2</text>
    <text x="178" y="150" fill="${S}" font-size="5.5" text-anchor="middle" font-weight="bold">Stage 3</text>
    <!-- Stage divider lines -->
    <line x1="86"  y1="143" x2="86"  y2="151" stroke="${MU}" stroke-width="0.8" opacity="0.5"/>
    <line x1="144" y1="143" x2="144" y2="151" stroke="${MU}" stroke-width="0.8" opacity="0.5"/>
    <!-- Kuznets inverted-U curve -->
    <path d="M35,115 C60,30 90,18 115,28 C140,38 170,68 200,83"
          stroke="${LC}" stroke-width="3" fill="none"/>
    <!-- Peak dot + vertical guide -->
    <circle cx="115" cy="28" r="3.5" fill="white" stroke="${LC}" stroke-width="1.8"/>
    <line x1="115" y1="28" x2="115" y2="120"
          stroke="${MU}" stroke-width="0.8" stroke-dasharray="3,2" opacity="0.6"/>
    <!-- Country dots on curve with small labels only (A/B/C — decoded in legend) -->
    <circle cx="42"  cy="108" r="3" fill="${D}"/>
    <text x="42"  y="104" fill="${D}"  font-size="6.5" text-anchor="middle" font-weight="bold">A</text>
    <circle cx="105" cy="29"  r="3" fill="${R}"/>
    <text x="105" y="25"  fill="${R}"  font-size="6.5" text-anchor="middle" font-weight="bold">B</text>
    <circle cx="185" cy="79"  r="3" fill="${S}"/>
    <text x="185" y="75"  fill="${S}"  font-size="6.5" text-anchor="middle" font-weight="bold">C</text>
    <!-- ── LEGEND STRIP ── -->
    <line x1="28" y1="155" x2="212" y2="155" stroke="${MU}" stroke-width="0.5" opacity="0.4"/>
    <!-- Row 1: Stage labels -->
    <rect x="28" y="157",0.5)" rx="1"/>
    <text x="37" y="163" fill="${D}" font-size="6" font-weight="bold">Stage 1</text>
    <text x="37" y="170" fill="${MU}" font-size="5.5">Pre-industrial · ↑Y → ↑ inequality</text>
    <rect x="28" y="174" width="6" height="6" fill="rgba(239,68,68,0.5)" rx="1"/>
    <text x="37" y="180" fill="${R}" font-size="6" font-weight="bold">Stage 2</text>
    <text x="37" y="187" fill="${MU}" font-size="5.5">Industrialisation · peak urban-rural gap</text>
    <rect x="28" y="191" width="6" height="6" fill="rgba(34,197,94,0.5)" rx="1"/>
    <text x="37" y="197" fill="${S}" font-size="6" font-weight="bold">Stage 3</text>
    <text x="37" y="204" fill="${MU}" font-size="5.5">Mature economy · redistribution → ↓ inequality</text>
    <!-- Row 2: Country key -->
    <circle cx="120" cy="160" r="3" fill="${D}"/>
    <text x="126" y="163" fill="${MU}" font-size="5.5">A = Sub-Saharan LDCs</text>
    <circle cx="120" cy="174" r="3" fill="${R}"/>
    <text x="126" y="177" fill="${MU}" font-size="5.5">B = Brazil / South Africa</text>
    <circle cx="120" cy="188" r="3" fill="${S}"/>
    <text x="126" y="191" fill="${MU}" font-size="5.5">C = UK / Scandinavia</text>
  </svg>`;
}

function backwardsBendD(){
  // Backwards Bending Labour Supply Curve
  // At low wages: substitution effect > income effect → upward sloping (normal SL)
  // At W*: income effect = substitution effect → maximum hours supplied
  // Above W*: income effect > substitution effect → fewer hours despite higher W (bend back)
  //
  // Path: M40,148 C55,120 90,100 130,75 C155,58 110,35 85,20
  //   (40,148) = near origin — low wage, few hours
  //   (130,75) = W* bend point — maximum hours supplied
  //   (85,20)  = very high wage, fewer hours — backwards section
  //
  // W1 y=118 (low wage, upward section). H1 x=80.
  // W* y=75  (bend point). Max hours x=130.
  // W2 y=45  (high wage, backward section). H2 x=96 < H1=80 ← key exam point
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <defs>
      ${miArw('bbs',LC)}
      ${miArw('bbr',R)}
    </defs>
    ${miAx(28,148,212,16,'Hours of Labour','Wage Rate')}
    <!-- Backwards bending supply curve: rises right then bends back left -->
    <path d="M40,148 C55,120 90,100 130,75 C155,58 110,35 85,20"
          stroke="${S}" stroke-width="3" fill="none"/>
    <text x="88" y="17" fill="${S}" font-size="8" font-weight="bold">SL</text>
    <!-- W* (bend point) — horizontal dashed -->
    <line x1="28" y1="75" x2="130" y2="75"
          stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="14" y="78" fill="${MU}" font-size="7.5" font-weight="bold">W*</text>
    <circle cx="130" cy="75" r="3.5" fill="white" stroke="${S}" stroke-width="1.8"/>
    <!-- W1 (low wage) dashed guides — curve x=65.4 at y=118 -->
    <line x1="28" y1="118" x2="65" y2="118"
          stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="14" y="121" fill="${MU}" font-size="7">W1</text>
    <line x1="65" y1="118" x2="65" y2="148"
          stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <circle cx="65" cy="118" r="2.5" fill="${MU}"/>
    <text x="61" y="157" fill="${MU}" font-size="7">H1</text>
    <!-- W2 (high wage) dashed guides — curve x=124.7 at y=45. H2 > H1 visually but on backward section -->
    <line x1="28" y1="45" x2="125" y2="45"
          stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="14" y="48" fill="${MU}" font-size="7">W2</text>
    <line x1="125" y1="45" x2="125" y2="148"
          stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <circle cx="125" cy="45" r="2.5" fill="${MU}"/>
    <text x="121" y="157" fill="${MU}" font-size="7">H2</text>
    <!-- Section label: lower (substitution dominates) -->
    <text x="85" y="130" fill="${LC}" font-size="6.5" text-anchor="middle">Substitution</text>
    <text x="85" y="138" fill="${LC}" font-size="6.5" text-anchor="middle">effect dominates</text>
    <line x1="90" y1="119" x2="100" y2="108"
          stroke="${LC}" stroke-width="1.2" marker-end="url(#bbs)"/>
    <!-- Section label: upper (income dominates) -->
    <text x="158" y="50" fill="${R}" font-size="6.5" text-anchor="middle">Income effect</text>
    <text x="158" y="58" fill="${R}" font-size="6.5" text-anchor="middle">dominates</text>
    <line x1="148" y1="52" x2="138" y2="53"
          stroke="${R}" stroke-width="1.2" marker-end="url(#bbr)"/>
  </svg>`;
}

function mrpD(){
  // Coordinates mapped exactly from Marginal_Revenue_Product_Curve.svg.
  // axes: origin(1327,1828), X:1327→3011=1684px, Y:1828→486=1342px
  // MRP cubic: M35.4,50.8 C45.3,32.7 55.1,14.6 82.0,23.1 C108.9,31.5 152.8,66.5 196.6,101.5
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','WR')}
    <!-- MRP=DL curve: downward sloping (falls as more labour hired due to diminishing returns) -->
    <path d="M35.4 50.8 C45.3 32.7 55.1 14.6 82.0 23.1 C108.9 31.5 152.8 66.5 196.6 101.5" stroke="${R}" stroke-width="3" fill="none"/>
    <text x="186" y="115" fill="${R}" font-size="8" font-weight="bold">MRP = D</text>
    <text x="188" y="125" fill="${R}" font-size="7" font-weight="bold">L</text>
    <!-- Equilibrium: wage W* horizontal, Q* vertical -->
    <line x1="28" y1="65" x2="150" y2="65" stroke="${MU}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <line x1="150" y1="65" x2="150" y2="148" stroke="${MU}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <circle cx="150" cy="65" r="3.5" fill="white" stroke="${MU}" stroke-width="1.5"/>
    <text x="15" y="78" fill="${MU}" font-size="7.5" font-weight="bold">W*</text>
    <text x="146" y="158" fill="${MU}" font-size="7.5" font-weight="bold">Q*</text>
  </svg>`;
}

function tradeUnionD(){
  // Coordinates mapped exactly from Trade_Unions.svg.
  // axes: origin(1041,1864), X:1041→3028=1987px, Y:1864→340=1524px
  // DL: M31.8,26.6 L198.9,142.2
  // SL: M40.4,137.8 L186.9,27.5
  // WTU horiz: y=55.8, x=28→195
  // Q2 vert (union employed): x=74.9, y=55.8→148
  // Q1 vert (competitive): x=112.2, y=82→148
  // W1 horiz (competitive wage): y=83.1, x=28→111.4
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q Labour','Wage')}
    <!-- DL: downward sloping -->
    <line x1="31.8" y1="26.6" x2="198.9" y2="142.2" stroke="${D}" stroke-width="2.5"/>
    <text x="197" y="134" fill="${D}" font-size="8" font-weight="bold">D of L</text>
    <!-- SL: upward sloping (below WTU only — above WTU the union wage applies) -->
    <line x1="40.4" y1="137.8" x2="149.3" y2="55.8" stroke="${S}" stroke-width="2.5"/>
    <text x="178" y="42" fill="${S}" font-size="8" font-weight="bold">S of L</text>
    <!-- WTU: union wage — green, runs from y-axis to where it meets SL at x=149.3 -->
    <line x1="28.0" y1="55.8" x2="149.3" y2="55.8" stroke="#00B050" stroke-width="2.5"/>
    <text x="12" y="59" fill="#00B050" font-size="7.5" font-weight="bold">WTU</text>
    <!-- SL continues above WTU (same line, same colour) -->
    <line x1="149.3" y1="55.8" x2="186.9" y2="27.5" stroke="${S}" stroke-width="2.5"/>
    <!-- Junction dot where WTU meets SL -->
    <circle cx="149.3" cy="55.8" r="3" fill="#00B050"/>
    <!-- Q2: employment at union wage (DL∩WTU) -->
    <line x1="74.9" y1="55.8" x2="74.9" y2="148.0" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="70" y="157" fill="${MU}" font-size="7.5" font-weight="bold">Q2</text>
    <!-- W1 / Q1: competitive equilibrium (SL∩DL) -->
    <line x1="28.1" y1="83.1" x2="111.4" y2="83.1" stroke="${LB}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <line x1="112.2" y1="82.0" x2="112.2" y2="148.0" stroke="${LB}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <circle cx="112" cy="83" r="3" fill="white" stroke="${LB}" stroke-width="1.5"/>
    <text x="14" y="86" fill="${LB}" font-size="7.5" font-weight="bold">W1</text>
    <text x="108" y="157" fill="${LB}" font-size="7.5" font-weight="bold">Q1</text>
  </svg>`;
}


// ═══════════════════════════════════════════════════════════════
// VIEW CONTROLLER
// ═══════════════════════════════════════════════════════════════


function envelopeD(){
  // LRAC: hyperbolic shape (like SRPC) — steep fall then flattening
  // M28 22 C32 62 52 105 82 125 C112 143 155 148 212 151
  // Slope: x=28→10.0, x=60→1.3, x=100→0.39, x=140→0.17, x=180→0.08
  // SRAC1: tangent at (55, 97), arms above LRAC ✓  M27 67 C38 101 47 99 55 97 C66 99 78 101 93 73
  // SRAC2: tangent at (110,137), both arms above LRAC ✓  M74 109 C88 141 99 139 110 137 C123 139 135 141 152 115
  // SRAC3: tangent at (168,148), both arms above LRAC ✓  M126 126 C143 152 155 150 168 148 C180 150 192 152 208 132
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Q','AC')}
    <!-- SRAC1: small plant — pronounced U, tangent on steep section of LRAC -->
    <path d="M28 65 C38 99 48 98 55 97 C64 98 76 100 90 44"
          stroke="${D}" stroke-width="1.8" fill="none" stroke-dasharray="4,2"/>
    <text x="84" y="42" fill="${D}" font-size="7.5" font-weight="bold">SRAC₁</text>
    <!-- SRAC2: medium plant — pronounced U, tangent on transitioning section -->
    <path d="M70 88 C86 140 100 138 110 137 C120 138 134 140 152 92"
          stroke="${S}" stroke-width="1.8" fill="none" stroke-dasharray="4,2"/>
    <text x="146" y="90" fill="${S}" font-size="7.5" font-weight="bold">SRAC₂</text>
    <!-- SRAC3: large plant — pronounced U, tangent on flat section -->
    <path d="M122 110 C140 144 155 143 168 143 C181 143 196 144 212 112"
          stroke="${R}" stroke-width="1.8" fill="none" stroke-dasharray="4,2"/>
    <text x="206" y="110" fill="${R}" font-size="7.5" font-weight="bold">SRAC₃</text>
    <!-- LRAC: hyperbolic envelope, capped above x-axis -->
    <path d="M28 22 C32 62 52 105 82 125 C112 140 155 143 212 144"
          stroke="${LC}" stroke-width="2.8" fill="none"/>
    <text x="196" y="140" fill="${LC}" font-size="8" font-weight="bold">LRAC</text>
    <!-- Tangency dots -->
    <circle cx="55" cy="97" r="3" fill="${D}"/>
    <circle cx="110" cy="137" r="3" fill="${S}"/>
    <circle cx="168" cy="143" r="3" fill="${R}"/>
  </svg>`;
}

function xIneffD(){
  // X-Inefficiency: actual AC above minimum LRAC
  // LRAC (efficient minimum): M28 22 C32 62 52 105 82 125 C112 143 155 148 212 151
  // LRAC_xi (actual, X-inefficient — ~20px above efficient curve on screen):
  //   M28 18 C32 44 52 86 82 106 C112 124 155 130 212 132
  // Gap between curves = X-inefficiency (wasted cost above minimum)
  // Similar to external EoS diagram but curve shifts UP not down
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <defs>${miArw('xia',R)}</defs>
    ${miAx(28,148,212,16,'Q','AC')}
    <!-- LRAC efficient minimum (lower curve) — capped above x-axis (y<148) -->
    <path d="M28 22 C32 62 52 105 82 122 C112 138 155 143 212 144"
          stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="196" y="140" fill="${MU}" font-size="8" font-weight="bold">LRAC</text>
    <!-- LRAC with X-inefficiency (actual AC, higher curve) -->
    <path d="M28 18 C32 44 52 86 82 106 C112 124 155 130 212 132"
          stroke="${R}" stroke-width="2.5" fill="none" stroke-dasharray="5,3"/>
    <text x="196" y="126" fill="${R}" font-size="8" font-weight="bold">AC_xi</text>
    <!-- Shaded gap between curves showing X-inefficiency -->
    <path d="M28 18 C32 44 52 86 82 106 C112 124 155 130 212 132 L212 144 C155 143 112 138 82 122 C52 105 32 62 28 22 Z"
          fill="rgba(239,68,68,0.12)"/>
    <!-- Upward arrow at mid-point showing gap -->
    <line x1="120" y1="143" x2="120" y2="126" stroke="${R}" stroke-width="1.5" marker-end="url(#xia)"/>
    <text x="124" y="138" fill="${R}" font-size="6.5">X-ineff.</text>
  </svg>`;
}

function microObjD(){
  // Firm Objectives Compared — mapped exactly from Microeconomic_Objectives.svg
  // SVG: 3204×1924, translate(-579,-198). Axes: origin(1041,1864), X→3725.3, Y-top→198
  // tx = 28 + (rx-1041)*(184/2684.3)   ty = 148 - (1864-ry)*(132/1666)
  //
  // AR:  M30.5 51.3 L193.2 136.7
  // MR:  M31.0 54.7 L104.2 148  (MR=0 at x=104.2)
  // AC:  M35.8 47.3 C53.3 76.7 70.7 106.0 91.6 106.3 C112.5 106.6 136.9 77.8 161.3 49.0
  // MC:  M35.1 109.5 C44.5 128.1 53.9 146.8 70.9 133.6 C87.9 120.4 112.4 75.5 137.0 30.5
  //
  // Q1=83.5  (profit max, MC=MR)      P1=79.1   blue   #0070C0
  // Q2=106.4 (revenue max, MR=0)      P2=91.1   green  #00B050
  // Q3=117.0 (sales max, AR=AC)       P3=96.7   red    #C00000
  // Q4=93.2  (productive eff, min AC) P4=84.2   purple #7030A0
  // Q5=103.4 (allocative eff, AR=MC)  P5=89.6   orange #C55A11
  // All verified against curves to <2px error
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Output','C & R')}
    <!-- AC: U-shaped -->
    <path d="M35.8 47.3 C53.3 76.7 70.7 106.0 91.6 106.3 C112.5 106.6 136.9 77.8 161.3 49.0"
          stroke="${LC}" stroke-width="2" fill="none"/>
    <text x="155" y="45" fill="${LC}" font-size="7.5" font-weight="bold">AC</text>
    <!-- MC: U-shaped, steeper -->
    <path d="M35.1 109.5 C44.5 128.1 53.9 146.8 70.9 133.6 C87.9 120.4 112.4 75.5 137.0 30.5"
          stroke="${S}" stroke-width="2" fill="none"/>
    <text x="131" y="27" fill="${S}" font-size="7.5" font-weight="bold">MC</text>
    <!-- AR: downward sloping -->
    <line x1="30.5" y1="51.3" x2="193.2" y2="136.7" stroke="${D}" stroke-width="2"/>
    <text x="187" y="143" fill="${D}" font-size="7.5" font-weight="bold">AR</text>
    <!-- MR: steeper, clips at x-axis -->
    <line x1="31.0" y1="54.7" x2="104.2" y2="148" stroke="${MO}" stroke-width="2"/>
    <text x="97" y="162" fill="${MO}" font-size="7.5" font-weight="bold">MR</text>
    <!-- Q1: profit max (MC=MR) — blue -->
    <line x1="83.5" y1="79.1" x2="83.5" y2="148" stroke="#0070C0" stroke-width="1.2" stroke-dasharray="4,3"/>
    <line x1="28" y1="79.1" x2="83.5" y2="79.1" stroke="#0070C0" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="80" y="157" fill="#0070C0" font-size="6.5" font-weight="bold">Q1</text>
    <!-- Q4: productive efficiency (min AC) — purple -->
    <line x1="93.2" y1="84.2" x2="93.2" y2="148" stroke="#7030A0" stroke-width="1.2" stroke-dasharray="4,3"/>
    <line x1="28" y1="84.2" x2="93.2" y2="84.2" stroke="#7030A0" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="89" y="157" fill="#7030A0" font-size="6.5" font-weight="bold">Q4</text>
    <!-- Q5: allocative efficiency (AR=MC) — orange -->
    <line x1="103.4" y1="89.6" x2="103.4" y2="148" stroke="#C55A11" stroke-width="1.2" stroke-dasharray="4,3"/>
    <line x1="28" y1="89.6" x2="103.4" y2="89.6" stroke="#C55A11" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="99" y="157" fill="#C55A11" font-size="6.5" font-weight="bold">Q5</text>
    <!-- Q2: revenue max (MR=0) — green -->
    <line x1="106.4" y1="91.1" x2="106.4" y2="148" stroke="#00B050" stroke-width="1.2" stroke-dasharray="4,3"/>
    <line x1="28" y1="91.1" x2="106.4" y2="91.1" stroke="#00B050" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="103" y="157" fill="#00B050" font-size="6.5" font-weight="bold">Q2</text>
    <!-- Q3: sales max (AR=AC) — red -->
    <line x1="117.0" y1="96.7" x2="117.0" y2="148" stroke="#C00000" stroke-width="1.2" stroke-dasharray="4,3"/>
    <line x1="28" y1="96.7" x2="117.0" y2="96.7" stroke="#C00000" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="113" y="157" fill="#C00000" font-size="6.5" font-weight="bold">Q3</text>
    <!-- P labels on y-axis -->
    <text x="16" y="82" fill="#0070C0" font-size="6" font-weight="bold">P1</text>
    <text x="16" y="87" fill="#7030A0" font-size="6" font-weight="bold">P4</text>
    <text x="16" y="92" fill="#C55A11" font-size="6" font-weight="bold">P5</text>
    <text x="16" y="94" fill="#00B050" font-size="6" font-weight="bold">P2</text>
    <text x="16" y="99" fill="#C00000" font-size="6" font-weight="bold">P3</text>
    <!-- Equilibrium dots on AR curve at each Q -->
    <circle cx="83.5" cy="79.1" r="3" fill="#0070C0"/>
    <circle cx="93.2" cy="106.3" r="3" fill="#7030A0"/>
    <circle cx="103.4" cy="89.6" r="3" fill="#C55A11"/>
    <circle cx="106.4" cy="91.1" r="3" fill="#00B050"/>
    <circle cx="117.0" cy="96.7" r="3" fill="#C00000"/>
  </svg>`;
}

function varCostD(){
  // Decrease in Variable Costs — mapped exactly from Decrease_in_Variable_Costs.svg
  // SVG: 2582×1731, translate(-579,-331). Axes: origin(1041,1864), X→3027.8, Y-top→340
  // MC:  M38.6 99.6 C52.4 122.6 66.3 145.7 90.5 133.9 C114.7 122.2 149.3 75.6 183.9 29.1
  // AC:  M46.7 36.7 C72.2 69.7 97.6 102.7 125.8 102.8 C154.1 102.8 185.1 69.9 216.2 37.0
  // MC1: M38.0 110.0 C51.9 133.0 65.7 156.1 89.9 144.3 C114.2 132.6 148.7 86.0 183.3 39.5
  // AC1: M46.2 47.1 C71.6 80.1 97.0 113.1 125.3 113.2 C153.5 113.2 184.6 80.3 215.6 47.4
  // Q* unchanged at x=125.8 (AC min position same, just lower level)
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <defs>${miArw('vcd',LC)}</defs>
    ${miAx(28,148,212,16,'Output','Costs')}
    <!-- Original MC -->
    <path d="M38.6 99.6 C52.4 122.6 66.3 145.7 90.5 133.9 C114.7 122.2 149.3 75.6 183.9 29.1"
          stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="178" y="26" fill="${MU}" font-size="7.5" font-weight="bold">MC</text>
    <!-- Original AC -->
    <path d="M46.7 36.7 C72.2 69.7 97.6 102.7 125.8 102.8 C154.1 102.8 185.1 69.9 216.2 37.0"
          stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="210" y="41" fill="${MU}" font-size="7.5" font-weight="bold">AC</text>
    <!-- Shifted MC1 (grey dashed — lower after fall in variable costs) -->
    <path d="M38.0 110.0 C51.9 133.0 65.7 156.1 89.9 144.3 C114.2 132.6 148.7 86.0 183.3 39.5"
          stroke="#7F7F7F" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="178" y="37" fill="#7F7F7F" font-size="7.5" font-weight="bold">MC1</text>
    <!-- Shifted AC1 (grey dashed — lower) -->
    <path d="M46.2 47.1 C71.6 80.1 97.0 113.1 125.3 113.2 C153.5 113.2 184.6 80.3 215.6 47.4"
          stroke="#7F7F7F" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="210" y="51" fill="#7F7F7F" font-size="7.5" font-weight="bold">AC1</text>
    <!-- Q* vertical — unchanged position, AC minimum just lower -->
    <line x1="125.8" y1="102.8" x2="125.8" y2="148" stroke="#7F7F7F" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="122" y="158" fill="${MU}" font-size="7">Q*</text>
    <!-- Downward arrows showing both curves shift down -->
    <line x1="100" y1="99" x2="100" y2="109" stroke="${LC}" stroke-width="1.5" marker-end="url(#vcd)"/>
    <line x1="126" y1="99" x2="126" y2="109" stroke="${LC}" stroke-width="1.5" marker-end="url(#vcd)"/>
  </svg>`;
}

function shutDownD(){
  // Shut-down and Break-even Prices — mapped exactly from Shut_down_and_Breakeven_Price.svg
  // SVG: 3019×1813, translate(-424,-270). Axes: origin(1041,1864), X→3358.94, Y-top→340
  // tx = 28 + (rx-1041)*(184/2317.94)   ty = 148 - (1864-ry)*(132/1524)
  //
  // MC:  M32.8 99.6 C44.7 122.6 56.6 145.7 77.4 133.9 C98.1 122.2 127.8 75.6 157.4 29.1
  // ATC: M48.5 18.8 C70.3 51.8 92.1 84.8 116.3 84.9 C140.5 84.9 167.1 52.0 193.7 19.1
  // AVC: M37.9 53.1 C59.7 86.0 81.5 119.0 105.8 119.1 C130.0 119.1 156.6 86.3 183.2 53.4
  //
  // Breakeven P2 (=ATC min, y=84.9): horizontal x=27.4→120.0. Q2 vertical x=122.5
  // Shut-down P1 (=AVC min, y=118.6): horizontal x=27.4→95.1.  Q1 vertical x=96.6
  // ATC min dot: (116.3, 84.9).  AVC min dot: (105.8, 119.1)
  return `<svg viewBox="0 0 210 162" xmlns="http://www.w3.org/2000/svg">
    <defs>${miArw('sda',LC)}</defs>
    ${miAx(28,148,200,16,'Output','Costs/Price')}
    <!-- ATC: U-shaped, higher curve -->
    <path d="M48.5 18.8 C70.3 51.8 92.1 84.8 116.3 84.9 C140.5 84.9 167.1 52.0 193.7 19.1"
          stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="187" y="16" fill="${MU}" font-size="7.5" font-weight="bold">ATC</text>
    <!-- AVC: U-shaped, lower curve -->
    <path d="M37.9 53.1 C59.7 86.0 81.5 119.0 105.8 119.1 C130.0 119.1 156.6 86.3 183.2 53.4"
          stroke="${D}" stroke-width="2.5" fill="none"/>
    <text x="180" y="52" fill="${D}" font-size="7.5" font-weight="bold">AVC</text>
    <!-- MC: upward sloping through both minima -->
    <path d="M32.8 99.6 C44.7 122.6 56.6 145.7 77.4 133.9 C98.1 122.2 127.8 75.6 157.4 29.1"
          stroke="${MO}" stroke-width="2.5" fill="none"/>
    <text x="159" y="27" fill="${MO}" font-size="7.5" font-weight="bold">MC</text>
    <!-- BREAKEVEN PRICE P2 = min ATC (light blue dashed horizontal) -->
    <line x1="27.4" y1="84.9" x2="116.3" y2="84.9"
          stroke="#00B0F0" stroke-width="1.8" stroke-dasharray="5,3"/>
    <text x="3" y="83" fill="#00B0F0" font-size="6.5" font-weight="bold">Break-</text>
    <text x="3" y="90" fill="#00B0F0" font-size="6.5" font-weight="bold">even P2</text>
    <!-- Q2 vertical (blue dashed) — at ATC min x=116.3 -->
    <line x1="116.3" y1="84.9" x2="116.3" y2="148"
          stroke="#4472C4" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="112" y="157" fill="#4472C4" font-size="6.5" font-weight="bold">Q2</text>
    <!-- ATC min dot: breakeven point -->
    <circle cx="116.3" cy="84.9" r="3.5" fill="white" stroke="#00B0F0" stroke-width="1.8"/>
    <!-- SHUT-DOWN PRICE P1 = min AVC (light blue dashed horizontal, lower) -->
    <line x1="27.4" y1="117.35" x2="96.1" y2="117.35"
          stroke="#00B0F0" stroke-width="1.8" stroke-dasharray="5,3"/>
    <text x="3" y="115" fill="#00B0F0" font-size="6.5" font-weight="bold">Shut-</text>
    <text x="3" y="122" fill="#00B0F0" font-size="6.5" font-weight="bold">down P1</text>
    <!-- Q1 vertical (blue dashed) — at MC=AVC intersection x=96.1 -->
    <line x1="96.1" y1="117.35" x2="96.1" y2="148"
          stroke="#4472C4" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="92" y="157" fill="#4472C4" font-size="6.5" font-weight="bold">Q1</text>
    <!-- AVC min dot: shut-down point at exact MC=AVC intersection -->
    <circle cx="96.1" cy="117.35" r="3.5" fill="white" stroke="#00B0F0" stroke-width="1.8"/>
    <!-- Zone labels -->
    <text x="105" y="105" fill="${R}" font-size="6" text-anchor="middle">P1&lt;P&lt;P2:</text>
    <text x="105" y="112" fill="${R}" font-size="6" text-anchor="middle">loss, continue SR</text>
  </svg>`;
}

function fixedCostD(){
  // Increase in Fixed Costs — mapped exactly from Increase_in_Fixed_Costs_and_Average_Costs.svg
  // SVG: 2613×1731, translate(-579,-331). Axes: origin(1041,1864), X→3027.8, Y-top→340
  // ATC:  M33.5 36.7 C58.9 69.7 84.4 102.7 112.6 102.8 C140.8 102.8 171.9 69.9 202.9 37.0
  // AFC:  M32.1 41.2 C38.8 67.6 45.5 94.0 73.2 111.4 C100.8 128.7 149.3 137.0 197.8 145.3
  // ATC1: M36.2 25.4 C61.7 58.3 87.1 91.3 115.4 91.4 C143.6 91.4 174.7 58.5 205.7 25.7
  // AFC1: M34.9 29.8 C41.6 56.2 48.3 82.6 76.0 100.0 C103.6 117.3 152.1 125.7 200.6 134.0
  // ATC/AFC shift UP ~11px. MC absent from SVG — unaffected by fixed costs.
  // MC line added as static U-shaped curve to show it does not shift.
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    <defs>${miArw('fcu',R)}</defs>
    ${miAx(28,148,212,16,'Output','Costs')}
    <!-- Original ATC (black/theme) -->
    <path d="M33.5 36.7 C58.9 69.7 84.4 102.7 112.6 102.8 C140.8 102.8 171.9 69.9 202.9 37.0"
          stroke="${MU}" stroke-width="2.5" fill="none"/>
    <text x="197" y="34" fill="${MU}" font-size="7.5" font-weight="bold">ATC</text>
    <!-- Original AFC (black/theme) -->
    <path d="M32.1 41.2 C38.8 67.6 45.5 94.0 73.2 111.4 C100.8 128.7 149.3 137.0 197.8 145.3"
          stroke="${MU}" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="192" y="143" fill="${MU}" font-size="7.5" font-weight="bold">AFC</text>
    <!-- Shifted ATC1 (grey — higher after ↑ fixed costs) -->
    <path d="M36.2 25.4 C61.7 58.3 87.1 91.3 115.4 91.4 C143.6 91.4 174.7 58.5 205.7 25.7"
          stroke="#7F7F7F" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="197" y="23" fill="#7F7F7F" font-size="7.5" font-weight="bold">ATC1</text>
    <!-- Shifted AFC1 (grey — higher) -->
    <path d="M34.9 29.8 C41.6 56.2 48.3 82.6 76.0 100.0 C103.6 117.3 152.1 125.7 200.6 134.0"
          stroke="#7F7F7F" stroke-width="2" fill="none" stroke-dasharray="3,2"/>
    <text x="192" y="132" fill="#7F7F7F" font-size="7.5" font-weight="bold">AFC1</text>
    <!-- MC: unchanged — fixed costs do not affect marginal cost -->
    <path d="M34.1 112.3 C46.8 132.7 59.5 145.7 82.4 133.9 C105.2 122.2 138.3 75.6 171.3 29.1"
          stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="165" y="26" fill="${S}" font-size="7.5" font-weight="bold">MC</text>
    <text x="170" y="36" fill="${S}" font-size="6">(unchanged)</text>
    <!-- Upward arrows showing ATC/AFC shift up -->
    <line x1="80" y1="99" x2="80" y2="89" stroke="${R}" stroke-width="1.5" marker-end="url(#fcu)"/>
    <line x1="112" y1="99" x2="112" y2="89" stroke="${R}" stroke-width="1.5" marker-end="url(#fcu)"/>
  </svg>`;
}

function salesMaxD(){
  // Sales Maximisation (Baumol): AR=AC normal profit constraint
  // Mapped exactly from Sales_Maximising_Output_AC___AR.svg
  // AR:  M33.1 20.8 L206.3 134.2
  // MR:  M33.7 24.6 L131.7 148  (MR=0 at x=131.7)
  // AC:  M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2
  // MC:  M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.7 C105.2 124.3 138.3 75.1 171.4 26.0
  // Qs=147.6, Ps=94.2. AR at Qs=95.8, AC at Qs=96.0 — AR≈AC (normal profit) ✓
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Q','C/R')}
    <path d="M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2"
          stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="198" y="60" fill="${LC}" font-size="8" font-weight="bold">AC</text>
    <path d="M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.7 C105.2 124.3 138.3 75.1 171.4 26.0"
          stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="169" y="40" fill="${S}" font-size="8" font-weight="bold">MC</text>
    <line x1="33.1" y1="20.8" x2="206.3" y2="134.2" stroke="${D}" stroke-width="2.5"/>
    <text x="199" y="146" fill="${D}" font-size="8" font-weight="bold">AR</text>
    <line x1="33.7" y1="24.6" x2="131.7" y2="148" stroke="${MO}" stroke-width="2"/>
    <text x="128" y="162" fill="${MO}" font-size="8" font-weight="bold">MR</text>
    <!-- MR=0 tick -->
    <line x1="131.7" y1="144" x2="131.7" y2="152" stroke="${MO}" stroke-width="1.5"/>
    <!-- Qs: sales max output where AR=AC (normal profit constraint) -->
    <line x1="147.6" y1="94.2" x2="147.6" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="143" y="158" fill="${MU}" font-size="7" font-weight="bold">Qs</text>
    <!-- Ps: normal profit price -->
    <line x1="28" y1="94.2" x2="147.6" y2="94.2" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="17" y="97" fill="${MU}" font-size="7" font-weight="bold">Ps</text>
    <!-- AR=AC tangency dot -->
    <circle cx="147.6" cy="95.8" r="3.5" fill="${D}" stroke="white" stroke-width="1"/>
    <!-- Normal profit label -->
    <text x="62" y="91" fill="${MU}" font-size="6.5" text-anchor="middle">Normal profit</text>
  </svg>`;
}

function monoCompD(sh){
  // SR coords mapped exactly from Monopolistic_Competition_SR_with_supernormal_profits.svg
  // Source: 2591×1731, translate(-579,-331). Axes origin raw(1041,1864), top(1041,340), right(3027.8,1864)
  // tx = 28 + (rx-1041)*184/1986.8  ty = 148 + (ry-1864)*(-132)/1524
  // AR:  M33.1 20.8 L206.3 134.2
  // MR:  M33.7 24.6 L131.7 148   (hits x-axis at raw x=2160.8)
  // AC:  M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2
  // MC:  M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.7 C105.2 124.3 138.3 75.1 171.4 26.0
  // MC=MR: x=106.4, y=116.2  (zero error verified)
  // P (AR at Q): y=68.8   Q vert: x=106.4
  // C (AC at Q): y=109.5
  // SNP rect: left=28, top=68.8, right=106.4, bottom=109.5  w=78.4 h=40.7
  const lr = sh==='longRun';
  let eq='', note='';
  if(!lr){
    eq=`<!-- Supernormal profit rectangle: P down to AC at Qm -->
    <rect x="28" y="68.8" width="78.4" height="40.7" fill="rgba(68,114,196,0.20)"/>
    <text x="67" y="93" fill="${D}" font-size="7.5" text-anchor="middle">SNP</text>
    <!-- P dashed: AR at Qm -->
    <line x1="28" y1="68.8" x2="106.4" y2="68.8" stroke="${R}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="17" y="72" fill="${R}" font-size="7">P</text>
    <!-- C dashed: AC at Qm -->
    <line x1="28" y1="109.5" x2="106.4" y2="109.5" stroke="${LC}" stroke-width="1.5" stroke-dasharray="3,2"/>
    <text x="17" y="113" fill="${LC}" font-size="7">C</text>
    <!-- Q vertical: MC=MR output -->
    <line x1="106.4" y1="68.8" x2="106.4" y2="148" stroke="${MU}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="102" y="157" fill="${MU}" font-size="7">Qm</text>
    <!-- MC=MR dot -->
    <circle cx="106.4" cy="116.2" r="3.5" fill="white" stroke="${S}" stroke-width="1.5"/>`;
    note='SR: MC=MR → Qm. P > AC → supernormal profit. New entry erodes this in LR.';
  } else {
    // LR: AR tangent to AC at Q=89.2, P=87.0. Mapped from Monopolistic_Competition_LR.svg.
    // AR: M31.4 51.3 L186.9 145.0  MR: M32.1 54.7 L115.7 148
    // AC: M38.6 32.9 C62.1 62.6 85.7 92.4 114.0 92.7 C142.2 93.0 175.1 63.8 208.0 34.6
    // MC: M37.5 95.0 C50.2 113.7 62.9 132.3 85.7 119.2 C108.6 106.0 141.7 61.0 174.7 16.0
    // AR at Q=89.2: y=86.1, AC at Q=89.2: y=84.9, P guide: y=87.0 — tangency ✓
    // MC=MR: x=88.4, y=117.5, err=0.00 ✓
    eq=`<!-- P dashed: tangency of AR and AC -->
    <line x1="28" y1="87.0" x2="89.2" y2="87.0" stroke="${D}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="17" y="90" fill="${D}" font-size="7" font-weight="bold">P</text>
    <!-- Q vertical -->
    <line x1="89.2" y1="87.0" x2="89.2" y2="148" stroke="${MU}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="85" y="157" fill="${MU}" font-size="7" font-weight="bold">Q</text>
    <!-- MC=MR dot -->
    <circle cx="88.4" cy="117.5" r="3.5" fill="white" stroke="${S}" stroke-width="1.5"/>
    <!-- Tangency dot: AR touches AC -->
    <circle cx="89.2" cy="86.5" r="3.5" fill="${D}" stroke="white" stroke-width="1"/>`;
    note='LR: AR tangent to AC → P=AC, normal profit only. Q < min AC → excess capacity.';
  }
  // SR uses original (wider) AC/MC; LR uses shifted-left AC/MC
  const acPath = lr
    ? `M38.6 32.9 C62.1 62.6 85.7 92.4 114.0 92.7 C142.2 93.0 175.1 63.8 208.0 34.6`
    : `M35.1 44.3 C58.7 76.9 82.3 109.5 110.5 109.8 C138.8 110.1 171.7 78.2 204.6 46.2`;
  const mcPath = lr
    ? `M37.5 95.0 C50.2 113.7 62.9 132.3 85.7 119.2 C108.6 106.0 141.7 61.0 174.7 16.0`
    : `M34.1 112.3 C46.8 132.7 59.5 153.0 82.4 138.7 C105.2 124.3 138.3 75.1 171.4 26.0`;
  const arLine = lr
    ? `<line x1="31.4" y1="51.3" x2="186.9" y2="145.0" stroke="${D}" stroke-width="2.5"/><text x="180" y="157" fill="${D}" font-size="8" font-weight="bold">AR</text>`
    : `<line x1="33.1" y1="20.8" x2="206.3" y2="134.2" stroke="${D}" stroke-width="2.5"/><text x="200" y="144" fill="${D}" font-size="8" font-weight="bold">AR</text>`;
  const mrLine = lr
    ? `<line x1="32.1" y1="54.7" x2="115.7" y2="148" stroke="${MO}" stroke-width="2"/><text x="112" y="162" fill="${MO}" font-size="8" font-weight="bold">MR</text>`
    : `<line x1="33.7" y1="24.6" x2="131.7" y2="148" stroke="${MO}" stroke-width="2"/><text x="128" y="162" fill="${MO}" font-size="8" font-weight="bold">MR</text>`;
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Q','C/R')}
    <path d="${acPath}" stroke="${LC}" stroke-width="2.5" fill="none"/>
    <text x="201" y="48" fill="${LC}" font-size="8" font-weight="bold">AC</text>
    <path d="${mcPath}" stroke="${S}" stroke-width="2.5" fill="none"/>
    <text x="172" y="30" fill="${S}" font-size="8" font-weight="bold">MC</text>
    ${arLine}
    ${mrLine}
    ${eq}
  </svg>`;
}

function peakPricingD(){
  // Single panel: peak pricing — two demand curves on same axes
  // Off-peak: more elastic AR_op (flatter), lower P2
  // On-peak: more inelastic AR_pk (steeper), higher P1
  // Shared flat MC line
  // MR = MC in each market gives P1 > P2
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${miAx(28,148,212,16,'Output','R/C')}
    <!-- Shared MC flat line -->
    <line x1="28" y1="110" x2="212" y2="110" stroke="${MU}" stroke-width="2"/>
    <text x="214" y="113" fill="${MU}" font-size="7.5" font-weight="bold">MC</text>
    <!-- Off-peak AR: elastic (flatter) -->
    <line x1="32" y1="60" x2="185" y2="136" stroke="${S}" stroke-width="2"/>
    <text x="182" y="148" fill="${S}" font-size="7.5" font-weight="bold">AR_op</text>
    <!-- Off-peak MR: twice as steep, same intercept -->
    <line x1="32" y1="60" x2="108" y2="136" stroke="${S}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="104" y="148" fill="${S}" font-size="7" font-weight="bold">MR_op</text>
    <!-- On-peak AR: inelastic (steeper) -->
    <line x1="108" y1="28" x2="185" y2="136" stroke="${R}" stroke-width="2"/>
    <text x="172" y="30" fill="${R}" font-size="7.5" font-weight="bold">AR_pk</text>
    <!-- On-peak MR: twice as steep -->
    <line x1="108" y1="28" x2="146" y2="136" stroke="${R}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="142" y="148" fill="${R}" font-size="7" font-weight="bold">MR_pk</text>
    <!-- P2: MR_op = MC at x=82, P2=y=85 (verified: MR_op line y=60+1*(82-32)=110=MC ✓) -->
    <line x1="28" y1="85" x2="82" y2="85" stroke="${S}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <text x="16" y="88" fill="${S}" font-size="7">P₂</text>
    <line x1="82" y1="85" x2="82" y2="148" stroke="${S}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="78" y="157" fill="${S}" font-size="7">Q₂</text>
    <!-- P1: MR_pk = MC at x=137, P1=y=69 (verified: MR_pk y=28+2.84*(137-108)=110=MC ✓) -->
    <line x1="28" y1="69" x2="137" y2="69" stroke="${R}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <text x="16" y="72" fill="${R}" font-size="7">P₁</text>
    <line x1="137" y1="69" x2="137" y2="148" stroke="${R}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="133" y="157" fill="${R}" font-size="7">Q₁</text>
    <!-- Equilibrium dots at MR=MC intersections -->
    <circle cx="82" cy="110" r="3" fill="white" stroke="${S}" stroke-width="1.5"/>
    <circle cx="137" cy="110" r="3" fill="white" stroke="${R}" stroke-width="1.5"/>
  </svg>`;
}


function natMonoD(){
  // Coordinates mapped exactly from Natural_Monopoly.svg.
  // AR:   M31.3,69.9  L178.7,146.1
  // MC:   M31.3,75.3  L127.0,148 (clipped at x-axis)
  // LRAC: M32.9,41.7  C54.4,65.4  75.8,89.2  100.4,104.4  C124.8,119.6 152.4,126.3 180.0,132.9
  // LRMC: M32.7,43.9  C44.7,74.2  56.7,104.4  80.7,120.3  C104.9,136.1 141.1,137.5 177.2,138.8
  // P horiz dashed: y=98.2, x=28→86.6. Q vert dashed: x=86.1, y=98.2→148.
  // P1 horiz dashed: y=138.6, x=28→165. Q1 vert dashed: x=163.8, y=138.8→148.
  // SNP rect: x=28.5, y=94.2 (=98.2-4), w=57.5, h=4 (between P and LRAC at Q).
  return `<svg viewBox="0 0 220 168">${miAx(28,148,212,16,'Output','C/R')}
    <!-- SNP rectangle: P above LRAC at Q (thin band) -->
    <rect x="28.5" y="94.2" width="57.5" height="4" fill="rgba(34,197,94,0.5)"/>
    <text x="57" y="92" fill="rgba(21,128,61,0.9)" font-size="6.5" text-anchor="middle">SNP</text>
    <!-- AR: straight downward demand line -->
    <line x1="31.3" y1="69.9" x2="178.7" y2="146.1" stroke="${R}" stroke-width="2.5"/>
    <text x="180" y="146" fill="${R}" font-size="8" font-weight="bold">AR</text>
    <!-- MC: upward sloping, clipped at x-axis -->
    <line x1="31.3" y1="75.3" x2="127.0" y2="148" stroke="${MU}" stroke-width="2"/>
    <text x="140" y="146" fill="${MU}" font-size="8" font-weight="bold">MC</text>
    <!-- LRAC: continuously falling curve -->
    <path d="M32.9 41.7 C54.4 65.4 75.8 89.2 100.4 104.4 C124.8 119.6 152.4 126.3 180.0 132.9" stroke="#d97706" stroke-width="2.5" fill="none"/>
    <text x="174" y="127" fill="#d97706" font-size="8" font-weight="bold">LRAC</text>
    <!-- LRMC: below LRAC, also continuously falling -->
    <path d="M32.7 43.9 C44.7 74.2 56.7 104.4 80.7 120.3 C104.9 136.1 141.1 137.5 177.2 138.8" stroke="#16a34a" stroke-width="2.5" fill="none"/>
    <!-- MR: same intercept as AR, steeper — clips near x-axis -->
    <line x1="31.3" y1="69.9" x2="105" y2="148" stroke="${D}" stroke-width="2"/>
    <text x="103" y="163" fill="${D}" font-size="8" font-weight="bold">MR</text>
    <!-- P and Q: profit-max equilibrium dashed lines -->
    <line x1="28.1" y1="98.2" x2="86.6" y2="98.2" stroke="#4472C4" stroke-width="1.5" stroke-dasharray="4,3"/>
    <line x1="86.1" y1="98.2" x2="86.1" y2="148" stroke="#4472C4" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="17" y="101" fill="${LB}" font-size="7.5" font-weight="bold">P</text>
    <text x="82" y="158" fill="${LB}" font-size="7.5" font-weight="bold">Q</text>
    <!-- P1 and Q1: LRAC pricing equilibrium dashed lines -->
    <line x1="28.1" y1="138.6" x2="165.0" y2="138.6" stroke="#4472C4" stroke-width="1.5" stroke-dasharray="4,3"/>
    <line x1="163.8" y1="138.8" x2="163.8" y2="148" stroke="#4472C4" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="15" y="141" fill="${LB}" font-size="7" font-weight="bold">P1</text>
    <text x="158" y="158" fill="${LB}" font-size="7" font-weight="bold">Q1</text>
    <!-- Equilibrium dots -->
    <circle cx="86.1" cy="98.2" r="3.5" fill="white" stroke="#4472C4" stroke-width="1.5"/>
    <circle cx="163.8" cy="138.6" r="3.5" fill="white" stroke="#4472C4" stroke-width="1.5"/>
  </svg>`;
}


function show(name){
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('v-'+name).classList.add('active');
  document.getElementById('nb-'+name).classList.add('active');
  window.scrollTo(0,0);
}

// ═══════════════════════════════════════════════════════════════

// SHARED CARD RENDERER
// ═══════════════════════════════════════════════════════════════
function renderBank(cards, gridId, seenSet, diagFn, filterCat, searchTerm){
  const grid = document.getElementById(gridId);
  grid.innerHTML = '';
  const term = (searchTerm || '').toLowerCase().trim();
  const toShow = cards.filter(function(c){
    const catOk = filterCat === 'all' || c.category === filterCat;
    const searchOk = !term || c.concept.toLowerCase().includes(term);
    return catOk && searchOk;
  });
  toShow.forEach(card => {
    const wrap = document.createElement('div');
    wrap.className = 'cw cat-' + card.category;
    const fc = document.createElement('div');
    fc.className = 'fc' + (seenSet.has(card.id) ? ' flipped' : '');
    // Diagram placeholder — only render SVG on first flip to avoid memory crash on iOS
    const diagPlaceholder = '<div class="cdiag-ph" style="display:flex;align-items:center;justify-content:center;height:100%;color:#94a3b8;font-size:11px;">Tap to reveal</div>';
    fc.innerHTML =
      '<div class="fc-f">' +
        '<div class="ch"><span class="ccat">' + card.catLabel + '</span><span class="cid">#' + card.id + '</span></div>' +
        '<div class="cdiag">' + diagPlaceholder + '</div>' +
        '<div class="ctit"><h3>' + card.concept + '</h3></div>' +
      '</div>' +
      '<div class="fc-b">' +
        '<div>' +
          '<div class="blbl">Key Concept</div>' +
          '<div class="bcon">' + card.concept + '</div>' +
          '<div class="bexp">' + card.explanation + '</div>' +
        '</div>' +
        '<div class="bkey"><strong>Key Point</strong>' + card.keyPoint + '</div>' +
      '</div>';
    let diagRendered = false;
    fc.addEventListener('click', function(){
      // Render diagram on first interaction
      if (!diagRendered) {
        const diagEl = fc.querySelector('.cdiag');
        if (diagEl) diagEl.innerHTML = diagFn(card);
        diagRendered = true;
      }
      fc.classList.toggle('flipped');
      seenSet.add(card.id);
    });
    wrap.appendChild(fc);
    grid.appendChild(wrap);
  });
}

// ═══════════════════════════════════════════════════════════════
// MACRO ENGINE
// ═══════════════════════════════════════════════════════════════

var miSeen = new Set();
var miFilter = 'all';
var miOrder = miCards.slice();

function miRender(){
  var term = document.getElementById('miSearch') ? document.getElementById('miSearch').value : '';
  renderBank(miOrder, 'miGrid', miSeen, buildMicroDiagram, miFilter, term);
  miStats();
}
function miSearchFn(){
  miRender();
}
function miF(cat, btn){
  miFilter = cat;
  document.querySelectorAll('#v-micro .fbtn').forEach(function(b){b.classList.remove('active');});
  btn.classList.add('active');
  var s = document.getElementById('miSearch'); if(s) s.value = '';
  miRender();
}
function miShuffle(){
  for(var i=miOrder.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=miOrder[i];miOrder[i]=miOrder[j];miOrder[j]=t;}
  miRender();
}
function miReset(){
  miSeen.clear();
  document.querySelectorAll('#miGrid .fc').forEach(function(c){c.classList.remove('flipped');});
  miStats();
}
function miStats(){
  var term = document.getElementById('miSearch') ? document.getElementById('miSearch').value.toLowerCase().trim() : '';
  var visible = miOrder.filter(function(c){
    var catOk = miFilter==='all' || c.category===miFilter;
    var searchOk = !term || c.concept.toLowerCase().includes(term);
    return catOk && searchOk;
  });
  var seen = visible.filter(function(c){return miSeen.has(c.id);}).length;
  document.getElementById('miSeen').textContent = seen;
  document.getElementById('miTotal').textContent = visible.length;
  document.getElementById('miProg').style.width = miOrder.length > 0 ? (miSeen.size/miOrder.length*100)+'%' : '0%';
}

// ═══════════════════════════════════════════════════════════════
// INIT
// ═══════════════════════════════════════════════════════════════
show('home');
maRender();
miRender();

window.addEventListener('DOMContentLoaded',function(){miRender();});
</script>
</body>
</html>