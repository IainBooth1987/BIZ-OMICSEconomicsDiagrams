<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BIZ-OMICS — Macro Diagram Cards</title>
<style>
/* ── SYSTEM FONT STACK — NO EXTERNAL REQUESTS ── */
:root{
  --ff-sans:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;
  --ff-mono:'SFMono-Regular','SF Mono',Consolas,'Liberation Mono',monospace;
  --bg:#0a0e1a;--surface:#111827;--surface2:#0d1526;
  --macro:#3b82f6;--macro2:#60a5fa;
  --micro:#10b981;--micro2:#34d399;
  --amber:#f59e0b;--red:#ef4444;--purple:#8b5cf6;
  --orange:#f97316;--pink:#ec4899;--cyan:#06b6d4;--lime:#84cc16;
  --text:#f1f5f9;--muted:#94a3b8;--border:rgba(255,255,255,0.08);
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:var(--ff-sans);background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;}

/* ── HEADER ── */
header{padding:1.1rem 2.5rem;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);position:sticky;top:0;background:rgba(10,14,26,0.96);backdrop-filter:blur(16px);z-index:200;}
.logo{font-size:1.35rem;font-weight:900;letter-spacing:-0.02em;cursor:pointer;user-select:none;}
.logo span{color:var(--amber);}
.header-nav{display:flex;align-items:center;gap:0.6rem;}
.nav-btn{font-size:0.78rem;padding:0.38rem 0.95rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;transition:all 0.18s;font-family:var(--ff-sans);font-weight:500;}
.nav-btn:hover{color:var(--text);border-color:rgba(255,255,255,0.25);}
.nav-btn#nb-home.active{background:var(--amber);color:#000;border-color:var(--amber);font-weight:700;}
.nav-btn#nb-macro.active{background:var(--macro);color:#fff;border-color:var(--macro);font-weight:700;}
.nav-btn#nb-micro.active{background:var(--micro);color:#000;border-color:var(--micro);font-weight:700;}

/* ── VIEWS ── */
.view{display:block;}
.view.active{display:block;animation:fadein 0.22s ease;}
@keyframes fadein{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:none}}

/* ── HOME ── */
#v-home{max-width:1060px;margin:0 auto;padding:4rem 2rem 3rem;}
.hero{text-align:center;margin-bottom:3rem;}
.hero-eyebrow{font-family:var(--ff-mono);font-size:0.68rem;color:var(--amber);letter-spacing:0.2em;text-transform:uppercase;margin-bottom:1rem;}
.hero h1{font-size:clamp(2rem,4.5vw,3.4rem);font-weight:900;line-height:1.1;letter-spacing:-0.025em;margin-bottom:1rem;}
.hero h1 em{font-style:normal;color:var(--amber);}
.hero-sub{font-size:0.97rem;color:var(--muted);max-width:500px;margin:0 auto;line-height:1.75;}
.boards-row{text-align:center;margin-bottom:2.5rem;}
.boards-label{font-family:var(--ff-mono);font-size:0.64rem;color:var(--muted);letter-spacing:0.12em;text-transform:uppercase;margin-bottom:0.6rem;}
.boards{display:inline-flex;gap:0.45rem;flex-wrap:wrap;justify-content:center;}
.board-tag{font-size:0.74rem;padding:0.25rem 0.7rem;border-radius:100px;background:rgba(255,255,255,0.04);border:1px solid var(--border);color:var(--muted);}
.home-cards{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;}
.hc{position:relative;border-radius:16px;padding:2.1rem 1.9rem 2rem;overflow:hidden;border:1px solid var(--border);cursor:pointer;transition:transform 0.22s,box-shadow 0.22s,border-color 0.22s;}
.hc:hover{transform:translateY(-4px);}
.hc.hc-macro{background:linear-gradient(135deg,rgba(59,130,246,0.09) 0%,#111827 55%);}
.hc.hc-macro:hover{border-color:rgba(59,130,246,0.45);box-shadow:0 18px 50px rgba(59,130,246,0.13);}
.hc.hc-micro{background:linear-gradient(135deg,rgba(16,185,129,0.09) 0%,#111827 55%);}
.hc.hc-micro:hover{border-color:rgba(16,185,129,0.45);box-shadow:0 18px 50px rgba(16,185,129,0.13);}
.hc-glow{position:absolute;top:-50px;right:-50px;width:170px;height:170px;border-radius:50%;opacity:0.1;filter:blur(32px);pointer-events:none;}
.hc-macro .hc-glow{background:var(--macro);}
.hc-micro .hc-glow{background:var(--micro);}
.hc-badge{display:inline-block;font-family:var(--ff-mono);font-size:0.61rem;letter-spacing:0.14em;text-transform:uppercase;padding:0.26rem 0.68rem;border-radius:100px;margin-bottom:1rem;font-weight:500;}
.hc-macro .hc-badge{background:rgba(59,130,246,0.14);color:#60a5fa;border:1px solid rgba(59,130,246,0.25);}
.hc-micro .hc-badge{background:rgba(16,185,129,0.14);color:#34d399;border:1px solid rgba(16,185,129,0.25);}
.hc h2{font-size:1.8rem;font-weight:900;margin-bottom:0.6rem;letter-spacing:-0.02em;}
.hc p{font-size:0.86rem;color:var(--muted);line-height:1.65;margin-bottom:1.4rem;}
.topic-pills{display:flex;flex-wrap:wrap;gap:0.32rem;margin-bottom:1.6rem;}
.pill{font-size:0.68rem;padding:0.2rem 0.52rem;border-radius:100px;background:rgba(255,255,255,0.05);border:1px solid var(--border);color:var(--muted);}
.hc-btn{display:inline-flex;align-items:center;gap:0.4rem;font-size:0.83rem;font-weight:700;padding:0.62rem 1.25rem;border-radius:9px;border:none;cursor:pointer;font-family:var(--ff-sans);}
.hc-macro .hc-btn{background:var(--macro);color:#fff;}
.hc-micro .hc-btn{background:var(--micro);color:#000;}
.hc-count{position:absolute;bottom:2rem;right:1.9rem;font-family:var(--ff-mono);font-size:0.63rem;color:var(--muted);opacity:0.5;}
.home-footer{text-align:center;margin-top:2.5rem;font-family:var(--ff-mono);font-size:0.72rem;color:var(--muted);opacity:0.4;}

/* ── BANK VIEWS ── */
.progress-bar{height:3px;background:var(--border);}
.prog-fill{height:100%;transition:width 0.4s ease;width:0%;}
#v-macro .prog-fill{background:linear-gradient(90deg,var(--macro2),var(--macro));}
#v-micro .prog-fill{background:linear-gradient(90deg,var(--micro2),var(--micro));}
.bank-wrap{padding:1.6rem 2.5rem;max-width:1500px;margin:0 auto;}
.controls{display:flex;gap:0.5rem;margin-bottom:1.6rem;flex-wrap:wrap;align-items:center;padding:0.85rem 1.1rem;background:rgba(255,255,255,0.03);border-radius:11px;border:1px solid var(--border);}
.filter-label{font-family:var(--ff-mono);font-size:0.64rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.12em;white-space:nowrap;}
.fbtn{padding:0.33rem 0.8rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--muted);font-family:var(--ff-sans);font-size:0.75rem;font-weight:500;cursor:pointer;transition:all 0.16s;white-space:nowrap;}
.fbtn:hover{color:var(--text);border-color:rgba(255,255,255,0.25);}
#v-macro .fbtn.active{background:var(--macro);color:#fff;border-color:var(--macro);}
#v-micro .fbtn.active{background:var(--micro);color:#000;border-color:var(--micro);}
.div{width:1px;height:20px;background:var(--border);}
.stats{display:flex;gap:0.85rem;}
.stat{display:flex;flex-direction:column;align-items:center;}
.stat-n{font-family:var(--ff-mono);font-size:1rem;font-weight:700;}
#v-macro .stat-n{color:var(--macro);}
#v-micro .stat-n{color:var(--micro);}
.stat-l{font-size:0.58rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.1em;}
.btn-g{padding:0.33rem 0.8rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:0.75rem;cursor:pointer;font-family:var(--ff-sans);}
.btn-g:hover{color:var(--text);}
.search-wrap{position:relative;display:flex;align-items:center;}
.search-wrap svg{position:absolute;left:0.55rem;width:13px;height:13px;pointer-events:none;color:var(--muted);}
.search-input{padding:0.33rem 0.8rem 0.33rem 1.9rem;border-radius:100px;border:1px solid var(--border);background:transparent;color:var(--text);font-family:var(--ff-sans);font-size:0.75rem;width:160px;outline:none;transition:border-color 0.16s,width 0.22s;}
.search-input::placeholder{color:var(--muted);}
.search-input:focus{border-color:rgba(255,255,255,0.3);width:200px;}
#v-macro .search-input:focus{border-color:var(--macro);}
#v-micro .search-input:focus{border-color:var(--micro);}
.btn-p{padding:0.33rem 0.92rem;border-radius:100px;border:none;font-size:0.75rem;font-weight:700;cursor:pointer;font-family:var(--ff-sans);}
#v-macro .btn-p{background:var(--macro);color:#fff;}
#v-micro .btn-p{background:var(--micro);color:#000;}

/* ── CARD GRID ── */
.card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.25rem;}
.cw{perspective:1200px;}
.fc{width:100%;aspect-ratio:3/4;position:relative;transform-style:preserve-3d;transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);cursor:pointer;border-radius:14px;}
.fc.flipped{transform:rotateY(180deg);}
.fc-f,.fc-b{position:absolute;inset:0;backface-visibility:hidden;border-radius:14px;display:flex;flex-direction:column;}
.fc-f{border:1px solid var(--border);overflow:hidden;}
.fc-f::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
.fc-b{transform:rotateY(180deg);padding:1.2rem 1.3rem;justify-content:space-between;overflow:auto;}
#v-macro .fc-f{background:#0d1526;}
#v-macro .fc-b{background:#0a1020;border:1px solid rgba(59,130,246,0.16);}
#v-micro .fc-f{background:#0f1f14;}
#v-micro .fc-b{background:#0a2010;border:1px solid rgba(16,185,129,0.16);}
.ch{padding:0.75rem 0.9rem 0.4rem;display:flex;justify-content:space-between;}
.ccat{font-family:var(--ff-mono);font-size:0.58rem;letter-spacing:0.12em;text-transform:uppercase;font-weight:600;}
.cid{font-family:var(--ff-mono);font-size:0.58rem;color:rgba(255,255,255,0.16);}
.cdiag{flex:1;display:flex;align-items:center;justify-content:center;padding:0.2rem 0.5rem;min-height:0;}
.cdiag svg{max-width:100%;height:auto;min-height:165px;}
.ctit{padding:0.4rem 0.9rem 0.75rem;}
.ctit h3{font-size:0.86rem;font-weight:600;line-height:1.3;}
.blbl{font-family:var(--ff-mono);font-size:0.56rem;letter-spacing:0.15em;text-transform:uppercase;margin-bottom:0.4rem;opacity:0.65;}
#v-macro .blbl{color:var(--macro);}
#v-micro .blbl{color:var(--micro);}
.bcon{font-size:1rem;font-weight:800;margin-bottom:0.55rem;line-height:1.25;}
.bexp{font-size:0.76rem;color:var(--muted);line-height:1.55;margin-bottom:0.55rem;flex:1;}
.bkey{border-radius:7px;padding:0.55rem 0.7rem;font-size:0.72rem;line-height:1.5;}
#v-macro .bkey{background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.2);color:var(--macro2);}
#v-micro .bkey{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.2);color:var(--micro2);}
.bkey strong{display:block;font-size:0.58rem;font-family:var(--ff-mono);letter-spacing:0.1em;text-transform:uppercase;margin-bottom:0.15rem;}
#v-macro .bkey strong{color:var(--macro);}
#v-micro .bkey strong{color:var(--micro);}
.hidden{display:none!important;}

/* ── MACRO CATEGORY COLOURS ── */
.cat-ppf .fc-f::before{background:linear-gradient(90deg,#06b6d4,#3b82f6);}
.cat-ppf .ccat{color:#06b6d4;}
.cat-adas .fc-f::before{background:linear-gradient(90deg,#3b82f6,#6366f1);}
.cat-adas .ccat{color:#3b82f6;}
.cat-inflation .fc-f::before{background:linear-gradient(90deg,#ef4444,#f97316);}
.cat-inflation .ccat{color:#ef4444;}
.cat-deflation .fc-f::before{background:linear-gradient(90deg,#06b6d4,#3b82f6);}
.cat-deflation .ccat{color:#06b6d4;}
.cat-unemployment .fc-f::before{background:linear-gradient(90deg,#8b5cf6,#6366f1);}
.cat-unemployment .ccat{color:#8b5cf6;}
.cat-growth .fc-f::before{background:linear-gradient(90deg,#10b981,#06b6d4);}
.cat-growth .ccat{color:#10b981;}
.cat-fiscal .fc-f::before{background:linear-gradient(90deg,#f59e0b,#eab308);}
.cat-fiscal .ccat{color:#f59e0b;}
.cat-monetary .fc-f::before{background:linear-gradient(90deg,#ec4899,#8b5cf6);}
.cat-monetary .ccat{color:#ec4899;}
.cat-exchange .fc-f::before{background:linear-gradient(90deg,#d946ef,#8b5cf6);}
.cat-exchange .ccat{color:#d946ef;}
.cat-trade .fc-f::before{background:linear-gradient(90deg,#f97316,#ef4444);}
.cat-trade .ccat{color:#f97316;}
.cat-tax .fc-f::before{background:linear-gradient(90deg,#84cc16,#10b981);}
.cat-tax .ccat{color:#84cc16;}
/* ── MICRO CATEGORY COLOURS ── */
.cat-markets .fc-f::before{background:linear-gradient(90deg,#10b981,#34d399);}
.cat-markets .ccat{color:#10b981;}
.cat-elasticity .fc-f::before{background:linear-gradient(90deg,#3b82f6,#60a5fa);}
.cat-elasticity .ccat{color:#60a5fa;}
.cat-surplus .fc-f::before{background:linear-gradient(90deg,#f59e0b,#fbbf24);}
.cat-surplus .ccat{color:#f59e0b;}
.cat-failure .fc-f::before{background:linear-gradient(90deg,#ef4444,#f87171);}
.cat-failure .ccat{color:#ef4444;}
.cat-labour .fc-f::before{background:linear-gradient(90deg,#8b5cf6,#a78bfa);}
.cat-labour .ccat{color:#a78bfa;}
.cat-costs .fc-f::before{background:linear-gradient(90deg,#ec4899,#f472b6);}
.cat-costs .ccat{color:#ec4899;}
.cat-structures .fc-f::before{background:linear-gradient(90deg,#06b6d4,#22d3ee);}
.cat-structures .ccat{color:#06b6d4;}
.cat-intervention .fc-f::before{background:linear-gradient(90deg,#84cc16,#a3e635);}
.cat-intervention .ccat{color:#84cc16;}

@media(max-width:700px){
  header{padding:0.85rem 1.1rem;}
  .home-cards{grid-template-columns:1fr;}
  #v-home{padding:2.5rem 1.1rem 2rem;}
  .bank-wrap{padding:1rem 1.1rem;}
  .stats{display:none;}
}
</style>
<style>a.nav-btn{text-decoration:none;} span.nav-btn.active{opacity:1;font-weight:700;cursor:default;}</style>
</head>
<body>
<header>
  <div class="logo">BIZ-<span>OMICS</span></div>
  <div class="header-nav">
    <a class="nav-btn" href="index.html">Home</a>
    <span class="nav-btn active">&#x25B8; Macro</span>
    <a class="nav-btn" href="micro.html">&#x25B8; Micro</a>
  </div>
</header>
<!-- ═══ MACRO ═══ -->
<div class="view" id="v-macro">
  <div class="progress-bar"><div class="prog-fill" id="maProg"></div></div>
  <div class="bank-wrap">

    <div class="controls">
      <span class="filter-label">Topic:</span>
      <button class="fbtn active" onclick="maF('all',this)">All</button>
      <button class="fbtn" onclick="maF('framework',this)">Macro Framework</button>
      <button class="fbtn" onclick="maF('adas',this)">AD/AS</button>
      <button class="fbtn" onclick="maF('inflation',this)">Inflation &amp; Deflation</button>
      <button class="fbtn" onclick="maF('unemployment',this)">Unemployment</button>
      <button class="fbtn" onclick="maF('growth',this)">Economic Growth</button>
      <div class="div"></div>
      <button class="fbtn" onclick="maF('fiscal',this)">Fiscal Policy</button>
      <button class="fbtn" onclick="maF('monetary',this)">Monetary Policy</button>
      <button class="fbtn" onclick="maF('exchange',this)">Exchange Rates</button>
      <button class="fbtn" onclick="maF('trade',this)">Trade Theory &amp; Policy</button>
      <button class="fbtn" onclick="maF('inequality',this)">Inequality</button>
      <div class="stats">
        <div class="stat"><span class="stat-n" id="maSeen">0</span><span class="stat-l">Seen</span></div>
        <div class="stat"><span class="stat-n" id="maTotal">0</span><span class="stat-l">Total</span></div>
      </div>
      <div class="search-wrap">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input class="search-input" id="maSearch" type="text" placeholder="Search diagrams…" oninput="maSearchFn()" autocomplete="off"/>
      </div>
      <button class="btn-g" onclick="maReset()">Reset</button>
      <button class="btn-p" onclick="maShuffle()">&#x21BA; Shuffle</button>
    </div>
    <div id="maGrid" class="card-grid"></div>
  </div>
</div>
<script>

// ═══ MACRO: COLOUR CONSTANTS + SVG FUNCTIONS ═══
function buildDiagram(card) {
  const dt = card.diagramType, sh = card.shift;
  if (dt==='adAs') return adAsDiagram(sh);
  if (dt==='ppf') return ppfDiagram(sh);
  if (dt==='phillips') return phillipsDiagram();
  if (dt==='lrPhillips') return lrPhillipsDiagram();
  if (dt==='supplySidePhillips') return supplySidePhillipsDiagram();
  if (dt==='ajLfLabour') return ajLfLabourDiagram();
  if (dt==='ajShiftRight') return ajShiftRightDiagram();
  if (dt==='dlShiftLeft') return dlShiftLeftDiagram();
  if (dt==='keynesianUnemployment') return keynesianUnemploymentDiagram();
  if (dt==='keynesian') return keynesianDiagram();
  if (dt==='classicalUnemployment') return classicalUnemploymentDiagram();
  if (dt==='economicCycle') return economicCycleDiagram();
  if (dt==='harrodDomar') return harrodDomarDiagram();
  if (dt==='laffer') return lafferDiagram();
  if (dt==='balancedBudget') return balancedBudgetDiagram();
  if (dt==='transmission') return transmissionDiagram();
  if (dt==='moneySD') return moneySDDiagram();
  if (dt==='qe') return qeDiagram();
  if (dt==='qt') return qtDiagram();
  if (dt==='liquidityTrap') return liquidityTrapDiagram();
  if (dt==='floatingXR') return floatingXRDiagram();
  if (dt==='fixedXR') return fixedXRDiagram();
  if (dt==='managedXR') return managedXRDiagram();
  if (dt==='jcurve') return jcurveDiagram();
  if (dt==='tariff') return tariffDiagram();
  if (dt==='compAdv') return compAdvDiagram();
  if (dt==='cpf')         return cpfDiagram();
  if (dt==='compAdvGrid') return compAdvGridDiagram();
  if (dt==='tradeCreation') return tradeCreationDiagram();
  if (dt==='prefTradeAgreement') return prefTradeAgreementDiagram();
  if (dt==='tradeDiversion') return tradeDiversionDiagram();
  if (dt==='lorenz') return lorenzDiagram();
  if (dt==='kuznetsCurve') return kuznetsCurveD();
  if (dt==='adAsPhillips') return adAsPhillipsDiagram();
  if (dt==='circularFlow') return circularFlowDiagram();
  if (dt==='demandPull') return demandPullDiagram();
  if (dt==='multiplierPos') return multiplierPosDiagram();
  if (dt==='multiplierNeg') return multiplierNegDiagram();
  if (dt==='crowdingOut') return crowdingOutDiagram();
  if (dt==='expFiscalKeynesian') return expFiscalKeynesianDiagram();
  if (dt==='benignDeflation') return benignDeflationDiagram();
  if (dt==='classicalLrasRight') return classicalLrasRightDiagram();
  if (dt==='classicalLrasLeft') return classicalLrasLeftDiagram();
  return '';
}

const C = { ad:'#3b82f6', sras:'#f59e0b', lras:'#10b981', new:'#ef4444', muted:'#475569', label:'#64748b', purple:'#8b5cf6', pink:'#ec4899', teal:'#06b6d4' };

function axes(x1,y1,x2,y2,xLabel,yLabel,vb='0 0 230 175') {
  return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y1}" stroke="${C.muted}" stroke-width="1.5"/>
  <line x1="${x1}" y1="${y1}" x2="${x1}" y2="${y2}" stroke="${C.muted}" stroke-width="1.5"/>
  <text x="${x2+3}" y="${y1+3}" fill="${C.label}" font-size="8">${xLabel}</text>
  <text x="${x1-4}" y="${y2-2}" fill="${C.label}" font-size="8">${yLabel}</text>`;
}

function arrowDef(id, color) {
  return `<marker id="${id}" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L6,3 Z" fill="${color}"/></marker>`;
}

function adAsDiagram(shift) {
  let extra='', lrasX=148, eqX=119, eqY=97, hideBaseAD=false, hideSRAS=false, hideLRAS=false;
  const ad='M 55 35 L 185 155', sras='M 55 155 L 175 38';

  if (shift==='adRight') {
    // Exact from AD_shifts_right.svg. 2425×1848, group translate(-668,-313), axes origin(1041,1864).
    // SRAS: (57.3,144.6)→(158.6,28.5). 
    // AD1 ORIGINAL: (60.3,21.3)→(187.7,137.4). AD2 SHIFTED RIGHT: (40.8,34.1)→(168.2,150.2).
    // P1 y=91.8 (SRAS∩AD1 at x=103.7). P2 y=74.6 (SRAS∩AD2 at x=118.6).
    // Y1 x=103.0, Y2 x=119.2. Labels: AD1 at (170.8,154), AD2 at (188,134).
    eqX=103.7; eqY=91.4; lrasX=56; hideBaseAD=true; hideSRAS=true;
    extra=`
    <!-- SRAS (exact from SVG) -->
    <path d="M 57.3 144.6 L 158.6 28.5" stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="161" y="27" fill="${C.sras}" font-size="9" font-weight="bold">SRAS</text>
    <!-- AD1 ORIGINAL — lower line (exact from SVG: label at bottom right of this line) -->
    <path d="M 60.3 21.3 L 187.7 137.4" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="172" y="154" fill="${C.ad}" font-size="9" font-weight="bold">AD₁</text>
    <!-- AD2 SHIFTED RIGHT — higher line (exact from SVG: label at upper right) -->
    <path d="M 40.8 34.1 L 168.2 150.2" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="153" y="152" fill="${C.new}" font-size="9" font-weight="bold">AD₂</text>
    <!-- P1 guide: y=91.8 (SRAS∩AD1, original equilibrium) -->
    <line x1="28" y1="91.8" x2="103.7" y2="91.8" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="94.8" fill="${C.label}" font-size="7">P₁</text>
    <!-- P2 guide: y=74.6 (SRAS∩AD2, higher price after shift) -->
    <line x1="28" y1="74.6" x2="118.6" y2="74.6" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="77.6" fill="${C.new}" font-size="7">P₂</text>
    <!-- Y1 vert: x=103.0 -->
    <line x1="103.0" y1="91.8" x2="103.0" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <!-- Y2 vert: x=119.2 -->
    <line x1="119.2" y1="74.6" x2="119.2" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="99" y="168" fill="${C.label}" font-size="7">Y₁</text>
    <text x="115" y="168" fill="${C.new}" font-size="7">Y₂</text>
    <!-- Equilibrium circles -->
    <circle cx="103.7" cy="91.4" r="3.5" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
    <circle cx="118.6" cy="74.4" r="3.5" fill="${C.new}" opacity="0.9"/>`;
  } else if (shift==='adLeft') {
    extra=`<path d="M 30 35 L 160 155" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="162" y="152" fill="${C.new}" font-size="9" font-weight="bold">AD₂</text>
    <!-- Original equilibrium: AD1∩SRAS at (118,93) -->
    <circle cx="118" cy="93" r="3.5" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
    <line x1="28" y1="93" x2="118" y2="93" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="96" fill="${C.label}" font-size="7">P₁</text>
    <line x1="118" y1="93" x2="118" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="114" y="168" fill="${C.label}" font-size="7">Y₁</text>
    <!-- New equilibrium: AD2∩SRAS at (106,105) -->
    <line x1="119" y1="97" x2="108" y2="103" stroke="${C.new}" stroke-width="1.5" marker-end="url(#arw)"/>
    <circle cx="106" cy="105" r="3.5" fill="${C.new}" opacity="0.9"/>
    <line x1="28" y1="105" x2="106" y2="105" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="108" fill="${C.new}" font-size="7">P₂</text>
    <line x1="106" y1="105" x2="106" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="102" y="168" fill="${C.new}" font-size="7">Y₂</text>`;
  } else if (shift==='asLeft') {
    // Exact from Cost_Push_Inflation.svg. 2482×1826, axes origin(1041,1864).
    // SRAS1: (57.3,144.6)→(181.7,62.4) [same as AD_shifts]. SRAS2 shifted LEFT: (44.7,136.2)→(172.4,42.9).
    // AD: (40.8,34.1)→(168.2,150.2). P1 y=92.1 at Y1=104.0. P2 y=106.3 at Y2=120.6.
    // SRAS1∩AD=(120.3,106.5). SRAS2∩AD=(104.8,92.4).
    eqX=118.0; eqY=104.5; lrasX=148; hideBaseAD=true; hideSRAS=true;
    extra=`
    <!-- AD (exact from SVG) -->
    <path d="M 40.8 34.1 L 168.2 150.2" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="164" y="154" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- SRAS1 original (exact from SVG) -->
    <path d="M 57.3 144.6 L 181.7 62.4" stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="183" y="61" fill="${C.sras}" font-size="9" font-weight="bold">SRAS₁</text>
    <!-- SRAS2 shifted LEFT — cost-push (exact from SVG) -->
    <path d="M 44.7 136.2 L 172.4 42.9" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="168" y="41" fill="${C.new}" font-size="9" font-weight="bold">SRAS₂</text>
    <!-- P1 guide: y=92.1 (SRAS1∩AD) -->
    <line x1="28" y1="104.5" x2="118.0" y2="104.5" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="107.5" fill="${C.label}" font-size="7">P₁</text>
    <!-- P2 guide: y=106.3 (SRAS2∩AD, higher price) -->
    <line x1="28" y1="92.4" x2="104.7" y2="92.4" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="95.4" fill="${C.new}" font-size="7">P₂</text>
    <!-- Y1 vert: x=120.6 -->
    <line x1="118.0" y1="104.5" x2="118.0" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="116" y="168" fill="${C.label}" font-size="7">Y₁</text>
    <!-- Y2 vert: x=104.8 (lower output after cost push) -->
    <line x1="104.7" y1="92.4" x2="104.7" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="100" y="168" fill="${C.new}" font-size="7">Y₂</text>
    <!-- Equilibrium circles -->
    <circle cx="118.0" cy="104.5" r="3.5" fill="white" stroke="${C.sras}" stroke-width="1.5"/>
    <circle cx="104.7" cy="92.4" r="3.5" fill="${C.new}" opacity="0.9"/>`;
  } else if (shift==='srasRight') {
    extra=`<path d="M 85 155 L 205 38" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="207" y="36" fill="${C.new}" font-size="9" font-weight="bold">SRAS₂</text>
    <!-- Original equilibrium: SRAS1∩AD at (118,93) -->
    <circle cx="118" cy="93" r="3.5" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
    <line x1="28" y1="93" x2="118" y2="93" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="96" fill="${C.label}" font-size="7">P₁</text>
    <line x1="118" y1="93" x2="118" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="114" y="168" fill="${C.label}" font-size="7">Y₁</text>
    <!-- New equilibrium: SRAS2∩AD at (134,108) -->
    <circle cx="134" cy="108" r="3.5" fill="${C.new}" opacity="0.9"/>
    <line x1="28" y1="108" x2="134" y2="108" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="111" fill="${C.new}" font-size="7">P₂</text>
    <line x1="134" y1="108" x2="134" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="130" y="168" fill="${C.new}" font-size="7">Y₂</text>
    <line x1="119" y1="97" x2="132" y2="106" stroke="${C.new}" stroke-width="1.5" marker-end="url(#arw)"/>`;
  } else if (shift==='lrasRight') {
    // Exact from LRAS_Shifts_Right.svg. 2468×1745, axes origin(1041,1864).
    // LRAS1 x=125.7 (x=2079). LRAS2 x=150.9 (x=2346). AD: (40.8,34.1)→(168.2,150.2).
    // LRAS1∩AD: (125.7,111.4). LRAS2∩AD: (150.9,134.3).
    // H-arrows LRAS1→LRAS2 at y=60.6 and y=79.6.
    // P1 y=112.0 (higher price before shift). P2 y=134.8 (lower after shift, more capacity).
    eqX=125.7; eqY=111.4; lrasX=125.7; hideBaseAD=true; hideSRAS=true;
    extra=`
    <!-- AD (exact from SVG) -->
    <path d="M 40.8 34.1 L 168.2 150.2" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="164" y="154" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- LRAS2 (new position, x=150.9) -->
    <line x1="150.9" y1="18" x2="150.9" y2="162" stroke="${C.new}" stroke-width="2.5" stroke-dasharray="7,4"/>
    <text x="145" y="16" fill="${C.new}" font-size="8" font-weight="bold">LRAS₂</text>
    <!-- Arrows LRAS1→LRAS2 (exact from SVG at y=60.6 and y=79.6) -->
    <line x1="127.4" y1="60.6" x2="148.4" y2="60.6" stroke="${C.new}" stroke-width="1.5" marker-end="url(#arw)"/>
    <line x1="127.4" y1="79.6" x2="148.4" y2="79.6" stroke="${C.new}" stroke-width="1.5" marker-end="url(#arw)"/>
    <!-- P1: LRAS1∩AD at y=112.0 -->
    <circle cx="125.7" cy="111.4" r="3.5" fill="white" stroke="${C.lras}" stroke-width="1.5"/>
    <line x1="28" y1="112.0" x2="125.7" y2="112.0" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="115" fill="${C.label}" font-size="7">P₁</text>
    <!-- P2: LRAS2∩AD at y=134.8 (lower price = more productive capacity) -->
    <circle cx="150.9" cy="134.3" r="3.5" fill="${C.new}"/>
    <line x1="28" y1="134.8" x2="150.9" y2="134.8" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="137.8" fill="${C.new}" font-size="7">P₂</text>
    <!-- Y labels -->
    <text x="121" y="168" fill="${C.label}" font-size="7">Y₁</text>
    <text x="146.9" y="168" fill="${C.new}" font-size="7">Y₂</text>`;
  } else if (shift==='lrasLeft') {
    // LRAS2 at x=118 (leftward shift from x=148 = decline in productive capacity)
    // New eq where AD intersects LRAS2. AD: M55,35 L185,155. At x=118:
    //   t=(118-55)/(185-55)=63/130=0.485, y=35+120*0.485=93.2≈93. Dot at (118,93) ✓
    extra=`<line x1="118" y1="28" x2="118" y2="162" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="120" y="170" fill="${C.new}" font-size="9" font-weight="bold">LRAS₂</text>
    <circle cx="118" cy="93" r="3.5" fill="${C.new}" opacity="0.9"/>
    <line x1="28" y1="93" x2="118" y2="93" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2" opacity="0.7"/>
    <text x="18" y="96" fill="${C.new}" font-size="7">P₂</text>`;
  } else if (shift==='bothRight') {
    // INTERVENTIONIST SUPPLY-SIDE: Govt spending → AD right. Supply-side reform → LRAS right.
    // No SRAS shown — diagram focuses purely on AD and LRAS shifts.
    // When AD and LRAS shift right by the SAME amount, the LR price level is UNCHANGED.
    // Design: LRAS1 at x=100. AD1 through (100,90). Both shift right by 50px.
    //   LRAS2 at x=150. AD2 through (150,90). Both equilibria at y=90 — SAME PRICE ✓
    //   AD1: M28,24 L178,162. AD2: M78,24 L210,145. (parallel shift, slope=0.923)
    //   Verify AD1 at x=100: y=24+138/150*72=90.2≈90 ✓
    //   Verify AD2 at x=150: AD2(150)=AD1(100)=90 ✓ (shifted curve, same slope)
    eqX=100; eqY=90; lrasX=100; hideBaseAD=true; hideSRAS=true;
    extra=`
    <!-- AD1 through (100,90) — original aggregate demand -->
    <path d="M 28 24 L 178 162" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="180" y="162" fill="${C.ad}" font-size="9" font-weight="bold">AD₁</text>
    <!-- AD2: parallel shift of AD1 right by 50px — through (150,90) -->
    <path d="M 78 24 L 210 145" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="205" y="143" fill="${C.new}" font-size="9" font-weight="bold">AD₂</text>
    <!-- LRAS2 at x=150 (50px right of LRAS1) -->
    <line x1="150" y1="28" x2="150" y2="162" stroke="${C.lras}" stroke-width="2.5" stroke-dasharray="7,4"/>
    <text x="152" y="26" fill="${C.lras}" font-size="9" font-weight="bold">LRAS₂</text>
    <!-- Original eq: AD1 ∩ LRAS1 at (100,90) -->
    <circle cx="100" cy="90" r="4" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
    <!-- New eq: AD2 ∩ LRAS2 at (150,90) — SAME price level -->
    <circle cx="150" cy="90" r="4" fill="${C.lras}"/>
    <!-- Horizontal dashed line at y=90: visual proof both equilibria are at same price -->
    <line x1="28" y1="90" x2="155" y2="90" stroke="${C.lras}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="20" y="93" fill="${C.lras}" font-size="7.5">P*</text>
    <!-- Bracket showing equal rightward shift of both LRAS and AD -->
    <line x1="100" y1="155" x2="150" y2="155" stroke="${C.lras}" stroke-width="2"/>
    <line x1="100" y1="151" x2="100" y2="159" stroke="${C.lras}" stroke-width="1.5"/>
    <line x1="150" y1="151" x2="150" y2="159" stroke="${C.lras}" stroke-width="1.5"/>
    <text x="125" y="170" fill="${C.lras}" font-size="7" text-anchor="middle">↑ Y*</text>
    <text x="110" y="16" fill="${C.label}" font-size="6.5" text-anchor="middle">AD and LRAS shift equally → ↑Y* with no inflationary pressure</text>`;
  } else if (shift==='lrasOnly') {
    // BENIGN DEFLATION: productivity gains shift SRAS and LRAS right. AD unchanged.
    // Base SRAS: M55,155 L175,38. Base AD: M55,35 L185,155.
    // Set LRAS1 at x=119 so initial eq (SRAS∩AD∩LRAS1) all meet cleanly at ~(119,97).
    // SRAS∩AD: slope_sras=-0.975, slope_ad=+0.923. Solve: gives x=118.2, y=93.4 ≈ (119,93).
    // SRAS2: parallel right shift by 29px → M84,155 L204,38.
    //   At x=133: y=155-(117/120)*(133-84)=107.3≈107 ✓ (SRAS2 passes through (133,107))
    //   At x=133 on AD: t=0.6, y=35+72=107 ✓ → SRAS2∩AD = (133,107)
    // LRAS2 at x=133: all three (SRAS2, AD, LRAS2) meet at (133,107) — clean ✓
    // New eq LOWER price (y=107>93 in SVG means further DOWN = LOWER price level) ✓
    lrasX=119; eqX=119; eqY=93;
    extra=`
    <!-- SRAS2: parallel right shift of SRAS by 29px — passes exactly through (133,107) -->
    <path d="M 84 155 L 204 38" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="200" y="36" fill="${C.new}" font-size="9" font-weight="bold">SRAS₂</text>
    <!-- LRAS2 at x=133: aligns with SRAS2∩AD intersection (all three meet here) -->
    <line x1="133" y1="28" x2="133" y2="162" stroke="${C.new}" stroke-width="2.5" stroke-dasharray="7,4"/>
    <text x="135" y="26" fill="${C.new}" font-size="9" font-weight="bold">LRAS₂</text>
    <!-- Original eq dashed guides (faint) -->
    <line x1="28" y1="93" x2="119" y2="93" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2" opacity="0.5"/>
    <text x="19" y="96" fill="${C.muted}" font-size="7" opacity="0.7">P₁</text>
    <text x="115" y="172" fill="${C.muted}" font-size="7" opacity="0.7">Y₁</text>
    <!-- New eq at (133,107): LOWER price (further down the P-axis), MORE output -->
    <circle cx="133" cy="107" r="4" fill="${C.new}"/>
    <line x1="28" y1="107" x2="133" y2="107" stroke="${C.new}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <line x1="133" y1="107" x2="133" y2="162" stroke="${C.new}" stroke-width="1.2" stroke-dasharray="3,2"/>
    <text x="19" y="110" fill="${C.new}" font-size="7">P₂</text>
    <text x="129" y="172" fill="${C.new}" font-size="7">Y₂</text>
    <text x="55" y="22" fill="${C.new}" font-size="7">Productivity ↑ → SRAS and LRAS shift right → ↑Y, ↓P</text>`;
  } else if (shift==='lrasVertical') {
    // Exact from Long_run_Classical_Market_Equilibrium.svg. 2482×1826, axes origin(1041,1864).
    // LRAS: x=125.7 (x=2079). AD: (65.7,22.2)→(187.7,131.9). SRAS: (44.7,136.2)→(172.4,42.9).
    // All three intersect at (125.7,76.2). P1 y=76.3.
    eqX=125.7; eqY=76.2; lrasX=125.7; hideBaseAD=true; hideSRAS=true;
    extra=`
    <!-- AD (exact from SVG) -->
    <path d="M 65.7 22.2 L 187.7 131.9" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="183" y="133" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- SRAS (exact from SVG, straight line — meets AD and LRAS at Y*) -->
    <path d="M 44.7 136.2 L 172.4 42.9" stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="168" y="41" fill="${C.sras}" font-size="9" font-weight="bold">SRAS</text>
    <!-- P1 level (all three curves intersect at y=76.2) -->
    <line x1="28" y1="76.2" x2="125.7" y2="76.2" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="79.2" fill="${C.label}" font-size="7">P₁</text>
    <line x1="125.7" y1="76.2" x2="125.7" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="121.7" y="169" fill="${C.label}" font-size="7">Y*</text>
    <!-- Equilibrium point where LRAS=SRAS=AD -->
    <circle cx="125.7" cy="76.2" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>`;
  } else if (shift==='positiveGap') {
    // ECONOMICS CHECK:
    // - Economy producing ABOVE potential: Y1 > Yfe
    // - LRAS vertical at Yfe (potential output)
    // - SRAS upward sloping
    // - AD intersects SRAS to the RIGHT of LRAS → this is the equilibrium
    // - Equilibrium dot at AD∩SRAS only. NO dot on LRAS.
    // - P1 above where AD meets LRAS (inflationary pressure)
    // - Positive gap shown between Yfe and Y1 on x-axis
    //
    // ALL coordinates solved in Python, intersection verified to 0.000000 error:
    //   LRAS: x=125
    //   SRAS: (45,155)→(210,38), slope=-0.7091, b=186.91
    //   AD:   (49,18)→(220,100), slope=0.48, b=-5.72
    //   AD∩SRAS at x=162: SRAS_y=72.04, AD_y=72.04 ✓
    //   Equilibrium dot: (162, 72)
    hideBaseAD=true; hideSRAS=true; hideLRAS=true; lrasX=-100; eqX=-100; eqY=999;
    extra=`
    <!-- LRAS: solid vertical at x=125 (potential output Yfe) -->
    <line x1="125" y1="18" x2="125" y2="162" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="128" y="16" fill="${C.lras}" font-size="9" font-weight="bold">LRAS</text>
    <!-- SRAS: (45,155)→(210,38) upward sloping -->
    <line x1="45" y1="155" x2="210" y2="38" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="206" y="35" fill="${C.sras}" font-size="9" font-weight="bold">SRAS</text>
    <!-- AD: (49,18)→(220,100) intersects SRAS at (162,72) which is RIGHT of LRAS -->
    <line x1="49" y1="18" x2="220" y2="100" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="210" y="110" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- Equilibrium dot at AD∩SRAS = (162,72). NOT on LRAS. -->
    <circle cx="162" cy="72" r="4" fill="${C.ad}"/>
    <!-- P1: horizontal dashed guide from y-axis to equilibrium -->
    <line x1="28" y1="72" x2="162" y2="72" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="75" fill="${C.label}" font-size="7.5" font-weight="bold">P1</text>
    <!-- Yfe: dashed vertical from equilibrium height down to x-axis, below LRAS -->
    <line x1="125" y1="72" x2="125" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="118" y="170" fill="${C.label}" font-size="7.5" font-weight="bold">Yfe</text>
    <!-- Y1: dashed vertical from equilibrium down to x-axis -->
    <line x1="162" y1="72" x2="162" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="157" y="170" fill="${C.label}" font-size="7.5" font-weight="bold">Y1</text>
    <!-- Positive output gap bracket between Yfe and Y1 -->
    <line x1="125" y1="174" x2="162" y2="174" stroke="${C.new}" stroke-width="2"/>
    <line x1="125" y1="170" x2="125" y2="178" stroke="${C.new}" stroke-width="1.5"/>
    <line x1="162" y1="170" x2="162" y2="178" stroke="${C.new}" stroke-width="1.5"/>`;
  } else if (shift==='negativeGap') {
    // Exact from Negative_Output_Gap.svg. 1802×1626, group translate(-2404,-559).
    // Axes: origin(2637,1954), right=3629, top=755.
    // LRAS: x=146.8. SRAS: (47.6,137.7)→(215,31.0) clipped.
    // AD1 ORIGINAL: (68.9,32.3)→(215,117.9) clipped. AD2 SHIFTED LEFT: (35.5,45.4)→(215,150.5) clipped.
    // Label positions: AD2 at (240,160)=lower right. P1 y=77.5, P2 y=92.6.
    // Y1 x=146.8 (at LRAS). Y2 x=117.7 (AD2∩SRAS, below LRAS = negative gap).
    eqX=146.8; eqY=77.9; lrasX=146.8; hideBaseAD=true; hideSRAS=true;
    extra=`
    <!-- SRAS (exact from SVG, clipped) -->
    <path d="M 47.6 137.7 L 215.0 31.0" stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="205" y="29" fill="${C.sras}" font-size="9" font-weight="bold">SRAS</text>
    <!-- AD1 ORIGINAL — upper line (exact from SVG, clipped) -->
    <path d="M 68.9 32.3 L 215.0 117.9" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="196" y="116" fill="${C.ad}" font-size="9" font-weight="bold">AD₁</text>
    <!-- AD2 SHIFTED LEFT — lower line (exact from SVG, clipped) -->
    <path d="M 35.5 45.4 L 215.0 150.5" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="196" y="149" fill="${C.new}" font-size="9" font-weight="bold">AD₂</text>
    <!-- P1 guide: y=77.5 (LRAS∩AD1, original equilibrium) -->
    <line x1="28" y1="77.5" x2="146.8" y2="77.5" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="80.5" fill="${C.label}" font-size="7">P₁</text>
    <!-- P2 guide: y=92.6 (AD2∩SRAS, new lower equilibrium) -->
    <line x1="28" y1="92.6" x2="117.7" y2="92.6" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="95.6" fill="${C.new}" font-size="7">P₂</text>
    <!-- Y* vert at LRAS -->
    <line x1="146.8" y1="77.9" x2="146.8" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="141" y="168" fill="${C.label}" font-size="7">Y*</text>
    <!-- Y2 vert (x=117.7 = AD2∩SRAS, below potential output) -->
    <circle cx="117.7" cy="92.6" r="3.5" fill="${C.new}"/>
    <line x1="117.7" y1="92.6" x2="117.7" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="112" y="168" fill="${C.new}" font-size="7">Y₂</text>
    <!-- AD1∩LRAS original equilibrium -->
    <circle cx="146.8" cy="77.9" r="3.5" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
    <!-- Output gap bracket -->
    <line x1="117.7" y1="153" x2="146.8" y2="153" stroke="${C.new}" stroke-width="2"/>
    <line x1="117.7" y1="149" x2="117.7" y2="157" stroke="${C.new}" stroke-width="1.5"/>
    <line x1="146.8" y1="149" x2="146.8" y2="157" stroke="${C.new}" stroke-width="1.5"/>`;
  } else if (shift==='adDouble') {
    extra=`<path d="M 80 35 L 210 155" stroke="${C.teal}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="206" y="152" fill="${C.teal}" font-size="9" font-weight="bold">AD₂</text>
    <path d="M 105 35 L 225 145" stroke="${C.new}" stroke-width="2" stroke-dasharray="4,3" fill="none"/>
    <text x="218" y="142" fill="${C.new}" font-size="9" font-weight="bold">AD₃</text>
    <circle cx="130" cy="82" r="3" fill="${C.teal}" opacity="0.8"/>
    <circle cx="143" cy="70" r="3" fill="${C.new}" opacity="0.8"/>
    <text x="120" y="150" fill="${C.teal}" font-size="7">G↑→AD₂</text>
    <text x="152" y="140" fill="${C.new}" font-size="7">I↑→AD₃</text>`;
  } else if (shift==='equilibrium') {
    // Mapped exactly from Macroeconomic_Equilibrium.svg
    // SVG: 2482×1826, translate(-711,-334)
    // Axes: origin(1041,1864), Y-top(1041,340), X-right(3027.8,1864)
    // AD: M185.1 120.4 L65.0 19.8  (downward-sloping)
    // SRAS: M170.0 38.9 L44.4 124.4  (upward-sloping)
    // Intersection: (124.6, 69.8) — P1 dashed at y=69.4, err=0.4px ✓
    // Y1 vertical from intersection to x-axis
    return `<svg viewBox="0 0 230 178" xmlns="http://www.w3.org/2000/svg">
      ${axes(28,162,220,18,'Real Output','P')}
      <!-- AD: exact from SVG -->
      <line x1="185.1" y1="120.4" x2="65.0" y2="19.8" stroke="${C.ad}" stroke-width="2.5"/>
      <text x="188" y="122" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
      <!-- SRAS: exact from SVG -->
      <line x1="170.0" y1="38.9" x2="44.4" y2="124.4" stroke="${C.sras}" stroke-width="2.5"/>
      <text x="172" y="37" fill="${C.sras}" font-size="9" font-weight="bold">SRAS</text>
      <!-- P1 horizontal dashed -->
      <line x1="28" y1="69.6" x2="124.6" y2="69.6" stroke="${C.label}" stroke-width="1.2" stroke-dasharray="4,3"/>
      <text x="17" y="73" fill="${C.label}" font-size="8" font-weight="bold">P1</text>
      <!-- Y1 vertical dashed -->
      <line x1="124.6" y1="69.6" x2="124.6" y2="162" stroke="${C.label}" stroke-width="1.2" stroke-dasharray="4,3"/>
      <text x="119" y="171" fill="${C.label}" font-size="8" font-weight="bold">Y1</text>
      <!-- Equilibrium dot -->
      <circle cx="124.6" cy="69.6" r="4" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
      <text x="10" y="100" fill="${C.label}" font-size="7.5" transform="rotate(-90,10,100)">Price Level</text>
    </svg>`;
  }

  return `<svg viewBox="0 0 230 178" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('arw','#ef4444')}</defs>
    ${axes(28,162,220,18,'Y','P')}
    <path d="${ad}" stroke="${C.ad}" stroke-width="2.5" fill="none" ${hideBaseAD?'display="none"':''}/>
    <text x="187" y="153" fill="${C.ad}" font-size="9" font-weight="bold" ${hideBaseAD?'display="none"':''}>AD</text>
    <path d="${sras}" stroke="${C.sras}" stroke-width="2.5" fill="none" ${hideSRAS?'display="none"':''}/>
    <text x="177" y="36" fill="${C.sras}" font-size="9" font-weight="bold" ${hideSRAS?'display="none"':''}>SRAS</text>
    <line x1="${lrasX}" y1="28" x2="${lrasX}" y2="162" stroke="${C.lras}" stroke-width="2" stroke-dasharray="7,4" ${hideLRAS?'display="none"':''}/>
    <text x="${lrasX+2}" ${hideLRAS?'display="none"':''}  y="26" fill="${C.lras}" font-size="9" font-weight="bold">LRAS</text>
    <circle cx="${eqX}" cy="${eqY}" r="4" fill="white" opacity="0.9"/>
    ${extra}
    <text x="10" y="95" fill="${C.label}" font-size="7.5" transform="rotate(-90,10,95)">Price Level</text>
  </svg>`;
}

function ppfDiagram(shift) {
  // All curves mapped exactly from uploaded SVGs (viewBox 0 0 230 175):
  //
  // ppf_macro.svg (base single PPF):
  //   Axes: origin(450,1533), x_scale=0.0966, y_scale=0.0945 → VB origin(28,162)
  //   PPF1: M27 40.8 C67.7 45.8 108.3 50.8 136.7 71.0 C165.0 91.1 181.1 126.4 197.1 161.6
  //
  // PPF_Shift_Right.svg:
  //   PPF1 (blue):  M28 40.8 C64.8 45.8 101.5 50.8 127.2 71.0 C152.8 91.1 167.4 126.4 181.9 161.6
  //   PPF2 (red):   M28 24.8 C69.7 30.5 111.5 36.2 140.6 59.0 C169.7 81.8 186.2 121.7 202.7 161.6
  //
  // PPF_Shift_Left.svg:
  //   PPF1 (purple): M28.7 57.0 C58.4 61.9 88.1 66.8 115.0 84.3 C142.0 101.7 166.3 131.7 190.6 161.6
  //   PPF2 (green):  M28.4 101.3 C46.6 107.4 64.8 113.5 79.3 123.6 C93.8 133.6 104.5 147.6 115.3 161.6
  //
  // insideToBoundary points:
  //   A (inside): (75,75) — verified below curve (curve y≈47 at x=75) ✓
  //   B (on boundary): (87,50) — verified = seg1 t=0.5 on ppf_macro ✓
  //   Arrow A→B points up-right toward boundary ✓

  const BASE = 'M27 40.8 C67.7 45.8 108.3 50.8 136.7 71.0 C165.0 91.1 181.1 126.4 197.1 161.6';
  let content = '';

  if (shift === 'insideToBoundary') {
    content = `
    <!-- PPF from ppf_macro.svg (blue) -->
    <path d="${BASE}" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="199" y="157" fill="${C.ad}" font-size="8" font-weight="bold">PPF</text>
    <!-- A inside (75,75) — verified below curve ✓ -->
    <circle cx="75" cy="75" r="4" fill="${C.new}"/>
    <text x="79" y="73" fill="${C.new}" font-size="9" font-weight="bold">A</text>
    <!-- B on boundary at seg1 t=0.5 = (86.5,50.2) ✓ -->
    <circle cx="87" cy="50" r="4" fill="${C.lras}"/>
    <text x="91" y="48" fill="${C.lras}" font-size="9" font-weight="bold">B</text>
    <!-- Arrow A→B toward boundary -->
    <line x1="78" y1="72" x2="84" y2="54" stroke="${C.sras}" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#parw)"/>`;

  } else if (shift === 'boundaryOut') {
    content = `
    <!-- PPF1 from PPF_Shift_Right.svg (blue, dashed = old frontier) -->
    <path d="M28 40.8 C64.8 45.8 101.5 50.8 127.2 71.0 C152.8 91.1 167.4 126.4 181.9 161.6"
      stroke="${C.ad}" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="183" y="157" fill="${C.ad}" font-size="8" font-weight="bold">PPF₁</text>
    <!-- PPF2 from PPF_Shift_Right.svg (red, solid = new frontier) -->
    <path d="M28 24.8 C69.7 30.5 111.5 36.2 140.6 59.0 C169.7 81.8 186.2 121.7 202.7 161.6"
      stroke="${C.lras}" stroke-width="2.5" fill="none"/>
    <text x="204" y="157" fill="${C.lras}" font-size="8" font-weight="bold">PPF₂</text>
    <!-- Arrow showing rightward/outward shift mid-curve -->
    <line x1="156" y1="72" x2="173" y2="62" stroke="${C.sras}" stroke-width="1.5" marker-end="url(#parw)"/>`;

  } else if (shift === 'outside') {
    content = `
    <!-- PPF from ppf_macro.svg -->
    <path d="${BASE}" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="199" y="157" fill="${C.ad}" font-size="8" font-weight="bold">PPF</text>
    <!-- Point beyond/above curve — unsustainable (curve at x=100 is y≈52, so y=28 is above) -->
    <circle cx="100" cy="28" r="4" fill="${C.new}"/>
    <text x="104" y="27" fill="${C.new}" font-size="8" font-weight="bold">Unsustainable</text>`;

  } else if (shift === 'inward') {
    content = `
    <!-- PPF1 from PPF_Shift_Left.svg (purple, dashed = old frontier) -->
    <path d="M28.7 57.0 C58.4 61.9 88.1 66.8 115.0 84.3 C142.0 101.7 166.3 131.7 190.6 161.6"
      stroke="${C.ad}" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="192" y="157" fill="${C.ad}" font-size="8" font-weight="bold">PPF₁</text>
    <!-- PPF2 from PPF_Shift_Left.svg (green, solid = new (smaller) frontier) -->
    <path d="M28.4 101.3 C46.6 107.4 64.8 113.5 79.3 123.6 C93.8 133.6 104.5 147.6 115.3 161.6"
      stroke="${C.new}" stroke-width="2.5" fill="none"/>
    <text x="117" y="157" fill="${C.new}" font-size="8" font-weight="bold">PPF₂</text>
    <!-- Arrow showing inward shift -->
    <line x1="135" y1="92" x2="107" y2="108" stroke="${C.new}" stroke-width="1.5" marker-end="url(#parw)"/>`;
  } else if (shift === 'crowdingIn') {
    // Crowding-in PPF — Y=Deficit Spending, X=Private Sector Investment
    // In SVG coords: y increases downward → HIGH deficit = LOW y (high on page), LOW deficit = HIGH y
    //
    // Points (all verified against curve):
    //   A (75,120):  INSIDE PPF — curve at x=75 is y≈47, A.y=120 >> 47 → clearly inside ✓
    //   B (75,78):   INSIDE PPF — curve at x=75 is y≈47, B.y=78 > 47 → inside ✓
    //                Directly above A: same private investment, more deficit spending
    //   C (159,93):  ON PPF boundary — seg2 t=0.30 gives (159.2,92.8) ✓
    //                More private investment (75→159) AND less deficit (78→93 in SVG = lower on page)
    //                → diagonal right-and-DOWN arrow: visually shows rebalancing ✓
    //
    // Story: A→B: govt raises deficit spending (vertical up)
    //        B→C: private investment crowds in → govt can REDUCE deficit as private sector
    //             takes over — optimal rebalancing toward the PPF boundary
    content = `
    <!-- PPF boundary (blue) — BASE curve from ppf_macro.svg -->
    <path d="${BASE}" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="199" y="157" fill="${C.ad}" font-size="8" font-weight="bold">PPF</text>
    <!-- A (75,120): inside — low deficit, low investment ✓ -->
    <circle cx="75" cy="120" r="4" fill="${C.muted}"/>
    <text x="63" y="118" fill="${C.label}" font-size="9" font-weight="bold">A</text>
    <!-- B (75,78): inside — high deficit, low investment ✓ -->
    <circle cx="75" cy="78" r="4" fill="${C.new}"/>
    <text x="63" y="76" fill="${C.new}" font-size="9" font-weight="bold">B</text>
    <!-- C (159,93): ON boundary — seg2 t=0.30 = (159.2,92.8) ✓
         x=159 > 75 (more investment), y=93 > 78 (lower deficit — rebalancing) -->
    <circle cx="159" cy="93" r="4" fill="${C.lras}"/>
    <text x="163" y="92" fill="${C.lras}" font-size="9" font-weight="bold">C</text>
    <!-- Arrow A→B: vertical up — govt raises deficit spending -->
    <line x1="75" y1="116" x2="75" y2="83" stroke="${C.new}" stroke-width="1.5" marker-end="url(#parw)"/>
    <!-- Arrow B→C: diagonal right-and-down — private investment crowds in, govt rebalances deficit down -->
    <line x1="80" y1="80" x2="150" y2="91" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#parw)"/>`;
  }

  const xLabel = shift === 'crowdingIn' ? 'Private Sector Investment' : 'Consumer Goods';
  const yLabel = shift === 'crowdingIn' ? 'Deficit Spending' : 'Capital Goods';
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('parw','#f59e0b')}</defs>
    <line x1="28" y1="162" x2="210" y2="162" stroke="${C.muted}" stroke-width="1.5"/>
    <line x1="28" y1="162" x2="28" y2="15" stroke="${C.muted}" stroke-width="1.5"/>
    ${content}
    <text x="10" y="90" fill="${C.label}" font-size="7" transform="rotate(-90,10,90)">${yLabel}</text>
    <text x="119" y="173" fill="${C.label}" font-size="7" text-anchor="middle">${xLabel}</text>
  </svg>`;
}


function dlShiftLeftDiagram() {
  // DL shifts LEFT — cyclical unemployment → wage adjustment → new E2 at NRU
  //
  // AJ:  M55 158 L135 22  y=158-1.7*(x-55)   x_AJ(y)=55+(158-y)/1.7
  // LF:  M105 158 L145 22 y=158-3.4*(x-105)  x_LF(y)=105+(158-y)/3.4
  // DL1: M50 22 L202 162  y=0.923*(x-50)+22
  // DL2: DL1 shifted left 40px → M28 38.6 L162 162  y=0.923*(x-10)+22
  //
  // E1 = AJ∩DL1 = (105,73). LF at W1*: x=130. NRU1=25px ✓
  //
  // At W1*=73: DL2 demands x=65.3 — cyclical unemployment gap = 105-65 = 39.7px ✓
  //   DL2 point at W1*: (65.3, 73). AJ point: (105, 73)
  //
  // Wages fall → E2 = AJ∩DL2 = (91, 96.8) — error=0.0000 ✓
  //   LF at W2* (y=96.8): x=123.0. NRU2 = 32px ✓
  //   W* falls 73→97 (higher SVG y = lower real wage) ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>
      ${arrowDef('dllarw','#ef4444')}
      ${arrowDef('dllarw2','#f59e0b')}
    </defs>
    ${axes(28,162,215,18,'Workers','Real Wage')}
    <!-- LF: unchanged — M105 158 L145 22 -->
    <line x1="105" y1="158" x2="145" y2="22" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="147" y="20" fill="${C.sras}" font-size="9" font-weight="bold">LF</text>
    <!-- AJ: unchanged — M55 158 L135 22 -->
    <line x1="55" y1="158" x2="135" y2="22" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="137" y="20" fill="${C.lras}" font-size="9" font-weight="bold">AJ</text>
    <!-- DL1: original — M50 22 L202 162 (dashed) -->
    <line x1="50" y1="22" x2="202" y2="162" stroke="${C.ad}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="204" y="160" fill="${C.ad}" font-size="8" font-weight="bold">DL₁</text>
    <!-- DL2: shifted left 40px — M28 39 L162 162 -->
    <line x1="28" y1="39" x2="162" y2="162" stroke="${C.new}" stroke-width="2.5"/>
    <text x="158" y="158" fill="${C.new}" font-size="8" font-weight="bold">DL₂</text>
    <!-- Shift arrow DL1→DL2 -->
    <line x1="148" y1="60" x2="110" y2="60" stroke="${C.new}" stroke-width="1.5" marker-end="url(#dllarw)"/>
    <!-- E1: AJ∩DL1 = (105,73) -->
    <circle cx="105" cy="73" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <text x="108" y="71" fill="${C.label}" font-size="8" font-weight="bold">E₁</text>
    <!-- W1* horizontal guide -->
    <line x1="28" y1="73" x2="130" y2="73" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="16" y="76" fill="${C.label}" font-size="7">W₁*</text>
    <!-- DL2 point at W1* = (65, 73) — shows reduced labour demand -->
    <circle cx="65" cy="73" r="3.5" fill="${C.new}"/>
    <!-- Cyclical unemployment bracket at W1* between DL2 and AJ -->
    <line x1="65" y1="83" x2="105" y2="83" stroke="#f59e0b" stroke-width="2"/>
    <line x1="65" y1="79" x2="65" y2="87" stroke="#f59e0b" stroke-width="1.5"/>
    <line x1="105" y1="79" x2="105" y2="87" stroke="#f59e0b" stroke-width="1.5"/>
    <text x="85" y="94" fill="#f59e0b" font-size="6.5" font-weight="bold" text-anchor="middle">Cyclical U</text>
    <!-- Wage falls arrow on y-axis -->
    <line x1="32" y1="76" x2="32" y2="94" stroke="${C.new}" stroke-width="1.5" marker-end="url(#dllarw)"/>
    <!-- E2: AJ∩DL2 = (91,97) — new equilibrium after wage adjustment -->
    <circle cx="91" cy="97" r="4" fill="white" stroke="${C.new}" stroke-width="2"/>
    <text x="82" y="95" fill="${C.new}" font-size="8" font-weight="bold">E₂</text>
    <!-- W2* horizontal guide -->
    <line x1="28" y1="97" x2="123" y2="97" stroke="${C.new}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="16" y="100" fill="${C.new}" font-size="7">W₂*</text>
    <!-- Q_AJ2 vertical -->
    <line x1="91" y1="97" x2="91" y2="162" stroke="${C.new}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <!-- LF point at W2* = (123,97) -->
    <circle cx="123" cy="97" r="3.5" fill="${C.sras}"/>
    <line x1="123" y1="97" x2="123" y2="162" stroke="${C.sras}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <!-- NRU bracket at W2* -->
    <line x1="91" y1="152" x2="123" y2="152" stroke="${C.purple}" stroke-width="2"/>
    <line x1="91" y1="148" x2="91" y2="156" stroke="${C.purple}" stroke-width="1.5"/>
    <line x1="123" y1="148" x2="123" y2="156" stroke="${C.purple}" stroke-width="1.5"/>
  </svg>`;
}

function ajShiftRightDiagram() {
  // AJ shifts RIGHT — supply-side policy increases job acceptances → smaller NRU
  // LF and DL unchanged.
  //
  // AJ1: M55 158 L135 22  slope=-1.7  y=158-1.7*(x-55)
  // AJ2: M70 158 L150 22  slope=-1.7  y=158-1.7*(x-70)  [dx=+15]
  // LF:  M105 158 L145 22 slope=-3.4  x_LF(y)=105+(158-y)/3.4
  // DL:  M50 22 L202 162  slope=+0.923
  //
  // E1 = AJ1∩DL: (105, 73)    LF at y=73: x=130    NRU1 = 25.0px  ✓
  // E2 = AJ2∩DL: (114.8, 81.8) LF at y=81.8: x=127.4  NRU2 = 12.6px  ✓
  // NRU reduced: 25 → 12.6px  ✓
  // W* falls: y=73 → y=81.8 (lower real wage at new eq — wage moderation) ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('ajrarw','#10b981')}</defs>
    ${axes(28,162,215,18,'Workers','Real Wage')}
    <!-- DL: unchanged — M50 22 L202 162 -->
    <line x1="50" y1="22" x2="202" y2="162" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="204" y="160" fill="${C.ad}" font-size="9" font-weight="bold">DL</text>
    <!-- LF: unchanged — M105 158 L145 22 -->
    <line x1="105" y1="158" x2="145" y2="22" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="147" y="20" fill="${C.sras}" font-size="9" font-weight="bold">LF</text>
    <!-- AJ1: original — M55 158 L135 22 -->
    <line x1="55" y1="158" x2="135" y2="22" stroke="${C.muted}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="128" y="20" fill="${C.muted}" font-size="9" font-weight="bold">AJ₁</text>
    <!-- AJ2: shifted right dx=15 — M70 158 L150 22 -->
    <line x1="70" y1="158" x2="150" y2="22" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="152" y="20" fill="${C.lras}" font-size="9" font-weight="bold">AJ₂</text>
    <!-- Shift arrow AJ1→AJ2 -->
    <line x1="87" y1="115" x2="100" y2="115" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#ajrarw)"/>
    <!-- E1: AJ1∩DL = (105,73) -->
    <circle cx="105" cy="73" r="3.5" fill="white" stroke="${C.muted}" stroke-width="1.5"/>
    <text x="97" y="71" fill="${C.muted}" font-size="8" font-weight="bold">E₁</text>
    <!-- W1* guide -->
    <line x1="28" y1="73" x2="130" y2="73" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="16" y="76" fill="${C.muted}" font-size="7">W₁*</text>
    <!-- E2: AJ2∩DL = (115,82) -->
    <circle cx="115" cy="82" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <text x="118" y="80" fill="${C.lras}" font-size="8" font-weight="bold">E₂</text>
    <!-- W2* guide to LF -->
    <line x1="28" y1="82" x2="127" y2="82" stroke="${C.lras}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="16" y="85" fill="${C.lras}" font-size="7">W₂*</text>
    <!-- Q_AJ1 and Q_AJ2 verticals -->
    <line x1="105" y1="73" x2="105" y2="162" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <line x1="115" y1="82" x2="115" y2="162" stroke="${C.lras}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <!-- LF points at each W* -->
    <circle cx="130" cy="73" r="3" fill="${C.sras}" opacity="0.5"/>
    <circle cx="127" cy="82" r="3" fill="${C.sras}"/>
    <line x1="127" y1="82" x2="127" y2="162" stroke="${C.sras}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <!-- NRU1 bracket (faint) -->
    <line x1="105" y1="145" x2="130" y2="145" stroke="${C.muted}" stroke-width="1.5"/>
    <line x1="105" y1="142" x2="105" y2="148" stroke="${C.muted}" stroke-width="1.2"/>
    <line x1="130" y1="142" x2="130" y2="148" stroke="${C.muted}" stroke-width="1.2"/>
    <text x="117" y="155" fill="${C.muted}" font-size="6.5" text-anchor="middle">NRU₁</text>
    <!-- NRU2 bracket (prominent) -->
    <line x1="115" y1="152" x2="127" y2="152" stroke="${C.new}" stroke-width="2"/>
    <line x1="115" y1="148" x2="115" y2="156" stroke="${C.new}" stroke-width="1.5"/>
    <line x1="127" y1="148" x2="127" y2="156" stroke="${C.new}" stroke-width="1.5"/>
  </svg>`;
}

function ajLfLabourDiagram() {
  // AJ / LF Labour Market — NRU diagram
  // Axes: axes(28,162,215,18,'Workers','Real Wage')
  //
  // AJ (Job Acceptances): moderately upward — LESS inelastic (more elastic response to wage)
  //   M55 158 L135 22  slope_svg = (22-158)/(135-55) = -1.7
  //
  // LF (Labour Force): steep upward — MORE inelastic (large wage rise needed for small Q response)
  //   M105 158 L145 22  slope_svg = (22-158)/(145-105) = -3.4
  //   LF always to the RIGHT of AJ at same wage — verified at y=25,50,80,110,140 ✓
  //
  // DL (Labour Demand): downward sloping — M50 22 L202 162  slope_svg = +0.923
  //
  // AJ ∩ DL: x=105.1, y=72.8 — error=0.000 ✓
  // LF at W* (y=72.8): x=130.0
  // NRU gap = 130 - 105 = 25px ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('ajlarw','#10b981')}</defs>
    ${axes(28,162,215,18,'Workers','Real Wage')}
    <!-- DL: downward sloping — M50 22 L202 162 -->
    <line x1="50" y1="22" x2="202" y2="162" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="204" y="160" fill="${C.ad}" font-size="9" font-weight="bold">DL</text>
    <!-- AJ: moderately steep — less inelastic — M55 158 L135 22 -->
    <line x1="55" y1="158" x2="135" y2="22" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="137" y="20" fill="${C.lras}" font-size="9" font-weight="bold">AJ</text>
    <!-- LF: very steep — more inelastic — M105 158 L145 22 -->
    <line x1="105" y1="158" x2="145" y2="22" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="147" y="20" fill="${C.sras}" font-size="9" font-weight="bold">LF</text>
    <!-- E_eq: AJ ∩ DL = (105, 73) ✓ -->
    <circle cx="105" cy="73" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <!-- W* horizontal guide to LF -->
    <line x1="28" y1="73" x2="130" y2="73" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="76" fill="${C.label}" font-size="7.5" font-weight="bold">W*</text>
    <!-- Q_AJ vertical -->
    <line x1="105" y1="73" x2="105" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="99" y="171" fill="${C.label}" font-size="7" text-anchor="middle">Q\u2090\u2C7C</text>
    <!-- LF point at W* = (130, 73) -->
    <circle cx="130" cy="73" r="3.5" fill="${C.sras}"/>
    <!-- Q_LF vertical -->
    <line x1="130" y1="73" x2="130" y2="162" stroke="${C.sras}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="124" y="171" fill="${C.sras}" font-size="7" text-anchor="middle">Q\u2097\u2101</text>
    <!-- NRU bracket -->
    <line x1="105" y1="152" x2="130" y2="152" stroke="${C.new}" stroke-width="2"/>
    <line x1="105" y1="148" x2="105" y2="156" stroke="${C.new}" stroke-width="1.5"/>
    <line x1="130" y1="148" x2="130" y2="156" stroke="${C.new}" stroke-width="1.5"/>

  </svg>`;
}


function supplySidePhillipsDiagram() {
  // Supply-Side Policy shifting LRPC and SRPC left — inflation remains stable
  // SRPC2: pure leftward shift dx=-45, dy=0 → same π at lower NRU
  //
  // SRPC1: M 38 22 C 42 60 60 100 90 120 C 120 138 160 148 205 153
  //   NRU1=140. E1=(140,141) — SRPC1 ∩ LRPC1 ✓
  //
  // SRPC2: all x-coords -45, y unchanged (pure leftward shift)
  //   seg1 clipped entry at x=25: y=101.5
  //   seg2: P0=(45,120) C1=(75,138) C2=(115,148) P1=(160,153)
  //   NRU2=95. E2=(95,140.8) — same inflation as E1 ✓
  //   E2.x=95 < E1.x=140 → lower unemployment ✓
  //   E2.y=141 ≈ E1.y=141 → same inflation level ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>
      ${arrowDef('ssparw','#10b981')}
    </defs>
    ${axes(25,160,215,18,'U%','\u03c0%')}
    <!-- LRPC1: x=140 (original NRU) -->
    <line x1="140" y1="18" x2="140" y2="160" stroke="${C.muted}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="134" y="16" fill="${C.muted}" font-size="7.5" font-weight="bold">LRPC₁</text>
    <text x="130" y="170" fill="${C.muted}" font-size="6.5" text-anchor="middle">NRU₁</text>
    <!-- LRPC2: x=95 (lower NRU after supply-side policy) -->
    <line x1="95" y1="18" x2="95" y2="160" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="89" y="16" fill="${C.lras}" font-size="7.5" font-weight="bold">LRPC₂</text>
    <text x="87" y="170" fill="${C.lras}" font-size="6.5" text-anchor="middle">NRU₂</text>
    <!-- Shift arrows LRPC1→LRPC2 -->
    <line x1="136" y1="42" x2="99" y2="42" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#ssparw)"/>
    <line x1="136" y1="53" x2="99" y2="53" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#ssparw)"/>
    <!-- SRPC1: original curve -->
    <path d="M 38 22 C 42 60 60 100 90 120 C 120 138 160 148 205 153"
          stroke="${C.purple}" stroke-width="2.5" fill="none"/>
    <text x="200" y="151" fill="${C.purple}" font-size="8" font-weight="bold">SRPC₁</text>
    <!-- SRPC2: pure leftward shift dx=-45 — same inflation at lower U
         seg1 entry: (25,102). seg2 end: (160,153). E2=(95,141) verified ✓ -->
    <path d="M 25 102 C -3 60 15 100 45 120 C 75 138 115 148 160 153"
          stroke="${C.lras}" stroke-width="2.5" fill="none" stroke-dasharray="5,3"/>
    <text x="155" y="151" fill="${C.lras}" font-size="8" font-weight="bold">SRPC₂</text>
    <!-- Shift arrow SRPC1→SRPC2 (leftward, mid-curve) -->
    <line x1="158" y1="148" x2="116" y2="148" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#ssparw)"/>
    <!-- E1: (140,141) — SRPC1 ∩ LRPC1 -->
    <circle cx="140" cy="141" r="4" fill="white" stroke="${C.muted}" stroke-width="2"/>
    <text x="143" y="140" fill="${C.label}" font-size="9" font-weight="bold">E₁</text>
    <!-- E2: (95,141) — SRPC2 ∩ LRPC2, same π, lower U -->
    <circle cx="95" cy="141" r="4" fill="${C.lras}"/>
    <text x="98" y="140" fill="${C.lras}" font-size="9" font-weight="bold">E₂</text>
    <!-- π guide: same level for both equilibria — stable inflation -->
    <line x1="25" y1="141" x2="140" y2="141" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="13" y="144" fill="${C.label}" font-size="6.5">\u03c0*</text>
    <!-- Horizontal arrow E1→E2 — purely leftward, inflation unchanged -->
    <line x1="136" y1="141" x2="99" y2="141" stroke="${C.lras}" stroke-width="2" marker-end="url(#ssparw)"/>
  </svg>`;
}


function lrPhillipsDiagram() {
  // Monetarist Long-Run Phillips Curve — A→B→C sequence
  // Axes: axes(25,160,215,18,'U%','π%') — SVG y↑ = higher inflation
  //
  // SRPC1 path (existing phillipsDiagram curve):
  //   M 38 22 C 42 60 60 100 90 120 C 120 138 160 148 205 153
  //   At x=140: y=140.7 (verified t=0.480 on seg2) ✓
  //   At x=85:  y=116.1 (verified t=0.938 on seg1) ✓
  //
  // SRPC2: SRPC1 shifted UP 38px (higher inflation expectations)
  //   All y values -38. M 38 -16→off canvas; enters at x=45,y=18
  //   At x=140: y=140.7-38=102.7 (point C) ✓
  //
  // NRU = x=140. LRPC vertical at x=140.
  // A = (140,141): SRPC1 ∩ LRPC — original eq, low inflation ✓
  // B = (85,116):  on SRPC1 — lower U, higher π, workers in money illusion ✓
  // C = (140,103): SRPC2 ∩ LRPC — back at NRU, higher inflation ✓
  //
  // A→B: demand-side policy, move LEFT along SRPC1
  // B→C: money illusion erodes, wage expectations ↑, SRPC shifts up to SRPC2
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>
      ${arrowDef('lrparw','#ef4444')}
      ${arrowDef('lrparw2','#8b5cf6')}
    </defs>
    ${axes(25,160,215,18,'U%','\u03c0%')}
    <!-- LRPC: vertical at NRU x=140 -->
    <line x1="140" y1="18" x2="140" y2="160" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="142" y="16" fill="${C.lras}" font-size="8" font-weight="bold">LRPC</text>
    <text x="132" y="170" fill="${C.lras}" font-size="7" text-anchor="middle">NRU</text>
    <!-- SRPC1: original curve (low inflation expectations) -->
    <path d="M 38 22 C 42 60 60 100 90 120 C 120 138 160 148 205 153"
          stroke="${C.purple}" stroke-width="2.5" fill="none"/>
    <text x="200" y="151" fill="${C.purple}" font-size="8" font-weight="bold">SRPC₁</text>
    <!-- SRPC2: SRPC1 shifted up 38px (higher inflation expectations) -->
    <path d="M 45 18 C 50 28 62 62 90 82 C 120 100 160 110 205 115"
          stroke="${C.new}" stroke-width="2.5" fill="none" stroke-dasharray="5,3"/>
    <text x="200" y="113" fill="${C.new}" font-size="8" font-weight="bold">SRPC₂</text>
    <!-- Upward shift arrow between SRPC1 and SRPC2 -->
    <line x1="175" y1="143" x2="175" y2="122" stroke="${C.new}" stroke-width="1.5" marker-end="url(#lrparw)"/>
    <text x="178" y="135" fill="${C.new}" font-size="6.5">\u2191\u03c0\u1d49</text>
    <!-- A: (140,141) — SRPC1 ∩ LRPC, original equilibrium -->
    <circle cx="140" cy="141" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <text x="143" y="140" fill="${C.label}" font-size="9" font-weight="bold">A</text>
    <!-- B: (71,103) — SRPC1 at lower U, SAME π as C — verified SRPC1 y=102.8 at t=0.761 ✓ -->
    <circle cx="71" cy="103" r="4" fill="${C.purple}"/>
    <text x="61" y="101" fill="${C.purple}" font-size="9" font-weight="bold">B</text>
    <!-- C: (140,103) — SRPC2 ∩ LRPC, back at NRU, same π as B ✓ -->
    <circle cx="140" cy="103" r="4" fill="${C.new}"/>
    <text x="143" y="102" fill="${C.new}" font-size="9" font-weight="bold">C</text>
    <!-- Arrow A→B: along SRPC1, leftward (demand stimulus moves left along curve) -->
    <path d="M 137 139 C 115 132 95 120 74 105"
          stroke="${C.ad}" stroke-width="1.8" fill="none" marker-end="url(#lrparw2)"/>
    <!-- Arrow B→C: horizontal — money illusion erodes, U rises back to NRU, π unchanged -->
    <line x1="75" y1="103" x2="136" y2="103"
          stroke="${C.new}" stroke-width="1.8" marker-end="url(#lrparw)"/>
    <!-- Inflation guides on y-axis -->
    <line x1="25" y1="141" x2="140" y2="141" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <line x1="25" y1="103" x2="140" y2="103" stroke="${C.muted}" stroke-width="0.8" stroke-dasharray="2,2"/>
    <text x="13" y="144" fill="${C.label}" font-size="6.5">\u03c0\u2081</text>
    <text x="13" y="106" fill="${C.new}" font-size="6.5">\u03c0\u2082</text>
  </svg>`;
}

function phillipsDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(25,160,215,18,'U%','π%')}
    <!-- Sharply curved hyperbolic SRPC: steep at low U, flattens at high U -->
    <path d="M 38 22 C 42 60, 60 100, 90 120 C 120 138, 160 148, 205 153" stroke="${C.purple}" stroke-width="2.5" fill="none"/>
    <text x="197" y="150" fill="${C.purple}" font-size="9" font-weight="bold">SRPC</text>
    <!-- Point at low U, high inflation -->
    <circle cx="55" cy="78" r="3.5" fill="${C.new}"/>
    <!-- Point at high U, low inflation -->
    <circle cx="145" cy="142" r="3.5" fill="${C.teal}"/>
    <line x1="55" y1="78" x2="55" y2="160" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="145" y1="142" x2="145" y2="160" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="49" y="170" fill="${C.new}" font-size="8">2%</text>
    <text x="138" y="170" fill="${C.teal}" font-size="8">6%</text>
    <line x1="25" y1="78" x2="55" y2="78" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="25" y1="142" x2="145" y2="142" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="15" y="81" fill="${C.new}" font-size="8">6%</text>
    <text x="15" y="145" fill="${C.teal}" font-size="8">2%</text>
  </svg>`;
}



function keynesianUnemploymentDiagram() {
  // Keynesian Unemployment — Keynesian LRAS with AD shift LEFT in flat (spare capacity) zone
  // AS path: IDENTICAL to keynesianDiagram — M 35 128 L 110 128 Q 145 128 160 95 L 162 28
  // Axes: axes(28,162,215,18) — same as keynesianDiagram
  //
  // AD1 (original): from (35,95) to (165,160) — slope 0.5, intersects flat at (100,128) = Y1
  // AD2 (shifted left): from (28,107) to (138,162) — same slope, intersects flat at (70,128) = Y2
  // Key: both AD curves hit the FLAT section → P unchanged, only Y falls (Keynesian unemployment)
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('kua',C.ad)}</defs>
    ${axes(28,162,215,18,'Y','P')}
    <!-- Keynesian AS: flat then curved then vertical — identical to keynesianDiagram -->
    <path d="M 35 128 L 110 128 Q 145 128 160 95 L 162 28" stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="164" y="26" fill="${C.sras}" font-size="8" font-weight="bold">AS</text>
    <text x="164" y="36" fill="${C.sras}" font-size="7">(Keynesian)</text>
    <!-- Section labels -->
    <text x="55" y="122" fill="${C.lras}" font-size="7">Spare capacity</text>
    <!-- AD1: original equilibrium at Y1 (in flat section) -->
    <line x1="35" y1="95" x2="165" y2="160" stroke="${C.ad}" stroke-width="2" opacity="0.45"/>
    <text x="167" y="158" fill="${C.ad}" font-size="8" font-weight="bold">AD₁</text>
    <!-- AD2: shifted left — new equilibrium at Y2, SAME price level -->
    <line x1="28" y1="107" x2="138" y2="162" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="136" y="162" fill="${C.ad}" font-size="8" font-weight="bold">AD₂</text>
    <!-- Shift arrow from AD1 → AD2 -->
    <line x1="96" y1="118" x2="66" y2="118" stroke="${C.ad}" stroke-width="1.5" marker-end="url(#kua)"/>
    <!-- P1: price level — unchanged (horizontal dashed at y=128) -->
    <line x1="28" y1="128" x2="100" y2="128" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="18" y="131" fill="${C.label}" font-size="7.5" font-weight="bold">P</text>
    <!-- Y1 vertical dashed -->
    <line x1="100" y1="128" x2="100" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="97" y="170" fill="${C.label}" font-size="7.5" font-weight="bold">Y1</text>
    <!-- Y2 vertical dashed -->
    <line x1="70" y1="128" x2="70" y2="162" stroke="${C.ad}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="67" y="170" fill="${C.ad}" font-size="7.5" font-weight="bold">Y2</text>
    <!-- Equilibrium dots -->
    <circle cx="100" cy="128" r="3" fill="white" stroke="${C.muted}" stroke-width="1.5"/>
    <circle cx="70" cy="128" r="3.5" fill="${C.ad}"/>
    <!-- Keynesian unemployment annotation -->
    <text x="48" y="145" fill="${C.ad}" font-size="7" text-anchor="middle">Keynesian</text>
    <text x="48" y="154" fill="${C.ad}" font-size="7" text-anchor="middle">unemployment</text>
    <line x1="48" y1="156" x2="70" y2="162" stroke="${C.ad}" stroke-width="1"/>
    <text x="10" y="95" fill="${C.label}" font-size="7.5" transform="rotate(-90,10,95)">Price Level</text>
  </svg>`;
}

function keynesianDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,162,215,18,'Y','P')}
    <!-- Keynesian AS: flat then curved then vertical -->
    <path d="M 35 128 L 110 128 Q 145 128 160 95 L 162 28" stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="164" y="26" fill="${C.sras}" font-size="8" font-weight="bold">AS</text><text x="164" y="36" fill="${C.sras}" font-size="7">(Keynesian)</text>
    <!-- Labels on curve -->
    <text x="55" y="122" fill="${C.lras}" font-size="7.5">Spare capacity</text>
    <text x="112" y="110" fill="${C.sras}" font-size="7.5">Competition</text>
    <text x="112" y="120" fill="${C.sras}" font-size="7.5">for resources</text>
    <text x="152" y="55" fill="${C.new}" font-size="7.5">Full</text>
    <text x="152" y="65" fill="${C.new}" font-size="7.5">capacity</text>
    <!-- AD -->
    <path d="M 55 35 L 185 155" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="187" y="153" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- Equilibrium dot: AD intersects upward section of AS -->
    <circle cx="130" cy="117" r="3.5" fill="white" stroke="${C.ad}" stroke-width="1.5"/>
    <text x="10" y="95" fill="${C.label}" font-size="7.5" transform="rotate(-90,10,95)">Price Level</text>
  </svg>`;
}


function classicalUnemploymentDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('carr','#ef4444')}</defs>
    ${axes(28,162,215,18,'Q Labour','Real W')}
    <path d="M 42 28 L 202 148" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="204" y="146" fill="${C.ad}" font-size="9" font-weight="bold">DL</text>
    <path d="M 42 148 L 202 28" stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="204" y="26" fill="${C.sras}" font-size="9" font-weight="bold">SL</text>
    <circle cx="122" cy="88" r="4" fill="white" opacity="0.9"/>
    <line x1="28" y1="88" x2="122" y2="88" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="91" fill="${C.label}" font-size="8">W*</text>
    <line x1="28" y1="60" x2="215" y2="60" stroke="${C.new}" stroke-width="2"/>
    <text x="30" y="55" fill="${C.new}" font-size="8" font-weight="bold">W min (above equilibrium)</text>
    <circle cx="96" cy="60" r="3.5" fill="${C.ad}"/>
    <circle cx="155" cy="60" r="3.5" fill="${C.sras}"/>
    <line x1="96" y1="70" x2="155" y2="70" stroke="${C.new}" stroke-width="1.5"/>
    <line x1="96" y1="66" x2="96" y2="74" stroke="${C.new}" stroke-width="1.5"/>
    <line x1="155" y1="66" x2="155" y2="74" stroke="${C.new}" stroke-width="1.5"/>
    <text x="125" y="82" fill="${C.new}" font-size="8" text-anchor="middle">Classical Unemployment</text>
  </svg>`;
}

function nruDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(25,160,215,18,'U%','π%')}
    <path d="M 35 28 Q 75 80 188 153" stroke="${C.purple}" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="190" y="150" fill="${C.purple}" font-size="9">SRPC</text>
    <line x1="108" y1="18" x2="108" y2="160" stroke="${C.new}" stroke-width="2.5"/>
    <text x="110" y="16" fill="${C.new}" font-size="9" font-weight="bold">LRPC</text>
    <text x="108" y="170" fill="${C.new}" font-size="9" text-anchor="middle" font-weight="bold">NRU</text>
    <rect x="122" y="38" width="85" height="52" rx="5" fill="rgba(239,68,68,0.08)" stroke="#334155" stroke-width="1"/>
    <text x="164" y="51" fill="#f1f5f9" font-size="8" font-weight="bold" text-anchor="middle">NRU includes:</text>
    <text x="164" y="63" fill="${C.muted}" font-size="7.5" text-anchor="middle">• Frictional U</text>
    <text x="164" y="73" fill="${C.muted}" font-size="7.5" text-anchor="middle">• Structural U</text>
    <text x="164" y="83" fill="${C.lras}" font-size="7.5" text-anchor="middle">NOT cyclical U</text>
  </svg>`;
}

function economicCycleDiagram() {
  // Coordinates mapped exactly from Economic_Cycle.svg.
  // SVG: 2731×1358, translate(-722,-513). Axes: x(451→2438), y(1160→147).
  // Trend (green #00B050 → C.lras): M31.5,133.1 → L199.6,39.1
  // Actual GDP (blue #0070C0 → C.ad): M34.8,125.2 C45.4,111.7 56.0,98.1 74.9,92.1 C93.7,86.0 127.8,101.5 148.1,106.4
  // Phase labels from SVG: Recession(86,106), Boom(55,86), Recovery(147,51), Trough(144→146,102→115)
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(25,152,215,18,'Time','Real GDP')}
    <!-- Trend growth rate: upward sloping dashed (green in SVG) -->
    <line x1="31.5" y1="133.1" x2="199.6" y2="39.1" stroke="${C.lras}" stroke-width="1.8" stroke-dasharray="6,3"/>
    <text x="191.2" y="53.4" fill="${C.lras}" font-size="7.5">Trend growth</text>
    <text x="196.0" y="62.0" fill="${C.lras}" font-size="7.5">rate</text>
    <!-- Actual GDP cycle (blue in SVG) -->
    <path d="M34.8 125.2 C45.4 111.7 56.0 98.1 74.9 92.1 C93.7 86.0 127.8 101.5 148.1 106.4 C167.5 111.0 181.4 51.2 199.6 10.1"
          stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="181.4" y="10.1" fill="${C.ad}" font-size="7.5" font-weight="bold">Actual GDP</text>
    <!-- Phase labels from SVG (orange for Recession, green for Boom/Recovery, blue for trough) -->
    <text x="86.2" y="106.8" fill="${C.new}" font-size="7.5" text-anchor="middle">Recession</text>
    <text x="55.9" y="82.5" fill="${C.sras}" font-size="7.5" text-anchor="middle">Boom</text>
    <text x="147.8" y="51.2" fill="${C.lras}" font-size="7.5" text-anchor="middle">Recovery</text>
    <text x="144.9" y="102.5" fill="${C.ad}" font-size="7.5" text-anchor="middle">Slump /</text>
    <text x="146.6" y="111.5" fill="${C.ad}" font-size="7.5" text-anchor="middle">trough</text>
  </svg>`;
}


function harrodDomarDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <rect x="48" y="8" width="134" height="34" rx="8" fill="rgba(59,130,246,0.15)" stroke="${C.ad}" stroke-width="1.5"/>
    <text x="115" y="22" fill="#f1f5f9" font-size="13" font-weight="bold" text-anchor="middle">g = s / k</text>
    <text x="115" y="36" fill="${C.muted}" font-size="7.5" text-anchor="middle">Growth = Savings Ratio ÷ Capital-Output Ratio</text>
    <rect x="8" y="55" width="62" height="40" rx="6" fill="rgba(16,185,129,0.15)" stroke="${C.lras}" stroke-width="1.5"/>
    <text x="39" y="72" fill="${C.lras}" font-size="11" font-weight="bold" text-anchor="middle">g</text>
    <text x="39" y="85" fill="${C.muted}" font-size="7.5" text-anchor="middle">Growth</text>
    <rect x="84" y="55" width="62" height="40" rx="6" fill="rgba(245,158,11,0.15)" stroke="${C.sras}" stroke-width="1.5"/>
    <text x="115" y="72" fill="${C.sras}" font-size="11" font-weight="bold" text-anchor="middle">s</text>
    <text x="115" y="85" fill="${C.muted}" font-size="7.5" text-anchor="middle">Savings ratio</text>
    <rect x="160" y="55" width="62" height="40" rx="6" fill="rgba(239,68,68,0.15)" stroke="${C.new}" stroke-width="1.5"/>
    <text x="191" y="72" fill="${C.new}" font-size="11" font-weight="bold" text-anchor="middle">k</text>
    <text x="191" y="85" fill="${C.muted}" font-size="7.5" text-anchor="middle">Cap-output ratio</text>
    <line x1="70" y1="75" x2="84" y2="75" stroke="${C.muted}" stroke-width="1"/>
    <text x="77" y="71" fill="${C.sras}" font-size="12" text-anchor="middle">↑</text>
    <line x1="146" y1="75" x2="160" y2="75" stroke="${C.muted}" stroke-width="1"/>
    <text x="153" y="71" fill="${C.new}" font-size="12" text-anchor="middle">↓</text>
    <rect x="8" y="108" width="102" height="30" rx="4" fill="rgba(16,185,129,0.08)" stroke="#334155" stroke-width="1"/>
    <text x="59" y="120" fill="${C.lras}" font-size="8" text-anchor="middle">↑ s → more savings</text>
    <text x="59" y="132" fill="${C.muted}" font-size="7.5" text-anchor="middle">→ funds investment</text>
    <rect x="120" y="108" width="102" height="30" rx="4" fill="rgba(239,68,68,0.08)" stroke="#334155" stroke-width="1"/>
    <text x="171" y="120" fill="${C.new}" font-size="8" text-anchor="middle">↓ k → better tech</text>
    <text x="171" y="132" fill="${C.muted}" font-size="7.5" text-anchor="middle">→ more output per £K</text>
    <text x="115" y="158" fill="${C.sras}" font-size="7.5" text-anchor="middle" font-style="italic">Developing countries: savings gap → need FDI/aid</text>
  </svg>`;
}


function lafferDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,158,215,18,'Tax Rate %','Revenue £')}
    <text x="28" y="170" fill="${C.label}" font-size="7">0%</text>
    <text x="207" y="170" fill="${C.label}" font-size="7">100%</text>
    <!-- Smooth asymmetric Laffer curve: peak at ~50% rate, mid-range revenue level -->
    <path d="M 28 158 C 65 158 90 55 120 55 C 155 55 185 130 215 158"
          stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <!-- Optimal rate T* at peak (x=120, y=55) -->
    <circle cx="120" cy="55" r="4" fill="${C.new}"/>
    <line x1="120" y1="55" x2="120" y2="158" stroke="${C.new}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="122" y="53" fill="${C.new}" font-size="8" font-weight="bold">T*</text>
    <text x="114" y="168" fill="${C.new}" font-size="7">~50%</text>
    <!-- Region labels -->
    <text x="72" y="105" fill="${C.lras}" font-size="7.5" text-anchor="middle">↑ tax rate</text>
    <text x="72" y="115" fill="${C.lras}" font-size="7.5" text-anchor="middle">→ ↑ revenue</text>
    <text x="168" y="105" fill="${C.new}" font-size="7.5" text-anchor="middle">↑ tax rate</text>
    <text x="168" y="115" fill="${C.new}" font-size="7.5" text-anchor="middle">→ ↓ revenue</text>
  </svg>`;
}

function balancedBudgetDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,155,215,18,'National Income (Y)','G and T')}
    <!-- Revenue (T): rises with income — automatic stabiliser -->
    <path d="M 35 145 L 205 38" stroke="${C.lras}" stroke-width="2" fill="none"/>
    <text x="207" y="36" fill="${C.lras}" font-size="8" font-weight="bold">T (Revenue)</text>
    <!-- Expenditure (G): horizontal — autonomous (not income-dependent) -->
    <path d="M 35 88 L 205 88" stroke="${C.new}" stroke-width="2" fill="none"/>
    <text x="207" y="86" fill="${C.new}" font-size="8" font-weight="bold">G (Expenditure)</text>
    <!-- Intersection E: balanced budget point -->
    <circle cx="117" cy="88" r="4.5" fill="${C.sras}"/>
    <text x="120" y="86" fill="${C.sras}" font-size="9" font-weight="bold">E</text>
    <line x1="117" y1="88" x2="117" y2="155" stroke="${C.sras}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="113" y="165" fill="${C.sras}" font-size="7.5">Y*</text>
    <!-- Deficit / Surplus regions -->
    <text x="68" y="115" fill="${C.new}" font-size="7.5" text-anchor="middle">Budget</text>
    <text x="68" y="125" fill="${C.new}" font-size="7.5" text-anchor="middle">Deficit (G&gt;T)</text>
    <text x="170" y="62" fill="${C.lras}" font-size="7.5" text-anchor="middle">Budget</text>
    <text x="170" y="72" fill="${C.lras}" font-size="7.5" text-anchor="middle">Surplus (T&gt;G)</text>
  </svg>`;
}


function transmissionDiagram() {
  // Coordinates mapped from Transmission_Mechanism.svg.
  // Flow: Bank Rate → (Market Rate, Asset Prices, Expectations, Exchange Rates, Import Prices)
  //       → (Domestic Demand, External Demand) → Total Demand → Inflation
  // SVG uses arrow shapes (pentagons) pointing right. Recreated as box+arrow layout.
  const boxes=[
    {x:8,y:62,w:52,h:36,label:'↓ Bank\nRate',color:C.ad},
    {x:73,y:28,w:52,h:22,label:'↓ Market\nRates',color:C.lras},
    {x:73,y:54,w:52,h:22,label:'↑ Asset\nPrices',color:C.lras},
    {x:73,y:80,w:52,h:22,label:'Expectations',color:C.lras},
    {x:73,y:106,w:52,h:22,label:'↓ £ Exchange\nRates',color:C.lras},
    {x:73,y:132,w:52,h:22,label:'↓ Import\nPrices',color:C.lras},
    {x:140,y:62,w:52,h:36,label:'↑ Total\nDemand',color:C.new},
    {x:200,y:62,w:28,h:36,label:'↑ π',color:C.purple},
  ];
  let svg=`<svg viewBox="0 0 235 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('tarw','#475569')}</defs>`;
  boxes.forEach(b=>{
    const lines=b.label.split('\n');
    svg+=`<rect x="${b.x}" y="${b.y}" width="${b.w}" height="${b.h}" rx="4" fill="rgba(0,0,0,0.35)" stroke="${b.color}" stroke-width="1.5"/>`;
    lines.forEach((l,i)=>{
      svg+=`<text x="${b.x+b.w/2}" y="${b.y+b.h/2-(lines.length-1)*5+i*10+1}" fill="${b.color}" font-size="7.5" font-weight="bold" text-anchor="middle">${l}</text>`;
    });
  });
  // Arrows: Bank Rate → each channel
  const arrs=[[60,80,73,39],[60,80,73,65],[60,80,73,91],[60,80,73,117],[60,80,73,143],
               [125,39,140,74],[125,65,140,76],[125,91,140,80],[125,117,140,84],[125,143,140,88],
               [192,80,200,80]];
  arrs.forEach(([x1,y1,x2,y2])=>{
    svg+=`<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="${C.muted}" stroke-width="1.2" marker-end="url(#tarw)"/>`;
  });
  svg+=`<text x="115" y="170" fill="${C.label}" font-size="7" text-anchor="middle">↓ Bank Rate → ↑C + ↑I + ↓£(↑X) + ↑Asset prices → ↑Total Demand → ↑π</text>`;
  svg+=`</svg>`;
  return svg;
}

function moneySDDiagram() {
  // All three curves meet at a single equilibrium (Q*=120, r*=88):
  //   MS vertical: x=120 (fixed money supply — CB controls base money)
  //   MS(slope): M60,148 L170,38 — upward sloping (higher r → banks supply more)
  //     At x=120: y=148-(110/110)*60=88 ✓
  //   MD: M50,18 L190,158 — downward sloping demand (lower r → more money demanded)
  //     At x=120: y=18+(140/140)*70=88 ✓
  // All three meet exactly at (120,88) → r* is the single market equilibrium rate.
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,155,215,18,'Quantity of Money','Interest Rate %')}
    <!-- MS (slope): upward-sloping — higher interest rate incentivises more lending -->
    <path d="M 60 148 L 170 38" stroke="${C.lras}" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
    <text x="173" y="36" fill="${C.lras}" font-size="8.5" font-weight="bold">MS(slope)</text>
    <!-- MS (vertical): fixed money supply — central bank controls quantity -->
    <line x1="120" y1="22" x2="120" y2="155" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="122" y="20" fill="${C.lras}" font-size="8.5" font-weight="bold">MS(vertical)</text>
    <!-- MD: downward-sloping — lower interest rate increases money demand -->
    <path d="M 50 18 L 190 158" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="192" y="156" fill="${C.ad}" font-size="9" font-weight="bold">MD</text>
    <!-- Triple intersection at (120,88): MS(vertical) ∩ MS(slope) ∩ MD = equilibrium r* -->
    <circle cx="120" cy="88" r="4.5" fill="white" stroke="${C.ad}" stroke-width="2"/>
    <!-- Dashed line to interest rate axis -->
    <line x1="28" y1="88" x2="120" y2="88" stroke="${C.muted}" stroke-width="1.2" stroke-dasharray="4,3"/>
    <text x="18" y="91" fill="${C.label}" font-size="8.5" font-weight="bold">r*</text>
    <!-- Dashed line to quantity axis -->
    <line x1="120" y1="88" x2="120" y2="155" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
    <text x="116" y="167" fill="${C.label}" font-size="7.5">Q*</text>
  </svg>`;
}

function qeDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('qearw','#10b981')}</defs>
    ${axes(28,155,215,18,'Q Money','Rate %')}
    <line x1="95" y1="22" x2="95" y2="155" stroke="${C.lras}" stroke-width="2"/>
    <text x="97" y="20" fill="${C.lras}" font-size="9" font-weight="bold">MS₁</text>
    <line x1="145" y1="22" x2="145" y2="155" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="147" y="20" fill="${C.new}" font-size="9" font-weight="bold">MS₂</text>
    <path d="M 42 28 L 195 148" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="146" fill="${C.ad}" font-size="9">MD</text>
    <circle cx="95" cy="70" r="3.5" fill="white" opacity="0.9"/>
    <circle cx="145" cy="109" r="3.5" fill="${C.new}" opacity="0.9"/>
    <line x1="28" y1="70" x2="95" y2="70" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="28" y1="109" x2="145" y2="109" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="73" fill="${C.label}" font-size="8">I%₁</text>
    <text x="20" y="112" fill="${C.new}" font-size="8">I%₂</text>
    <line x1="100" y1="38" x2="138" y2="38" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#qearw)"/>
  </svg>`;
}

function qtDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('qtarw','#ef4444')}</defs>
    ${axes(28,155,215,18,'Q Money','Rate %')}
    <line x1="145" y1="22" x2="145" y2="155" stroke="${C.lras}" stroke-width="2"/>
    <text x="147" y="20" fill="${C.lras}" font-size="9" font-weight="bold">MS₁</text>
    <line x1="95" y1="22" x2="95" y2="155" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="97" y="20" fill="${C.new}" font-size="9" font-weight="bold">MS₂</text>
    <path d="M 42 28 L 195 148" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="146" fill="${C.ad}" font-size="9">MD</text>
    <circle cx="145" cy="109" r="3.5" fill="white" opacity="0.9"/>
    <circle cx="95" cy="70" r="3.5" fill="${C.new}" opacity="0.9"/>
    <line x1="28" y1="109" x2="145" y2="109" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="28" y1="70" x2="95" y2="70" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="112" fill="${C.label}" font-size="8">I%₁</text>
    <text x="20" y="73" fill="${C.new}" font-size="8">I%₂</text>
    <line x1="138" y1="38" x2="102" y2="38" stroke="${C.new}" stroke-width="1.5" marker-end="url(#qtarw)"/>
  </svg>`;
}

function liquidityTrapDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,155,215,18,'Q Money','Rate %')}
    <!-- MD with flat section at zero bound -->
    <path d="M 38 28 Q 78 55 100 100 Q 112 128 210 145" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="168" y="132" fill="${C.ad}" font-size="9" font-weight="bold">MD</text>
    <!-- Zero lower bound -->
    <line x1="28" y1="145" x2="215" y2="145" stroke="${C.new}" stroke-width="1.5" stroke-dasharray="5,3"/>
    <text x="30" y="141" fill="${C.new}" font-size="8">Zero lower bound</text>
    <!-- MS1 MS2 MS3 -->
    <line x1="95" y1="20" x2="95" y2="155" stroke="${C.lras}" stroke-width="2"/>
    <text x="97" y="18" fill="${C.lras}" font-size="9">MS₁</text>
    <line x1="140" y1="20" x2="140" y2="155" stroke="${C.sras}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="142" y="18" fill="${C.sras}" font-size="9">MS₂</text>
    <line x1="180" y1="20" x2="180" y2="155" stroke="${C.muted}" stroke-width="1.5" stroke-dasharray="3,3"/>
    <text x="182" y="18" fill="${C.muted}" font-size="9">MS₃</text>
    <!-- Eq points: MS1 at (95,91), MS2 near ZLB at (140,128), MS3 at (180,139) very close to ZLB -->
    <circle cx="95" cy="91" r="3" fill="white" opacity="0.9"/>
    <circle cx="140" cy="128" r="3" fill="${C.sras}" opacity="0.8"/>
    <circle cx="180" cy="139" r="3" fill="${C.muted}" opacity="0.7"/>
    <line x1="28" y1="91" x2="95" y2="91" stroke="${C.lras}" stroke-width="1" stroke-dasharray="3,2" opacity="0.7"/>
    <line x1="28" y1="128" x2="140" y2="128" stroke="${C.sras}" stroke-width="1" stroke-dasharray="3,2" opacity="0.5"/>
    <text x="20" y="94" fill="${C.label}" font-size="7">I%₁</text>
    <text x="20" y="131" fill="${C.sras}" font-size="7">I%₂</text>
  </svg>`;
}

function floatingXRDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('fxarw','#10b981')}</defs>
    ${axes(28,155,215,18,'Q £','P £ in $')}
    <path d="M 42 28 L 195 145" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="143" fill="${C.ad}" font-size="9" font-weight="bold">D₁</text>
    <path d="M 42 145 L 195 28" stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="197" y="26" fill="${C.sras}" font-size="9" font-weight="bold">S£</text>
    <circle cx="119" cy="87" r="4" fill="white" opacity="0.9"/>
    <line x1="28" y1="87" x2="119" y2="87" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="90" fill="${C.label}" font-size="8">ER₁</text>
    <!-- D2 shift right (appreciation) -->
    <path d="M 78 28 L 220 138" stroke="${C.lras}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="215" y="126" fill="${C.lras}" font-size="9">D₂</text>
    <circle cx="148" cy="62" r="4" fill="${C.lras}" opacity="0.9"/>
    <line x1="28" y1="62" x2="148" y2="62" stroke="${C.lras}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="20" y="65" fill="${C.lras}" font-size="8">ER₂</text>
    <line x1="117" y1="84" x2="145" y2="65" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#fxarw)"/>
  </svg>`;
}

function fixedXRDiagram() {
  // Coordinates mapped exactly from Fixed_Exchange_Rates.svg.
  // SVG: 2587×1529, translate(-36,-868). Axes: origin(301,2231)→rendered(265,1363)→mapped(46.8,133.7).
  // S line: (135.9,48.6)→(59.9,116.2). D line: (139.0,121.4)→(61.0,52.2).
  // Intersection at mapped (96.5,83.7). 
  // Fixed high peg: y=64.8. Fixed low peg: y=94.3.
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,148,212,16,'Q of £','P of £ in $')}
    <!-- Supply of £: upward sloping -->
    <line x1="59.9" y1="116.2" x2="135.9" y2="48.6" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="138.2" y="45.4" fill="${C.sras}" font-size="9" font-weight="bold">£S1</text>
    <!-- Demand for £: downward sloping -->
    <line x1="61.0" y1="52.2" x2="139.0" y2="121.4" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="142.4" y="123.0" fill="${C.ad}" font-size="9" font-weight="bold">$D1</text>
    <!-- Equilibrium intersection -->
    <circle cx="96.5" cy="83.7" r="3.5" fill="white" stroke="${C.muted}" stroke-width="1.5"/>
    <!-- Fixed at HIGH rate (above equilibrium) -->
    <line x1="28" y1="64.8" x2="212" y2="64.8" stroke="${C.purple}" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="33.6" y="62" fill="${C.purple}" font-size="7.5" font-weight="bold">P1</text>
    <text x="163.4" y="62" fill="${C.purple}" font-size="7.5">Fixed at a high rate</text>
    <!-- Fixed at LOW rate (below equilibrium) -->
    <line x1="28" y1="94.3" x2="212" y2="94.3" stroke="${C.new}" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="33.6" y="91.5" fill="${C.new}" font-size="7.5" font-weight="bold">P1</text>
    <text x="163.4" y="91.5" fill="${C.new}" font-size="7.5">Fixed at a low rate</text>
    <text x="31.5" y="24.8" fill="${C.label}" font-size="7" writing-mode="tb">P £ in $</text>
    <text x="159.2" y="143" fill="${C.label}" font-size="7">Quantity £</text>
  </svg>`;
}

function managedXRDiagram() {
  // Coordinates mapped exactly from Managed_Exchange_Rates.svg.
  // Same S and D lines as Fixed XR. Ceiling=high peg (y=64.8), Floor=low peg (y=94.3).
  // Market rate is free to move between ceiling and floor.
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,148,212,16,'Q of £','P of £ in $')}
    <!-- Supply of £: upward sloping -->
    <line x1="59.9" y1="116.2" x2="135.9" y2="48.6" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="138.2" y="45.4" fill="${C.sras}" font-size="9" font-weight="bold">£S1</text>
    <!-- Demand for £: downward sloping -->
    <line x1="61.0" y1="52.2" x2="139.0" y2="121.4" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="142.4" y="123.0" fill="${C.ad}" font-size="9" font-weight="bold">$D1</text>
    <!-- Market equilibrium inside band -->
    <circle cx="96.5" cy="83.7" r="3.5" fill="white" stroke="${C.muted}" stroke-width="1.5"/>
    <line x1="96.5" y1="83.7" x2="96.5" y2="148" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="28" y1="83.7" x2="96.5" y2="83.7" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="33.6" y="87.1" fill="${C.muted}" font-size="7.5">P1</text>
    <!-- Currency Ceiling -->
    <line x1="28" y1="64.8" x2="212" y2="64.8" stroke="${C.purple}" stroke-width="1.5" stroke-dasharray="6,3"/>
    <text x="163.4" y="62" fill="${C.purple}" font-size="7.5">Currency Ceiling</text>
    <!-- Currency Floor -->
    <line x1="28" y1="94.3" x2="212" y2="94.3" stroke="${C.new}" stroke-width="1.5" stroke-dasharray="6,3"/>
    <text x="163.4" y="91.5" fill="${C.new}" font-size="7.5">Currency Floor</text>
    <!-- Shaded band -->
    <rect x="28" y="64.8" width="184" height="29.5" fill="rgba(139,92,246,0.08)"/>
    <text x="31.5" y="24.8" fill="${C.label}" font-size="7">P £ in $</text>
    <text x="159.2" y="158" fill="${C.label}" font-size="7">Quantity £</text>
  </svg>`;
}

function jcurveDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <line x1="28" y1="88" x2="215" y2="88" stroke="${C.muted}" stroke-width="1.5"/>
    <line x1="28" y1="158" x2="28" y2="18" stroke="${C.muted}" stroke-width="1.5"/>
    <path d="M 30 88 L 62 88 Q 72 88 77 100 L 95 138 Q 105 155 120 130 L 160 58 L 200 38"
          stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <line x1="65" y1="18" x2="65" y2="158" stroke="${C.new}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="67" y="16" fill="${C.new}" font-size="8">Devaluation</text>
    <text x="10" y="84" fill="${C.lras}" font-size="8">Surplus</text>
    <text x="10" y="128" fill="${C.new}" font-size="8">Deficit</text>
    <text x="85" y="150" fill="${C.muted}" font-size="8">SR: inelastic</text>
    <text x="155" y="50" fill="${C.muted}" font-size="8">LR: elastic</text>
    <text x="88" y="160" fill="${C.muted}" font-size="7">(X+M&lt;1)</text>
    <text x="160" y="60" fill="${C.muted}" font-size="7">(X+M&gt;1)</text>
  </svg>`;
}

function tariffDiagram() {
  // Domestic equilibrium S∩D at approximately (112,85) - both tariff levels are BELOW this
  // WP = y130 (world price, low), WP+T = y105 (with tariff)
  // S at WP(y=130): x = 28+(155-130)/140*167 = 28+30 = 58 → Q1
  // S at WP+T(y=105): x = 28+(155-105)/140*167 = 28+60 = 88 → Q2
  // D at WP+T(y=105): x = 28+(105-15)/140*167 = 28+107 = 135 → Q3
  // D at WP(y=130): x = 28+(130-15)/140*167 = 28+137 = 165 → Q4
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(23,158,215,15,'Quantity','Price')}
    <!-- Domestic Supply -->
    <path d="M 28 155 L 195 15" stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="197" y="13" fill="${C.sras}" font-size="9" font-weight="bold">S</text>
    <!-- Domestic Demand -->
    <path d="M 28 15 L 195 155" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="153" fill="${C.ad}" font-size="9" font-weight="bold">D</text>
    <!-- Domestic equilibrium dot -->
    <circle cx="112" cy="85" r="3" fill="white" opacity="0.6"/>
    <!-- World Price horizontal (below domestic eq) -->
    <line x1="23" y1="130" x2="215" y2="130" stroke="${C.teal}" stroke-width="1.5" stroke-dasharray="5,3"/>
    <text x="217" y="133" fill="${C.teal}" font-size="8">WP</text>
    <!-- World Price + Tariff horizontal (also below domestic eq) -->
    <line x1="23" y1="105" x2="215" y2="105" stroke="${C.new}" stroke-width="2"/>
    <text x="217" y="108" fill="${C.new}" font-size="8">WP+T</text>
    <!-- Vertical quantity lines (from WP+T level down) -->
    <line x1="58" y1="130" x2="58" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="88" y1="105" x2="88" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="135" y1="105" x2="135" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="165" y1="130" x2="165" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="53" y="168" fill="${C.label}" font-size="7">Q1</text>
    <text x="83" y="168" fill="${C.label}" font-size="7">Q2</text>
    <text x="130" y="168" fill="${C.label}" font-size="7">Q3</text>
    <text x="160" y="168" fill="${C.label}" font-size="7">Q4</text>
    <!-- Producer surplus gain: trapezoid following S curve from Q1(WP) to Q2(WP+T) -->
    <!-- Polygon: (23,130)→(58,130)→(88,105)→(23,105) — left side is price axis, right follows S -->
    <polygon points="23,105 23,130 58,130 88,105" fill="rgba(245,158,11,0.35)"/>
    <text x="48" y="121" fill="${C.sras}" font-size="7.5" text-anchor="middle" font-weight="bold">PS gain</text>
    <!-- Govt revenue rectangle Q2 to Q3 between WP and WP+T -->
    <rect x="88" y="105" width="47" height="25" fill="rgba(16,185,129,0.3)"/>
    <text x="111" y="121" fill="${C.lras}" font-size="7" text-anchor="middle">Govt Rev.</text>
    <!-- DWL triangle 1: production inefficiency (Q1→Q2) -->
    <polygon points="58,130 88,130 88,105" fill="rgba(239,68,68,0.45)"/>
    <text x="75" y="124" fill="${C.new}" font-size="7" text-anchor="middle">DWL</text>
    <!-- DWL triangle 2: consumption inefficiency (Q3→Q4) -->
    <polygon points="135,105 135,130 165,130" fill="rgba(239,68,68,0.45)"/>
    <text x="150" y="124" fill="${C.new}" font-size="7" text-anchor="middle">DWL</text>
  </svg>`;
}



function compAdvDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('cadv','#8b5cf6')}</defs>
    <!-- Country A PPF -->
    <text x="47" y="16" fill="${C.ad}" font-size="9" font-weight="bold" text-anchor="middle">Country A</text>
    <line x1="10" y1="128" x2="88" y2="128" stroke="${C.muted}" stroke-width="1"/>
    <line x1="10" y1="128" x2="10" y2="24" stroke="${C.muted}" stroke-width="1"/>
    <!-- PPF: y-intercept (spec. Good Y) to x-intercept (spec. Good X) -->
    <line x1="10" y1="43" x2="83" y2="128" stroke="${C.ad}" stroke-width="2"/>
    <text x="85" y="128" fill="${C.ad}" font-size="7.5">X</text>
    <!-- Y-axis intercept dot: specialise in Good Y -->
    <circle cx="10" cy="43" r="3" fill="${C.lras}"/>
    <text x="13" y="41" fill="${C.lras}" font-size="7">Spec. Y</text>
    <!-- X-axis intercept dot -->
    <circle cx="83" cy="128" r="3" fill="${C.ad}"/>
    <!-- Country B PPF -->
    <text x="176" y="16" fill="${C.sras}" font-size="9" font-weight="bold" text-anchor="middle">Country B</text>
    <line x1="140" y1="128" x2="218" y2="128" stroke="${C.muted}" stroke-width="1"/>
    <line x1="140" y1="128" x2="140" y2="24" stroke="${C.muted}" stroke-width="1"/>
    <!-- PPF: y-intercept to x-intercept (spec. Good X) — flatter slope = lower OC of X -->
    <line x1="140" y1="55" x2="215" y2="128" stroke="${C.sras}" stroke-width="2"/>
    <text x="210" y="128" fill="${C.sras}" font-size="7.5">X</text>
    <!-- Y-axis intercept dot -->
    <circle cx="140" cy="55" r="3" fill="${C.muted}"/>
    <text x="143" y="53" fill="${C.muted}" font-size="7">Spec. Y</text>
    <!-- X-axis intercept dot: specialise in Good X -->
    <circle cx="215" cy="128" r="3" fill="${C.lras}"/>
    <text x="182" y="138" fill="${C.lras}" font-size="7">Spec. X ✓</text>
    <!-- Trade arrow -->
    <line x1="91" y1="95" x2="137" y2="95" stroke="${C.purple}" stroke-width="1.5" stroke-dasharray="3,2" marker-end="url(#cadv)"/>
    <text x="114" y="90" fill="${C.purple}" font-size="8" text-anchor="middle">TRADE</text>
    <!-- OC labels -->
    <text x="47" y="95" fill="${C.ad}" font-size="7" text-anchor="middle">Low OC of Y</text>
    <text x="176" y="82" fill="${C.sras}" font-size="7" text-anchor="middle">Low OC of X</text>
    <text x="115" y="155" fill="${C.muted}" font-size="7.5" text-anchor="middle">Ricardo: specialise where OC is lowest → both nations gain</text>
  </svg>`;
}

function cpfDiagram() {
  // Consumption Possibility Frontier (CPF) — Country A (UK) specialises in Wheat (Y)
  // Same numbers as compAdvGridDiagram:
  //   Country A: 200Y or 1000X → PPF slope = -200/1000 = -0.2Y per X
  //   Terms of trade: 1Y = 8X (between A's OC of 5X and B's OC of 15X per Y)
  //   Full specialisation: A produces 200Y, 0X (top-left corner of PPF)
  //   CPF through (0,200) at world price slope (-1/8 Y per X): extends to (1600X, 0)
  //   Consumption point: (960X, 80Y) — A trades 120Y for 960X, retains 80Y
  //
  // SVG axes: miAx(28,148,212,16,'Cloth (X)','Wheat (Y)')
  // Scale: x 0→1600 maps to 28→212 (184px / 1600 = 0.115px per X)
  //        y 0→200  maps to 148→16  (132px / 200  = 0.66px per Y)
  // sx(x) = 28 + x*(184/1600)    sy(y) = 148 - y*(132/200)
  //
  // Key points:
  //   PPF:               (28,16) → (143,148)
  //   Specialisation pt: (28,16)   [top-left, 200Y 0X]
  //   CPF:               (28,16) → (212,148)
  //   Autarky point:     (85.5,82) [500X, 100Y — typical pre-trade consumption]
  //   Consumption pt:    (138.4,95.2) [960X, 80Y — post-trade beyond PPF]
  //
  // Gains from trade = shaded region between CPF and PPF, right of specialisation
  return `<svg viewBox="0 0 220 168" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,148,212,16,'Cloth (X)','Wheat (Y)')}
    <!-- Axis tick labels -->
    <text x="140" y="157" fill="${C.label}" font-size="6" text-anchor="middle">1000</text>
    <text x="209" y="157" fill="${C.label}" font-size="6" text-anchor="middle">1600</text>
    <text x="22" y="19" fill="${C.label}" font-size="6" text-anchor="end">200</text>
    <text x="22" y="85" fill="${C.label}" font-size="6" text-anchor="end">100</text>
    <!-- Gains from trade region: shaded triangle between CPF and PPF -->
    <polygon points="28,16 143,148 212,148" fill="rgba(16,185,129,0.15)"/>
    <!-- PPF: Country A without trade — (0,200Y) to (1000X,0) -->
    <line x1="28" y1="16" x2="143" y2="148"
          stroke="${C.muted}" stroke-width="2.5" fill="none"/>
    <text x="148" y="152" fill="${C.muted}" font-size="8" font-weight="bold">PPF</text>
    <!-- CPF: through specialisation point at world price ratio 1Y=8X — (0,200Y) to (1600X,0) -->
    <line x1="28" y1="16" x2="212" y2="148"
          stroke="${C.lras}" stroke-width="2.5" fill="none" stroke-dasharray="6,3"/>
    <text x="208" y="143" fill="${C.lras}" font-size="8" font-weight="bold">CPF</text>
    <!-- Terms of trade annotation on CPF slope -->
    <text x="170" y="115" fill="${C.lras}" font-size="6.5" text-anchor="middle">ToT: 1Y = 8X</text>
    <!-- Autarky point: (500X, 100Y) — pre-trade consumption on PPF -->
    <circle cx="85.5" cy="82" r="4" fill="white" stroke="${C.muted}" stroke-width="1.8"/>
    <text x="62" y="78" fill="${C.muted}" font-size="7" font-weight="bold">Autarky</text>
    <line x1="69" y1="79" x2="81" y2="82" stroke="${C.muted}" stroke-width="1"/>
    <!-- Specialisation point: (0X, 200Y) — full spec in wheat -->
    <circle cx="28" cy="16" r="4" fill="${C.lras}"/>
    <text x="33" y="14" fill="${C.lras}" font-size="7" font-weight="bold">Specialise</text>
    <text x="33" y="22" fill="${C.lras}" font-size="6.5">(200Y, 0X)</text>
    <!-- Consumption point: (960X, 80Y) — beyond PPF, on CPF -->
    <circle cx="138.4" cy="95.2" r="4.5" fill="${C.teal}"/>
    <text x="143" y="89" fill="${C.teal}" font-size="7" font-weight="bold">Consumption</text>
    <text x="143" y="97" fill="${C.teal}" font-size="6.5">(80Y + 960X)</text>
    <!-- Dashed guides to consumption point -->
    <line x1="28" y1="95.2" x2="138.4" y2="95.2" stroke="${C.teal}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="138.4" y1="95.2" x2="138.4" y2="148" stroke="${C.teal}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="22" y="98" fill="${C.teal}" font-size="6" text-anchor="end">80</text>
    <text x="135" y="157" fill="${C.teal}" font-size="6" text-anchor="middle">960</text>
    <!-- Gains from trade label in shaded region -->
    <text x="162" y="135" fill="rgba(16,185,129,0.9)" font-size="6.5" text-anchor="middle" font-weight="bold">Gains</text>
    <text x="162" y="143" fill="rgba(16,185,129,0.9)" font-size="6.5" text-anchor="middle" font-weight="bold">from trade</text>
  </svg>`;
}

function compAdvGridDiagram() {
  const hdr='#1e3a5f', cell='#1a2744';
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <text x="115" y="12" fill="#f1f5f9" font-size="8.5" font-weight="bold" text-anchor="middle">Output per worker per day</text>
    <rect x="8" y="18" width="58" height="20" fill="${hdr}" rx="3"/>
    <rect x="68" y="18" width="72" height="20" fill="${hdr}" rx="3"/>
    <rect x="142" y="18" width="80" height="20" fill="${hdr}" rx="3"/>
    <text x="37" y="32" fill="${C.muted}" font-size="8" text-anchor="middle">Country</text>
    <text x="104" y="32" fill="${C.sras}" font-size="9" font-weight="bold" text-anchor="middle">Good Y</text>
    <text x="182" y="32" fill="${C.ad}" font-size="9" font-weight="bold" text-anchor="middle">Good X</text>
    <!-- Row A -->
    <rect x="8" y="40" width="58" height="20" fill="${cell}" rx="2"/>
    <rect x="68" y="40" width="72" height="20" fill="rgba(245,158,11,0.12)" rx="2"/>
    <rect x="142" y="40" width="80" height="20" fill="${cell}" rx="2"/>
    <text x="37" y="54" fill="#e2e8f0" font-size="9" text-anchor="middle">Country A</text>
    <text x="104" y="54" fill="${C.sras}" font-size="11" font-weight="bold" text-anchor="middle">200 ✓</text>
    <text x="182" y="54" fill="${C.muted}" font-size="11" text-anchor="middle">1,000</text>
    <!-- Row B -->
    <rect x="8" y="62" width="58" height="20" fill="${cell}" rx="2"/>
    <rect x="68" y="62" width="72" height="20" fill="${cell}" rx="2"/>
    <rect x="142" y="62" width="80" height="20" fill="rgba(59,130,246,0.12)" rx="2"/>
    <text x="37" y="76" fill="#e2e8f0" font-size="9" text-anchor="middle">Country B</text>
    <text x="104" y="76" fill="${C.muted}" font-size="11" text-anchor="middle">100</text>
    <text x="182" y="76" fill="${C.ad}" font-size="11" font-weight="bold" text-anchor="middle">1,500 ✓</text>
    <!-- OC section -->
    <text x="115" y="98" fill="${C.muted}" font-size="8" text-anchor="middle">Opportunity Costs (OC of Good Y):</text>
    <rect x="8" y="103" width="103" height="20" fill="rgba(245,158,11,0.1)" rx="3" stroke="${C.sras}" stroke-width="1"/>
    <text x="59" y="116" fill="${C.sras}" font-size="8" text-anchor="middle">A: 1Y = 5X (lower ✓)</text>
    <rect x="119" y="103" width="103" height="20" fill="rgba(59,130,246,0.1)" rx="3" stroke="${C.ad}" stroke-width="1"/>
    <text x="170" y="116" fill="${C.ad}" font-size="8" text-anchor="middle">B: 1Y = 15X (higher)</text>
    <!-- Gain comparison -->
    <rect x="8" y="130" width="214" height="32" fill="rgba(16,185,129,0.1)" rx="5" stroke="${C.lras}" stroke-width="1"/>
    <text x="115" y="142" fill="${C.lras}" font-size="8" font-weight="bold" text-anchor="middle">Without trade: 150Y + 1,250X total</text>
    <text x="115" y="155" fill="${C.lras}" font-size="8" font-weight="bold" text-anchor="middle">With specialisation: 200Y + 1,500X → net gain!</text>
  </svg>`;
}

function prefTradeAgreementDiagram() {
  // Preferential Trade Agreement (PTA) — tariff reduction, not full removal
  // S: M28 155 L195 15  x_S(y)=28+(155-y)/0.838
  // D: M28 15  L195 155 x_D(y)=28+(y-15)/0.838
  // Domestic eq: (111.5, 85)
  //
  // WP+Full Tariff (pre-PTA):  y=105 → Q1a=87.7, Q2a=135.4
  // WP+Pref Tariff (post-PTA): y=128 → Q1b=60.2, Q2b=162.8
  // WP no tariff (reference):  y=148 → dashed — not achieved
  //
  // A: producer surplus loss. B+D: net welfare gains. C: reduced tariff revenue.
  return `<svg viewBox="0 0 262 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(23,158,215,15,'Quantity','Price')}
    <path d="M 28 155 L 195 15" stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="197" y="13" fill="${C.sras}" font-size="9" font-weight="bold">S</text>
    <path d="M 28 15 L 195 155" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="153" fill="${C.ad}" font-size="9" font-weight="bold">D</text>
    <!-- WP no tariff — dashed reference -->
    <line x1="23" y1="148" x2="215" y2="148" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="217" y="151" fill="${C.muted}" font-size="7">WP</text>
    <!-- WP + Full Tariff (before PTA) -->
    <line x1="23" y1="105" x2="215" y2="105" stroke="${C.purple}" stroke-width="1.8" stroke-dasharray="5,3"/>
    <text x="217" y="108" fill="${C.purple}" font-size="7.5" font-weight="bold">WP+T</text>
    <!-- WP + Preferential Tariff (after PTA) -->
    <line x1="23" y1="128" x2="215" y2="128" stroke="${C.lras}" stroke-width="2"/>
    <text x="217" y="131" fill="${C.lras}" font-size="7.5" font-weight="bold">WP+PT</text>
    <!-- Area A: producer surplus loss -->
    <polygon points="23,105 23,128 60,128 88,105" fill="rgba(239,68,68,0.2)"/>
    <text x="46" y="120" fill="${C.new}" font-size="7.5" text-anchor="middle" font-weight="bold">A</text>
    <!-- Area C: reduced tariff revenue -->
    <rect x="88" y="105" width="47" height="23" fill="rgba(139,92,246,0.2)"/>
    <text x="111" y="120" fill="${C.purple}" font-size="7.5" text-anchor="middle" font-weight="bold">C</text>
    <!-- Triangle B: net welfare gain (production) -->
    <polygon points="60,128 88,128 88,105" fill="rgba(16,185,129,0.55)"/>
    <text x="74" y="125" fill="${C.lras}" font-size="7.5" text-anchor="middle" font-weight="bold">B</text>
    <!-- Triangle D: net welfare gain (consumption) -->
    <polygon points="135,105 135,128 163,128" fill="rgba(16,185,129,0.55)"/>
    <text x="149" y="125" fill="${C.lras}" font-size="7.5" text-anchor="middle" font-weight="bold">D</text>
    <!-- Quantity verticals -->
    <line x1="60" y1="128" x2="60" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="88" y1="105" x2="88" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="135" y1="105" x2="135" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="163" y1="128" x2="163" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="55" y="167" fill="${C.lras}" font-size="6.5">Q1b</text>
    <text x="83" y="167" fill="${C.purple}" font-size="6.5">Q1a</text>
    <text x="130" y="167" fill="${C.purple}" font-size="6.5">Q2a</text>
    <text x="158" y="167" fill="${C.lras}" font-size="6.5">Q2b</text>
  </svg>`;
}

function tradeCreationDiagram() {
  // Trade creation: joins FTA, removes tariff on member imports
  // Both WP+T and WP-FT are BELOW domestic equilibrium (~y=85)
  // WP+T = y115 (before FTA): S at Q2(x=76), D at Q3(x=147)
  // WP-FT = y138 (after FTA, lower price): S at Q1(x=48), D at Q4(x=175)
  // Consumer surplus gain = whole area between WP-FT and WP+T from Q1 to Q4
  // Area A: producer loss (Q1→Q2 strip). B,D: DWL triangles (net welfare gain). C: ex-govt revenue now consumer gain.
  return `<svg viewBox="0 0 262 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(23,158,215,15,'Quantity','Price')}
    <path d="M 28 155 L 195 15" stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="197" y="13" fill="${C.sras}" font-size="9" font-weight="bold">S</text>
    <path d="M 28 15 L 195 155" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="153" fill="${C.ad}" font-size="9" font-weight="bold">D</text>
    <!-- Domestic equilibrium marker -->
    <circle cx="112" cy="85" r="3" fill="white" opacity="0.5"/>
    <!-- WP+T (before FTA) — below domestic eq -->
    <line x1="23" y1="115" x2="215" y2="115" stroke="${C.muted}" stroke-width="1.5" stroke-dasharray="4,3"/>
    <text x="217" y="118" fill="${C.muted}" font-size="8">WP+T</text>
    <!-- WP-FT (after joining FTA) — even lower -->
    <line x1="23" y1="138" x2="215" y2="138" stroke="${C.lras}" stroke-width="2"/>
    <text x="217" y="141" fill="${C.lras}" font-size="8">WP-FT</text>
    <!-- Vertical quantity lines -->
    <line x1="48" y1="138" x2="48" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="76" y1="115" x2="76" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="147" y1="115" x2="147" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="175" y1="138" x2="175" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="43" y="168" fill="${C.label}" font-size="7">Q1</text>
    <text x="71" y="168" fill="${C.label}" font-size="7">Q2</text>
    <text x="142" y="168" fill="${C.label}" font-size="7">Q3</text>
    <text x="170" y="168" fill="${C.label}" font-size="7">Q4</text>
    <!-- Area A: producer surplus loss — follows S curve from Q1 to Q2 -->
    <polygon points="23,115 23,138 48,138 76,115" fill="rgba(239,68,68,0.2)"/>
    <text x="48" y="130" fill="${C.new}" font-size="7.5" text-anchor="middle" font-weight="bold">A</text>
    <!-- Area C: former govt revenue, now consumer gain -->
    <rect x="76" y="115" width="71" height="23" fill="rgba(59,130,246,0.2)"/>
    <text x="111" y="130" fill="${C.ad}" font-size="8" text-anchor="middle" font-weight="bold">C</text>
    <!-- Triangle B: NET WELFARE GAIN (production) -->
    <polygon points="48,138 76,138 76,115" fill="rgba(16,185,129,0.55)"/>
    <text x="63" y="136" fill="${C.lras}" font-size="7.5" text-anchor="middle" font-weight="bold">B</text>
    <!-- Triangle D: NET WELFARE GAIN (consumption) -->
    <polygon points="147,115 147,138 175,138" fill="rgba(16,185,129,0.55)"/>
    <text x="160" y="136" fill="${C.lras}" font-size="7.5" text-anchor="middle" font-weight="bold">D</text>
  </svg>`;
}

function tradeDiversionDiagram() {
  // Trade diversion: all price levels BELOW domestic equilibrium (~y=85)
  // WP₁ (efficient non-member) = y142 (lowest price → highest y in SVG)
  // CU price (member) = y122 (middle)
  // WP+ext.T (prohibitive tariff) = y102 (just below domestic eq)
  // At WP₁: S at Q1(x=44), D at Q4(x=180)
  // At CU price: S at Q2(x=67), D at Q3(x=155)
  return `<svg viewBox="0 0 262 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(23,158,215,15,'Quantity','Price')}
    <path d="M 28 155 L 195 15" stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="197" y="13" fill="${C.sras}" font-size="9" font-weight="bold">S</text>
    <path d="M 28 15 L 195 155" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="197" y="153" fill="${C.ad}" font-size="9" font-weight="bold">D</text>
    <!-- Domestic equilibrium (all prices below this) -->
    <circle cx="112" cy="85" r="3" fill="white" opacity="0.5"/>
    <!-- WP+ext.T — just below domestic eq -->
    <line x1="23" y1="102" x2="215" y2="102" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,3"/>
    <text x="217" y="105" fill="${C.muted}" font-size="7">WP+ext.T</text>
    <!-- CU member price — middle -->
    <line x1="23" y1="122" x2="215" y2="122" stroke="${C.sras}" stroke-width="2"/>
    <text x="217" y="125" fill="${C.sras}" font-size="8">CU price</text>
    <!-- WP₁ efficient non-member — lowest price -->
    <line x1="23" y1="142" x2="215" y2="142" stroke="${C.lras}" stroke-width="1.5" stroke-dasharray="5,3"/>
    <text x="217" y="145" fill="${C.lras}" font-size="8">WP₁</text>
    <!-- Quantity verticals: Q1(44) at WP1, Q2(67) at CU, Q3(155) at CU, Q4(180) at WP1 -->
    <line x1="44" y1="142" x2="44" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="67" y1="122" x2="67" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="155" y1="122" x2="155" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="180" y1="142" x2="180" y2="158" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="39" y="168" fill="${C.label}" font-size="7">Q1</text>
    <text x="62" y="168" fill="${C.label}" font-size="7">Q2</text>
    <text x="150" y="168" fill="${C.label}" font-size="7">Q3</text>
    <text x="175" y="168" fill="${C.label}" font-size="7">Q4</text>
    <!-- Net welfare analysis: forced from WP1 to CU price -->
    <!-- Producer gain: trapezoid following S from Q1(WP1) to Q2(CU price) -->
    <polygon points="23,122 23,142 44,142 67,122" fill="rgba(245,158,11,0.25)"/>
    <text x="42" y="135" fill="${C.sras}" font-size="6.5" text-anchor="middle">PS gain</text>
    <!-- DWL triangles (trade diversion welfare loss) -->
    <polygon points="44,142 67,142 67,122" fill="rgba(239,68,68,0.45)"/>
    <text x="57" y="139" fill="${C.new}" font-size="6.5" text-anchor="middle">B</text>
    <polygon points="155,122 155,142 180,142" fill="rgba(239,68,68,0.45)"/>
    <text x="167" y="139" fill="${C.new}" font-size="6.5" text-anchor="middle">D</text>
    <!-- Former consumer gain (now lost) — centre strip -->
    <rect x="67" y="122" width="88" height="20" fill="rgba(59,130,246,0.15)"/>
    <text x="111" y="135" fill="${C.ad}" font-size="6.5" text-anchor="middle">Consumer loss</text>
  </svg>`;
}

function lorenzDiagram() {
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,152,215,18,'% Households','% Income')}
    <!-- Perfect equality line -->
    <line x1="28" y1="152" x2="215" y2="18" stroke="${C.lras}" stroke-width="1.5" stroke-dasharray="5,3"/>
    <text x="155" y="42" fill="${C.lras}" font-size="8">Perfect Equality</text>
    <!-- Lorenz curve 1 -->
    <path d="M 28 152 Q 90 145 130 115 Q 165 85 215 18" stroke="${C.ad}" stroke-width="2.5" fill="none"/>
    <text x="140" y="118" fill="${C.ad}" font-size="9" font-weight="bold">Lorenz₁</text>
    <!-- Lorenz curve 2 - worse inequality -->
    <path d="M 28 152 Q 110 150 148 128 Q 183 105 215 18" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="155" y="133" fill="${C.new}" font-size="9">Lorenz₂ (↑ inequality)</text>
    <!-- Gini gap annotation -->
    <text x="75" y="105" fill="${C.muted}" font-size="8">Gini gap</text>
    <text x="32" y="170" fill="${C.muted}" font-size="7.5">Gini=0: perfect equality. Gini=1: maximum inequality.</text>
    <!-- Axis labels -->
    <text x="28" y="165" fill="${C.label}" font-size="8">0%</text>
    <text x="207" y="165" fill="${C.label}" font-size="8">100%</text>
  </svg>`;
}





function adAsPhillipsDiagram() {
  // Coordinates mapped exactly from Relationship_between_AD_AS_and_Phillips_Curve.svg.
  // SVG: 4207×1863, translate(-124,-298). Two panels side by side.
  // LEFT (AD-AS): axes origin(28,148)→(212,148)→(28,16). Right panel same coordinates (separate panel).
  // AS curve: M(39.3,123.2) C(71.6,123.5)(103.9,123.7)(126.7,117.0) C(149.5,110.2)(166.6,98.2)(176.4,82.7) C(186.1,67.3)(185.8,45.9)(185.4,24.4)
  // AD1: (39.3,27.3)→(197.9,139.7). AD2: (87.7,26.8)→(205.7,112.6) [shifted right]
  // P1 y=106.5, Q1 x=149.2. P2 y=89.5, Q2 x=170.4
  // RIGHT panel (Phillips): LRPC vertical at x=130.4. SRPC1 and SRPC2.
  // Uses two separate viewBoxes as a two-panel SVG
  const W=220, H=160, panW=105, gap=10;
  return `<svg viewBox="0 0 ${W} ${H}" xmlns="http://www.w3.org/2000/svg">
    <!-- LEFT PANEL: AD-AS -->
    <text x="${panW/2+5}" y="10" fill="${C.muted}" font-size="7" text-anchor="middle" font-weight="bold">AD-AS Model</text>
    <!-- Left axes -->
    <line x1="18" y1="18" x2="18" y2="145" stroke="${C.muted}" stroke-width="1.5"/>
    <line x1="18" y1="145" x2="${panW}" y2="145" stroke="${C.muted}" stroke-width="1.5"/>
    <text x="10" y="15" fill="${C.label}" font-size="6">P</text>
    <text x="${panW+2}" y="148" fill="${C.label}" font-size="6">Y</text>
    <!-- AS curve scaled to left panel: compress x from 28→185 to 18→105, y from 16→148 to 18→145 -->
    <!-- Scale: x'= 18+(x-18)/(185-18)*87, y'=18+(y-16)/(148-16)*127 -->
    <path d="M25 118 C40 118 56 119 68 113 C80 107 89 99 95 89 C100 79 100 66 100 53"
          stroke="${C.sras}" stroke-width="2" fill="none"/>
    <text x="97" y="50" fill="${C.sras}" font-size="8" font-weight="bold">AS</text>
    <!-- AD1 -->
    <path d="M25 36 L97 136" stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="92" y="133" fill="${C.ad}" font-size="7" font-weight="bold">AD1</text>
    <!-- AD2 (shifted right — ↑AD) -->
    <path d="M50 35 L${panW+2} 113" stroke="${C.ad}" stroke-width="2" stroke-dasharray="4,2" fill="none"/>
    <text x="97" y="110" fill="${C.ad}" font-size="7">AD2</text>
    <!-- P1 horizontal dashed -->
    <line x1="18" y1="106" x2="82" y2="106" stroke="${C.lras}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="10" y="108" fill="${C.lras}" font-size="6">P1</text>
    <line x1="82" y1="106" x2="82" y2="145" stroke="${C.lras}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="78" y="152" fill="${C.lras}" font-size="6">Y1</text>
    <!-- P2 horizontal dashed -->
    <line x1="18" y1="90" x2="95" y2="90" stroke="#f59e0b" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="10" y="92" fill="#f59e0b" font-size="6">P2</text>
    <line x1="95" y1="90" x2="95" y2="145" stroke="#f59e0b" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="91" y="152" fill="#f59e0b" font-size="6">Y2</text>
    <!-- Equilibrium dots on AS curve -->
    <circle cx="82" cy="106" r="3" fill="white" stroke="${C.lras}" stroke-width="1.5"/>
    <circle cx="95" cy="90" r="3" fill="#f59e0b"/>

    <!-- RIGHT PANEL: Phillips Curve -->
    <text x="${panW+gap+panW/2}" y="10" fill="${C.muted}" font-size="7" text-anchor="middle" font-weight="bold">Phillips Curve</text>
    <!-- Right axes -->
    <line x1="${panW+gap+8}" y1="18" x2="${panW+gap+8}" y2="145" stroke="${C.muted}" stroke-width="1.5"/>
    <line x1="${panW+gap+8}" y1="145" x2="${W-4}" y2="145" stroke="${C.muted}" stroke-width="1.5"/>
    <text x="${panW+gap+2}" y="15" fill="${C.label}" font-size="6">π%</text>
    <text x="${W-12}" y="148" fill="${C.label}" font-size="6">U%</text>
    <!-- LRPC vertical at NRU -->
    <line x1="${panW+gap+58}" y1="18" x2="${panW+gap+58}" y2="145" stroke="${C.lras}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="${panW+gap+52}" y="15" fill="${C.lras}" font-size="7" font-weight="bold">LRPC</text>
    <text x="${panW+gap+52}" y="152" fill="${C.lras}" font-size="6" text-anchor="middle">NRU</text>
    <!-- SRPC1 (lower, after AD2 shift → ↑inflation) -->
    <path d="M${panW+gap+12} 38 C${panW+gap+22} 57 ${panW+gap+36} 80 ${panW+gap+55} 94 C${panW+gap+74} 108 ${panW+gap+90} 116 ${panW+gap+106} 124"
          stroke="${C.ad}" stroke-width="2" fill="none"/>
    <text x="${panW+gap+98}" y="121" fill="${C.ad}" font-size="7" font-weight="bold">SRPC1</text>
    <!-- SRPC2 (shifted left by supply-side) -->
    <path d="M${panW+gap+12} 25 C${panW+gap+22} 42 ${panW+gap+36} 63 ${panW+gap+52} 76 C${panW+gap+68} 89 ${panW+gap+86} 100 ${panW+gap+104} 109"
          stroke="${C.sras}" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <text x="${panW+gap+96}" y="107" fill="${C.sras}" font-size="7">SRPC2</text>
  </svg>`;
}

function demandPullDiagram() {
  // Coordinates mapped exactly from demand_pull_inflation.svg.
  // SVG: 2462×1826, translate(-687,-331).
  // Axes rendered: x 354→2341 (range 1987), y 9→1533 (range 1524).
  // ViewBox: left=28, bottom=148, right=210, top=20. Scale: x/1987×182+28, y/1524×128+20.
  //
  // SRAS: matrix(-1 0 0 1 2599.34 673) on M0,0 L1332,1095
  //   → rendered (1912,342)→(580,1437) → mapped (170.6,47.9)→(48.7,139.8)
  // AD1: M2774,1587 L1264,524 → rendered (2087,1256)→(577,193) → mapped (186.7,124.6)→(48.4,35.5)
  // AD2: M2505,1782 L1191,828 → rendered (1818,1451)→(504,497) → mapped (161.9,141.0)→(41.7,60.9)
  // Y1 dashed: rendered x=1161, top y=963 → mapped x=101.8, y=100.0
  // Y2 dashed: rendered x=1395, top y=774 → mapped x=123.3, y=84.1
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,148,210,20,'Real National Output','Price level')}
    <!-- SRAS: upward-sloping straight line -->
    <line x1="48.7" y1="139.8" x2="170.6" y2="47.9" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="172" y="46" fill="${C.sras}" font-size="8" font-weight="bold">SRAS</text>
    <!-- AD1: original (left curve — lower income, lower price) -->
    <line x1="41.7" y1="60.9" x2="161.9" y2="141.0" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="153" y="149" fill="${C.ad}" font-size="9" font-weight="bold">AD₁</text>
    <!-- AD2: rightward shift → demand-pull inflation -->
    <line x1="48.4" y1="35.5" x2="186.7" y2="124.6" stroke="${C.new}" stroke-width="2.5"/>
    <text x="178" y="132" fill="${C.new}" font-size="9" font-weight="bold">AD₂</text>
    <!-- E1: AD1 ∩ SRAS — dashed lines to P₁, Y₁ -->
    <circle cx="101.8" cy="100.0" r="3.5" fill="${C.ad}"/>
    <line x1="28" y1="100.0" x2="101.8" y2="100.0" stroke="${C.ad}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="101.8" y1="100.0" x2="101.8" y2="148" stroke="${C.ad}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="17" y="103" fill="${C.ad}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="97" y="157" fill="${C.ad}" font-size="7.5" font-weight="bold">Y₁</text>
    <!-- E2: AD2 ∩ SRAS — dashed lines to P₂, Y₂ -->
    <circle cx="123.3" cy="84.1" r="3.5" fill="${C.new}"/>
    <line x1="28" y1="84.1" x2="123.3" y2="84.1" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="123.3" y1="84.1" x2="123.3" y2="148" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="17" y="87" fill="${C.new}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="119" y="157" fill="${C.new}" font-size="7.5" font-weight="bold">Y₂</text>
  </svg>`;
}


function multiplierPosDiagram() {
  // AS path: identical to keynesianDiagram — M 35 128 L 110 128 Q 145 128 160 95 L 162 28
  // Axes: axes(28,162,215,18) — matches Keynesian diagram exactly
  //
  // AD lines (slope=0.55) solved against AS sections:
  //   E1 = (85,128)  — flat section, verified y=128 ✓
  //   E2 = (137,122) — quadratic bezier at t=0.439, error=0.0000 ✓
  //   E3 = (162,51)  — steep section at x=162, error=0.0000 ✓
  //
  //   AD1: x1=28 y1=96.7 x2=146.8 y2=162
  //   AD2: x1=28 y1=61.7 x2=210.4 y2=162
  //   AD3: x1=103 y1=18  x2=215   y2=80
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,162,215,18,'Real GDP','PL')}
    <!-- Keynesian AS: identical path to keynesianDiagram -->
    <path d="M 35 128 L 110 128 Q 145 128 160 95 L 162 28"
          stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="164" y="26" fill="${C.sras}" font-size="9" font-weight="bold">AS</text>
    <!-- AD1: through E1=(85,128) on flat section -->
    <line x1="28" y1="96.7" x2="146.8" y2="162" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="135" y="161" fill="${C.ad}" font-size="8.5" font-weight="bold">AD₁</text>
    <!-- AD2: through E2=(137,122) on curved section -->
    <line x1="28" y1="61.7" x2="210.4" y2="162" stroke="${C.ad}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="199" y="161" fill="${C.ad}" font-size="8.5" font-weight="bold">AD₂</text>
    <!-- AD3: through E3=(162,51) on steep section -->
    <line x1="103" y1="18" x2="215" y2="80" stroke="${C.new}" stroke-width="2.5"/>
    <text x="204" y="79" fill="${C.new}" font-size="8.5" font-weight="bold">AD₃</text>
    <!-- E1: (85,128) — flat section -->
    <circle cx="85" cy="128" r="3.5" fill="${C.ad}"/>
    <line x1="28" y1="128" x2="85" y2="128" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <line x1="85" y1="128" x2="85" y2="162" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="17" y="131" fill="${C.ad}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="81" y="171" fill="${C.ad}" font-size="7.5" font-weight="bold">Y₁</text>
    <!-- E2: (137,122) — curved section -->
    <circle cx="137" cy="122" r="3.5" fill="${C.ad}"/>
    <line x1="28" y1="122" x2="137" y2="122" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <line x1="137" y1="122" x2="137" y2="162" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="17" y="125" fill="${C.ad}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="133" y="171" fill="${C.ad}" font-size="7.5" font-weight="bold">Y₂</text>
    <!-- E3: (162,51) — steep section -->
    <circle cx="162" cy="51" r="3.5" fill="${C.new}"/>
    <line x1="28" y1="51" x2="162" y2="51" stroke="${C.new}" stroke-width="1" stroke-dasharray="4,3"/>
    <line x1="162" y1="51" x2="162" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="17" y="54" fill="${C.new}" font-size="7.5" font-weight="bold">P₃</text>
    <text x="158" y="171" fill="${C.new}" font-size="7.5" font-weight="bold">Y₃</text>
  </svg>`;
}

function multiplierNegDiagram() {
  // Same AS path and intersections as multiplierPosDiagram — roles reversed.
  // AD starts at E3 (near full capacity) and contracts to E1 (spare capacity).
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    ${axes(28,162,215,18,'Real GDP','PL')}
    <!-- Keynesian AS: identical path to keynesianDiagram -->
    <path d="M 35 128 L 110 128 Q 145 128 160 95 L 162 28"
          stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="164" y="26" fill="${C.sras}" font-size="9" font-weight="bold">AS</text>
    <!-- AD1: through E3=(162,51) on steep section — starting near full capacity -->
    <line x1="103" y1="18" x2="215" y2="80" stroke="${C.new}" stroke-width="2.5"/>
    <text x="204" y="79" fill="${C.new}" font-size="8.5" font-weight="bold">AD₁</text>
    <!-- AD2: through E2=(137,122) on curved section -->
    <line x1="28" y1="61.7" x2="210.4" y2="162" stroke="${C.ad}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="199" y="161" fill="${C.ad}" font-size="8.5" font-weight="bold">AD₂</text>
    <!-- AD3: through E1=(85,128) on flat section — multiplied contraction -->
    <line x1="28" y1="96.7" x2="146.8" y2="162" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="135" y="161" fill="${C.ad}" font-size="8.5" font-weight="bold">AD₃</text>
    <!-- E1: (162,51) — steep section, high PL -->
    <circle cx="162" cy="51" r="3.5" fill="${C.new}"/>
    <line x1="28" y1="51" x2="162" y2="51" stroke="${C.new}" stroke-width="1" stroke-dasharray="4,3"/>
    <line x1="162" y1="51" x2="162" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="17" y="54" fill="${C.new}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="158" y="171" fill="${C.new}" font-size="7.5" font-weight="bold">Y₁</text>
    <!-- E2: (137,122) — curved section -->
    <circle cx="137" cy="122" r="3.5" fill="${C.ad}"/>
    <line x1="28" y1="122" x2="137" y2="122" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <line x1="137" y1="122" x2="137" y2="162" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="17" y="125" fill="${C.ad}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="133" y="171" fill="${C.ad}" font-size="7.5" font-weight="bold">Y₂</text>
    <!-- E3: (85,128) — flat section, spare capacity -->
    <circle cx="85" cy="128" r="3.5" fill="${C.ad}"/>
    <line x1="28" y1="128" x2="85" y2="128" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <line x1="85" y1="128" x2="85" y2="162" stroke="${C.ad}" stroke-width="1" stroke-dasharray="4,3"/>
    <text x="17" y="131" fill="${C.ad}" font-size="7.5" font-weight="bold">P₃</text>
    <text x="81" y="171" fill="${C.ad}" font-size="7.5" font-weight="bold">Y₃</text>
  </svg>`;
}


function classicalLrasRightDiagram() {
  // Classical LRAS shift RIGHT — long-run economic growth
  // Mapped exactly from LRAS_Shift_Right.svg (2468×1755, translate(-716,-390))
  // Axes origin rendered (373,1556), xs=0.09412, ys=0.09449 → VB origin (28,162)
  //
  // NO SRAS — diagram focuses on AD and LRAS only (as per uploaded SVG)
  //
  // AD:    M40.8 34.0 L168.1 150.1  (exact from SVG)
  // LRAS₁: x=125.7  (original potential output — SVG "LRAS2" left line)
  // LRAS₂: x=159.2  (expanded potential output — SVG "LRAS1" right line)
  //
  // E1 = LRAS₁ ∩ AD: (125.7, 111.4)  — verified ✓
  // E2 = LRAS₂ ∩ AD: (159.2, 141.9)  — verified ✓
  // P1_svg=111.4 → P2_svg=141.9: P2 lower on page → lower price level ✓ (deflation/growth)
  // Y1=125.7 → Y2=159.2: more real output ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('clrarw','#10b981')}</defs>
    ${axes(28,162,215,18,'Real GDP (Y)','Price Level')}
    <!-- AD: exact from SVG — M40.8 34.0 L168.1 150.1 -->
    <line x1="40.8" y1="34" x2="168.1" y2="150.1" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="170" y="150" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- LRAS₁: x=125.7 (original potential output) -->
    <line x1="125.7" y1="18" x2="125.7" y2="162" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="118" y="16" fill="${C.lras}" font-size="8" font-weight="bold">LRAS₁</text>
    <!-- LRAS₂: x=159.2 (expanded potential output) -->
    <line x1="159.2" y1="18" x2="159.2" y2="162" stroke="${C.new}" stroke-width="2.5" stroke-dasharray="7,4"/>
    <text x="152" y="16" fill="${C.new}" font-size="8" font-weight="bold">LRAS₂</text>
    <!-- Shift arrows LRAS₁ → LRAS₂ -->
    <line x1="128.5" y1="36" x2="156" y2="36" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#clrarw)"/>
    <line x1="128.5" y1="48" x2="156" y2="48" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#clrarw)"/>
    <!-- E1: LRAS₁ ∩ AD = (125.7, 111.4) — exact from SVG ✓ -->
    <circle cx="125.7" cy="111.4" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <line x1="28" y1="111.4" x2="125.7" y2="111.4" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="125.7" y1="111.4" x2="125.7" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="114" fill="${C.label}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="121" y="171" fill="${C.label}" font-size="7.5" font-weight="bold">YF₁</text>
    <!-- E2: LRAS₂ ∩ AD = (159.2, 141.9) — exact from SVG ✓ -->
    <circle cx="159.2" cy="141.9" r="4" fill="${C.new}"/>
    <line x1="28" y1="141.9" x2="159.2" y2="141.9" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="159.2" y1="141.9" x2="159.2" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="145" fill="${C.new}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="155" y="171" fill="${C.new}" font-size="7.5" font-weight="bold">YF₂</text>
  </svg>`;
}


function classicalLrasLeftDiagram() {
  // Classical LRAS shift LEFT — decline in productive capacity
  // Mapped exactly from LRAS_Shift_Left.svg (2468×1755, translate(-716,-394))
  // Same axis scaling as LRAS_Shift_Right: xs=0.09412, ys=0.09449
  //
  // NO SRAS — AD and LRAS only (matching uploaded SVG)
  //
  // AD:    M40.8 34.1 L168.1 150.1  (identical to right-shift diagram)
  // LRAS₁: x=159.2  (original potential output — SVG "LRAS1", right line)
  // LRAS₂: x=125.7  (reduced potential output — SVG "LRAS2", left line)
  //
  // E1 = LRAS₁ ∩ AD: (159.2, 141.9)  — verified ✓
  // E2 = LRAS₂ ∩ AD: (125.7, 111.4)  — verified ✓
  // E2.y=111.4 < E1.y=141.9 → E2 higher on page → higher price level ✓ (capacity decline)
  // Y1=159.2 → Y2=125.7: less real output ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('cllarw','#ef4444')}</defs>
    ${axes(28,162,215,18,'Real GDP (Y)','Price Level')}
    <!-- AD: exact from SVG — M40.8 34.1 L168.1 150.1 -->
    <line x1="40.8" y1="34.1" x2="168.1" y2="150.1" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="170" y="150" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- LRAS₁: x=159.2 (original potential output) -->
    <line x1="159.2" y1="18" x2="159.2" y2="162" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="152" y="16" fill="${C.lras}" font-size="8" font-weight="bold">LRAS₁</text>
    <!-- LRAS₂: x=125.7 (reduced potential output — shifted left) -->
    <line x1="125.7" y1="18" x2="125.7" y2="162" stroke="${C.new}" stroke-width="2.5" stroke-dasharray="7,4"/>
    <text x="118" y="16" fill="${C.new}" font-size="8" font-weight="bold">LRAS₂</text>
    <!-- Shift arrows LRAS₁ → LRAS₂ (leftward) -->
    <line x1="156" y1="36" x2="128.5" y2="36" stroke="${C.new}" stroke-width="1.5" marker-end="url(#cllarw)"/>
    <line x1="156" y1="48" x2="128.5" y2="48" stroke="${C.new}" stroke-width="1.5" marker-end="url(#cllarw)"/>
    <!-- E1: LRAS₁ ∩ AD = (159.2, 141.9) — exact from SVG ✓ -->
    <circle cx="159.2" cy="141.9" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <line x1="28" y1="141.9" x2="159.2" y2="141.9" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="159.2" y1="141.9" x2="159.2" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="145" fill="${C.label}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="155" y="171" fill="${C.label}" font-size="7.5" font-weight="bold">YF₁</text>
    <!-- E2: LRAS₂ ∩ AD = (125.7, 111.4) — exact from SVG ✓ -->
    <circle cx="125.7" cy="111.4" r="4" fill="${C.new}"/>
    <line x1="28" y1="111.4" x2="125.7" y2="111.4" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="125.7" y1="111.4" x2="125.7" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="114" fill="${C.new}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="121" y="171" fill="${C.new}" font-size="7.5" font-weight="bold">YF₂</text>
  </svg>`;
}


function benignDeflationDiagram() {
  // BENIGN DEFLATION: productivity gains → SRAS and LRAS both shift right, AD fixed
  // At BOTH equilibria, all three curves (AD, SRAS, LRAS) meet at exactly one point.
  //
  // Axes: axes(28,162,215,18,'Real GDP','Price Level')
  //
  // AD (fixed): M50 25 L195 155  → y = 0.8966x − 19.83
  // SRAS₁:      M45 155 L175 38  → y = −0.9x + 195.5
  // SRAS₂:      M87 155 L215 40  → y = −0.9x + 233.3  (shift Δ=42)
  //
  // E1 = AD ∩ SRAS₁ ∩ LRAS₁:
  //   x=119.85, y=87.63  — AD(120)=87.6, SRAS₁(120)=87.6, error=0 ✓
  //
  // E2 = AD ∩ SRAS₂ ∩ LRAS₂:
  //   x=140.89, y=106.50 — AD(141)=106.5, SRAS₂(141)=106.5, error=0.000000 ✓
  //
  // Deflation: P1_svg=87.6 → P2_svg=106.5 (higher SVG y = lower on page = lower price) ✓
  // Growth:    Y1=120 → Y2=141 ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('bdarw','#10b981')}</defs>
    ${axes(28,162,215,18,'Real GDP','Price Level')}
    <!-- AD: fixed — M50 25 L195 155 -->
    <line x1="50" y1="25" x2="195" y2="155" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="197" y="153" fill="${C.ad}" font-size="9" font-weight="bold">AD</text>
    <!-- SRAS₁: M45 155 L175 38 -->
    <line x1="45" y1="155" x2="175" y2="38" stroke="${C.sras}" stroke-width="2.5"/>
    <text x="177" y="36" fill="${C.sras}" font-size="9" font-weight="bold">SRAS₁</text>
    <!-- SRAS₂: M87 155 L215 40 — parallel shift Δ=42 -->
    <line x1="87" y1="155" x2="215" y2="40" stroke="${C.new}" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="208" y="38" fill="${C.new}" font-size="9" font-weight="bold">SRAS₂</text>
    <!-- LRAS₁: x=120 — meets AD∩SRAS₁ at E1=(120,88) ✓ -->
    <line x1="120" y1="18" x2="120" y2="162" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="112" y="16" fill="${C.lras}" font-size="9" font-weight="bold">LRAS₁</text>
    <!-- LRAS₂: x=141 — meets AD∩SRAS₂ at E2=(141,107) ✓ -->
    <line x1="141" y1="18" x2="141" y2="162" stroke="${C.new}" stroke-width="2" stroke-dasharray="7,4"/>
    <text x="143" y="16" fill="${C.new}" font-size="9" font-weight="bold">LRAS₂</text>
    <!-- Shift arrows between LRAS₁ and LRAS₂ -->
    <line x1="123" y1="35" x2="138" y2="35" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#bdarw)"/>
    <line x1="123" y1="46" x2="138" y2="46" stroke="${C.lras}" stroke-width="1.5" marker-end="url(#bdarw)"/>
    <!-- E1: (120,88) — AD ∩ SRAS₁ ∩ LRAS₁ ✓ -->
    <circle cx="120" cy="88" r="4" fill="white" stroke="${C.lras}" stroke-width="2"/>
    <line x1="28" y1="88" x2="120" y2="88" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="120" y1="88" x2="120" y2="162" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="91" fill="${C.label}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="116" y="171" fill="${C.label}" font-size="7.5" font-weight="bold">Y₁</text>
    <!-- E2: (141,107) — AD ∩ SRAS₂ ∩ LRAS₂ ✓ -->
    <circle cx="141" cy="107" r="4" fill="${C.new}"/>
    <line x1="28" y1="107" x2="141" y2="107" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="141" y1="107" x2="141" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="110" fill="${C.new}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="137" y="171" fill="${C.new}" font-size="7.5" font-weight="bold">Y₂</text>
  </svg>`;
}

function expFiscalKeynesianDiagram() {
  // Expansionary Fiscal Policy — Keynesian AS curve
  // AS path: IDENTICAL to keynesianDiagram — M 35 128 L 110 128 Q 145 128 160 95 L 162 28
  // Axes: axes(28,162,215,18) — same as keynesianDiagram and multiplier diagrams
  //
  // Keynesian AS sections:
  //   Flat:   y=128, x=35→110  (spare capacity — ↑Y with no price rise)
  //   Bezier: P0=(110,128) C=(145,128) P1=(160,95)  → y=128-33t², x=110+70t-20t²
  //   Steep:  (160,95)→(162,28)  (full capacity — Y*)
  //
  // AD lines (slope=0.55, parallel):
  //   AD1: y=0.55x+95   → E1=(60,128) on FLAT section — verified ✓
  //        Draw: x1=28 y1=110.4  x2=122 y2=162
  //
  //   AD2: y=0.55x+42.75 → E2=(140,119.8) on BEZIER at t=0.5 — error=0.0000 ✓
  //        Draw: x1=28 y1=58.2   x2=215 y2=161
  //
  // Output gaps (SVG x distance to Y* at x=162):
  //   Initial gap:  162−60  = 102px  (large negative output gap) ✓
  //   Remaining:    162−140 =  22px  (partially closed, not overheating) ✓
  //
  // Price effect: E1.y=128 (flat — zero inflation), E2.y=120 (curved — modest price rise) ✓
  //   Keynesian insight: most of the AD rise → real output, small fraction → prices
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('fearw','#ef4444')}</defs>
    ${axes(28,162,215,18,'Real GDP','Price Level')}
    <!-- Keynesian AS — identical path to keynesianDiagram -->
    <path d="M 35 128 L 110 128 Q 145 128 160 95 L 162 28"
          stroke="${C.sras}" stroke-width="2.5" fill="none"/>
    <text x="164" y="26" fill="${C.sras}" font-size="8" font-weight="bold">AS</text>
    <text x="164" y="36" fill="${C.sras}" font-size="7">(Keynesian)</text>
    <!-- Y* vertical marker at x=162 (full capacity) -->
    <line x1="162" y1="28" x2="162" y2="162" stroke="${C.lras}" stroke-width="1" stroke-dasharray="4,3" opacity="0.6"/>
    <text x="158" y="170" fill="${C.lras}" font-size="7" text-anchor="middle">Y*</text>
    <!-- AD1: y=0.55x+95 — E1=(60,128) on flat section, large negative output gap ✓ -->
    <line x1="28" y1="110" x2="122" y2="162" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="112" y="162" fill="${C.ad}" font-size="9" font-weight="bold">AD₁</text>
    <!-- AD2: y=0.55x+42.75 — E2=(140,120) on bezier t=0.5, gap partially closed ✓ -->
    <line x1="28" y1="58" x2="215" y2="161" stroke="${C.new}" stroke-width="2.5"/>
    <text x="205" y="161" fill="${C.new}" font-size="9" font-weight="bold">AD₂</text>
    <!-- Shift arrow between the two parallel AD lines -->
    <line x1="50" y1="119" x2="50" y2="73" stroke="${C.new}" stroke-width="1.5" marker-end="url(#fearw)"/>
    <text x="53" y="100" fill="${C.new}" font-size="7.5" font-weight="bold">↑G</text>
    <!-- E1: (60,128) — flat section, P1=P_flat, zero inflation ✓ -->
    <circle cx="60" cy="128" r="3.5" fill="white" stroke="${C.ad}" stroke-width="2"/>
    <line x1="28" y1="128" x2="60" y2="128" stroke="${C.ad}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="60" y1="128" x2="60" y2="162" stroke="${C.ad}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="131" fill="${C.ad}" font-size="7.5" font-weight="bold">P₁</text>
    <text x="56" y="171" fill="${C.ad}" font-size="7.5" font-weight="bold">Y₁</text>
    <!-- E2: (140,120) — bezier section, modest price rise ✓ -->
    <circle cx="140" cy="120" r="3.5" fill="${C.new}"/>
    <line x1="28" y1="120" x2="140" y2="120" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="140" y1="120" x2="140" y2="162" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="123" fill="${C.new}" font-size="7.5" font-weight="bold">P₂</text>
    <text x="136" y="171" fill="${C.new}" font-size="7.5" font-weight="bold">Y₂</text>
    <!-- Output gap bracket -->
    <line x1="140" y1="155" x2="161" y2="155" stroke="${C.lras}" stroke-width="1.2"/>
    <line x1="140" y1="152" x2="140" y2="158" stroke="${C.lras}" stroke-width="1.2"/>
    <line x1="161" y1="152" x2="161" y2="158" stroke="${C.lras}" stroke-width="1.2"/>
  </svg>`;
}

function crowdingOutDiagram() {
  // Loanable Funds market — crowding out via rightward demand shift
  // Axes: axes(28,155,215,18) — Y=Interest Rate, X=Q of Loanable Funds
  //
  // Lines (all verified algebraically, zero rounding error):
  //   S:  y = -0.710x + 179.95  → x1=45 y1=148, x2=200 y2=38
  //   D1: y =  0.800x - 8.0     → x1=45 y1=28,  x2=195 y2=148
  //   D2: y =  0.800x - 48.0    → x1=95 y1=28,  x2=215 y2=124 (D1 shifted right 50px)
  //
  //   E1 = S ∩ D1: x=124.5 → (124, 92)  verified: S(124.5)=91.6, D1(124.5)=91.6 ✓
  //   E2 = S ∩ D2: x=151.0 → (151, 73)  verified: S(151.0)=72.8, D2(151.0)=72.8 ✓
  //
  //   Economics: E2 y(73) < E1 y(92) → r2 > r1 ✓  E2 x(151) > E1 x(124) → Q2 > Q1 ✓
  //   Crowding out: D shifts 50px right but Q only rises 26.5px → 23.5px of private
  //   investment crowded out by the higher interest rate ✓
  return `<svg viewBox="0 0 230 175" xmlns="http://www.w3.org/2000/svg">
    <defs>${arrowDef('coarw','#f59e0b')}</defs>
    ${axes(28,155,215,18,'Q of Loanable Funds','Interest Rate')}
    <!-- S: upward sloping — higher rate → more saving supplied -->
    <line x1="45" y1="148" x2="200" y2="38" stroke="${C.lras}" stroke-width="2.5"/>
    <text x="202" y="36" fill="${C.lras}" font-size="9" font-weight="bold">S</text>
    <!-- D1: downward sloping — original private demand for funds -->
    <line x1="45" y1="28" x2="195" y2="148" stroke="${C.ad}" stroke-width="2.5"/>
    <text x="188" y="148" fill="${C.ad}" font-size="9" font-weight="bold">D₁</text>
    <!-- D2: D1 shifted right — govt deficit spending adds to demand for loanable funds -->
    <line x1="95" y1="28" x2="215" y2="124" stroke="${C.new}" stroke-width="2.5" stroke-dasharray="5,3"/>
    <text x="208" y="122" fill="${C.new}" font-size="9" font-weight="bold">D₂</text>
    <!-- Shift arrow at mid-curve height -->
    <line x1="122" y1="82" x2="155" y2="82" stroke="${C.new}" stroke-width="1.5" marker-end="url(#coarw)"/>
    <!-- E1: S ∩ D1 = (124,92) ✓ -->
    <circle cx="124" cy="92" r="4" fill="white" stroke="${C.ad}" stroke-width="2"/>
    <line x1="28" y1="92" x2="124" y2="92" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="124" y1="92" x2="124" y2="155" stroke="${C.muted}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="95" fill="${C.label}" font-size="8" font-weight="bold">r₁</text>
    <text x="120" y="165" fill="${C.label}" font-size="7.5">Q₁</text>
    <!-- E2: S ∩ D2 = (151,73) ✓ -->
    <circle cx="151" cy="73" r="4" fill="white" stroke="${C.new}" stroke-width="2"/>
    <line x1="28" y1="73" x2="151" y2="73" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <line x1="151" y1="73" x2="151" y2="155" stroke="${C.new}" stroke-width="1" stroke-dasharray="3,2"/>
    <text x="16" y="76" fill="${C.new}" font-size="8" font-weight="bold">r₂</text>
    <text x="147" y="165" fill="${C.new}" font-size="7.5">Q₂</text>
  </svg>`;
}

function circularFlowDiagram() {
  // viewBox 0 0 230 212
  // Box centres:
  //   Households  (115, 16)  — top centre,    box x=80  y=5   w=70 h=22
  //   Firms       (115, 174) — bottom centre, box x=80  y=163 w=70 h=22
  //   Government  (115, 95)  — mid centre,    box x=82  y=84  w=66 h=22
  //   Intl Econ   (30,  95)  — mid left,      box x=3   y=84  w=55 h=22
  //   Financial   (199, 95)  — mid right,     box x=172 y=84  w=55 h=22
  //
  // Main circular loop runs on OUTER edges (x=162 right, x=68 left)
  // Leakages (red dashed): T left-of-centre, S rightward, M leftward
  // Injections (green solid): G routes right of T to avoid overlap, I from Financial, X from Intl
  return `<svg viewBox="0 0 230 212" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <marker id="cfarr"   markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L6,3 Z" fill="${C.muted}"/></marker>
      <marker id="cfblue"  markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L6,3 Z" fill="${C.ad}"/></marker>
      <marker id="cfred"   markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L6,3 Z" fill="${C.new}"/></marker>
      <marker id="cfgreen" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L0,6 L6,3 Z" fill="${C.lras}"/></marker>
    </defs>
    <!-- BOXES -->
    <rect x="80"  y="5"   width="70" height="22" rx="3" fill="rgba(59,130,246,0.12)"  stroke="${C.ad}"     stroke-width="1.5"/>
    <text x="115" y="20"  fill="${C.ad}"     font-size="8"   font-weight="bold" text-anchor="middle">Households</text>
    <rect x="80"  y="163" width="70" height="22" rx="3" fill="rgba(245,158,11,0.12)"  stroke="${C.sras}"   stroke-width="1.5"/>
    <text x="115" y="178" fill="${C.sras}"   font-size="8"   font-weight="bold" text-anchor="middle">Firms</text>
    <rect x="82"  y="84"  width="66" height="22" rx="3" fill="rgba(16,185,129,0.12)"  stroke="${C.lras}"   stroke-width="1.5"/>
    <text x="115" y="99"  fill="${C.lras}"   font-size="7.5" font-weight="bold" text-anchor="middle">Government</text>
    <rect x="3"   y="84"  width="55" height="22" rx="3" fill="rgba(139,92,246,0.12)"  stroke="${C.purple}" stroke-width="1.5"/>
    <text x="30"  y="93"  fill="${C.purple}" font-size="6.5" font-weight="bold" text-anchor="middle">International</text>
    <text x="30"  y="102" fill="${C.purple}" font-size="6.5" text-anchor="middle">Economy</text>
    <rect x="172" y="84"  width="55" height="22" rx="3" fill="rgba(6,182,212,0.12)"   stroke="${C.teal}"   stroke-width="1.5"/>
    <text x="199" y="93"  fill="${C.teal}"   font-size="6.5" font-weight="bold" text-anchor="middle">Financial</text>
    <text x="199" y="102" fill="${C.teal}"   font-size="6.5" text-anchor="middle">Institutes</text>
    <!-- MAIN CIRCULAR FLOWS (outer edges, clear of all centre boxes) -->
    <!-- Income (blue): Firms right (162,163) arc up to Households right (162,27) -->
    <path d="M 162,163 C 192,140 192,50 162,27"
          stroke="${C.ad}" stroke-width="2" fill="none" marker-end="url(#cfblue)"/>
    <text x="200" y="60"  fill="${C.ad}" font-size="6.5" text-anchor="middle" font-weight="bold">Income</text>
    <text x="200" y="69" fill="${C.ad}" font-size="6"   text-anchor="middle">(wages/profit)</text>
    <!-- Consumption (grey): Households left (68,27) arc down to Firms left (68,163) -->
    <path d="M 68,27 C 38,50 38,140 68,163"
          stroke="${C.muted}" stroke-width="2" fill="none" marker-end="url(#cfarr)"/>
    <text x="22" y="60"  fill="${C.muted}" font-size="6.5" text-anchor="middle" font-weight="bold">Consumption</text>
    <text x="22" y="69" fill="${C.muted}" font-size="6"   text-anchor="middle">(C)</text>
    <!-- LEAKAGES (red dashed) -->
    <!-- T: Households bottom-left (104,27) → Government top-left (96,84) — left of centre -->
    <line x1="104" y1="27" x2="96" y2="84"
          stroke="${C.new}" stroke-width="1.5" stroke-dasharray="4,2" marker-end="url(#cfred)"/>
    <text x="92" y="60" fill="${C.new}" font-size="7" font-weight="bold">T</text>
    <!-- S: Households right (150,16) → arc → Financial top (199,84) -->
    <path d="M 150,16 C 175,16 199,44 199,84"
          stroke="${C.new}" stroke-width="1.5" fill="none" stroke-dasharray="4,2" marker-end="url(#cfred)"/>
    <text x="180" y="44" fill="${C.new}" font-size="7" font-weight="bold">S</text>
    <!-- M: left flow at (68,130) → left → International Economy right (58,106) -->
    <path d="M 68,130 C 56,130 56,116 58,106"
          stroke="${C.new}" stroke-width="1.5" fill="none" stroke-dasharray="4,2" marker-end="url(#cfred)"/>
    <text x="51" y="124" fill="${C.new}" font-size="7" font-weight="bold">M</text>
    <!-- INJECTIONS (green solid) -->
    <!-- G: Government bottom-right (130,106) → curves right of centre → Firms top-right (144,163) -->
    <path d="M 130,106 C 152,106 152,144 144,163"
          stroke="${C.lras}" stroke-width="1.5" fill="none" marker-end="url(#cfgreen)"/>
    <text x="153" y="136" fill="${C.lras}" font-size="7" font-weight="bold">G</text>
    <!-- I: Financial bottom (199,106) → arc left → Firms right edge (150,163) -->
    <path d="M 199,106 C 199,144 172,162 150,163"
          stroke="${C.lras}" stroke-width="1.5" fill="none" marker-end="url(#cfgreen)"/>
    <text x="187" y="146" fill="${C.lras}" font-size="7" font-weight="bold">I</text>
    <!-- X: International right (58,106) → arc down → left flow (68,140) -->
    <path d="M 58,106 C 58,130 62,138 68,140"
          stroke="${C.lras}" stroke-width="1.5" fill="none" marker-end="url(#cfgreen)"/>
    <text x="49" y="128" fill="${C.lras}" font-size="7" font-weight="bold">X</text>
    <!-- LEGEND -->
    <line x1="4"   y1="203" x2="16"  y2="203" stroke="${C.lras}" stroke-width="2"/>
    <text x="18"  y="206" fill="${C.lras}"  font-size="6">Injections: X, G, I</text>
    <line x1="90"  y1="203" x2="102" y2="203" stroke="${C.new}"  stroke-width="2" stroke-dasharray="3,2"/>
    <text x="104" y="206" fill="${C.new}"   font-size="6">Leakages: M, T, S</text>
    <line x1="168" y1="203" x2="178" y2="203" stroke="${C.ad}"   stroke-width="2"/>
    <text x="180" y="206" fill="${C.ad}"    font-size="6">Income flow</text>
  </svg>`;
}





// ═══ MACRO CARD DATA ═══
const maCards = [
  { id:1, category:'framework', catLabel:'Macro Framework',
    concept:'PPF: Productive Inefficiency',
    diagramType:'ppf', shift:'insideToBoundary',
    explanation:'A point inside the PPF represents spare capacity — labour unemployed, capital idle, land underused. Output can rise without new resources simply by moving toward the boundary. This is actual growth, not potential growth. Crucially, the PPF model assumes only two goods and constant technology, which simplifies reality. A key limitation is that it cannot distinguish between types of unemployment (cyclical vs structural) or identify why resources are idle. Evaluation: the size of the output gap matters — a small gap may close quickly via monetary stimulus; a large or structural gap may persist regardless of demand management. Links to: output gap, multiplier, AD/AS, unemployment.',
    keyPoint:'Inside PPF → spare capacity → actual growth possible without new resources. Distinguish from outward shift (potential growth). Limitation: model assumes full factor mobility — in reality, workers cannot instantly switch sectors. UK example: during the 2008 recession unemployment reached 8.5% — millions of workers became idle, pushing the economy well inside its PPF. Links: AD/AS (negative output gap), Cyclical Unemployment, Multiplier Effect.' },
  { id:2, category:'framework', catLabel:'Macro Framework',
    concept:'PPF: Potential Growth',
    diagramType:'ppf', shift:'boundaryOut',
    explanation:'An outward PPF shift means productive capacity has permanently increased — the economy can now produce more of both goods simultaneously. Causes include improvements in quantity or quality of factors: more workers, better technology, capital accumulation, or improved education raising human capital. This represents long-run supply-side growth, not a cyclical recovery. Key assumption: the model treats all factors as homogeneous — in reality, capital and labour vary enormously in quality. Evaluation: outward shifts are not costless — investment in capital requires sacrificing current consumption (opportunity cost shown by moving along the current PPF). Links to: LRAS, supply-side policy, Harrod-Domar model.',
    keyPoint:'Outward PPF → ↑ productive capacity → long-run growth. Requires ↑ factor quantity or quality. Distinguish from movement to boundary (actual growth). Evaluation: the rate of shift depends on investment and institutional quality — some economies shift outward slowly despite high investment (Harrod-Domar). UK example: post-war expansion of education via the 1944 Act improved human capital, shifting the UK PPF outward through rising productivity in the 1950s–60s. Links: LRAS shift right, Supply-Side Policy, Harrod-Domar Model.' },
  { id:3, category:'framework', catLabel:'Macro Framework',
    concept:'PPF: Unsustainable Production',
    diagramType:'ppf', shift:'outside',
    explanation:'A point beyond the PPF is unachievable with current resources under normal conditions — it lies outside productive capacity. If an economy appears to produce here (overworking labour, depleting natural resources, running down capital), output is unsustainable and cannot be maintained. In macroeconomic terms this corresponds to a positive output gap: actual output exceeds potential, creating inflationary pressure as demand bids up prices. Evaluation: a key debate is whether central banks should act pre-emptively when the economy operates near or beyond potential — monetarists argue inflation will self-correct via the LRPC, Keynesians are less confident. Links to: positive output gap, demand-pull inflation, LRPC.',
    keyPoint:'Beyond PPF → positive output gap → unsustainable → inflation. Cannot persist: resource constraints force correction. Evaluation: the economy can appear to operate beyond capacity temporarily via credit-fuelled consumption — this was a feature of the 2004–08 UK boom. UK example: the late 1980s Lawson Boom saw GDP grow 5% above trend — the economy operated beyond its PPF, driving inflation to 10.9% by 1990 before recession corrected it. Links: Demand-Pull Inflation, Positive Output Gap, SRPC.' },
  { id:4, category:'framework', catLabel:'Macro Framework',
    concept:'PPF: Inward Shift (Decline)',
    diagramType:'ppf', shift:'inward',
    explanation:'An inward PPF shift means productive capacity has permanently fallen — the economy can produce less than before. Causes include war destroying capital, pandemics reducing the workforce, mass emigration, natural disasters, or prolonged underinvestment causing capital depreciation. This is distinct from a movement inside the frontier: here the boundary itself contracts, so even full employment produces less. Evaluation: inward shifts may be partially reversible — capital can be rebuilt, workers retrained — but some human capital and institutional knowledge may be permanently lost. Links to: LRAS shift left, long-run unemployment, supply-side policy.',
    keyPoint:'Inward PPF → ↓ productive capacity → permanent decline in potential output. Distinct from spare capacity (inside boundary). Evaluation: degree of reversibility matters — physical capital can be rebuilt faster than trust in institutions or workforce skills lost to long-term unemployment. UK example: COVID-19 caused an inward shift as long-term sickness rose by 400,000+ workers by 2023, permanently reducing labour supply and contracting the productive frontier. Links: LRAS Left Shift, Classical Unemployment, Supply-Side Policy.' },
  { id:'4b', category:'framework', catLabel:'Macro Framework',
    concept:'Circular Flow of Income',
    diagramType:'circularFlow',
    explanation:'Income circulates between Households (supplying labour) and Firms (producing goods). Households receive wages and spend as Consumption (C). Three leakages withdraw money: Tax (T), Savings (S), Imports (M). Three injections re-inject spending: Government expenditure (G), Investment (I), Exports (X). Equilibrium: J = L, i.e. G+I+X = T+S+M. Key assumptions: the model treats the economy as closed to complexity — it ignores financial intermediation, wealth effects and distributional issues. Evaluation: the model shows why government spending can offset private leakages, but it cannot capture the speed of adjustment or the role of expectations in amplifying or dampening shocks. Links to: multiplier, AD components, fiscal policy.',
    keyPoint:'Leakages: T+S+M. Injections: G+I+X. Equilibrium: J = L. Any injection > leakage → income expands (multiplier). Evaluation: the model assumes spending flows smoothly — in reality, hoarding, credit crunches and confidence collapses can break the circular flow (Keynes\' paradox of thrift). UK example: during 2020 lockdowns, household savings surged (S↑) and imports fell (M↓), but G rose via furlough — injections offset leakages, limiting contraction. Links: Multiplier Effect, AD/AS, Fiscal Policy, Keynesian LRAS.' },
  { id:5, category:'adas', catLabel:'AD/AS',
    concept:'AD/AS Equilibrium',
    diagramType:'adAs', shift:'equilibrium',
    explanation:'The short-run macroeconomic equilibrium is where the AD curve intersects the SRAS curve — jointly determining the price level (P1) and real national output (Y1). AD slopes downward because a lower price level raises real wealth, reduces interest rates and improves export competitiveness (all raising spending). SRAS slopes upward because firms supply more as the price level rises, given that wages and input costs are sticky in the short run. The equilibrium is temporary — any shock to AD or SRAS shifts the intersection, changing both P1 and Y1. Evaluation: the SRAS equilibrium may sit below, at, or above the full-employment level of output (Yf) — determining whether there is a negative, zero, or positive output gap. The long-run adjustment toward Yf (via the LRAS) is shown separately on the Classical LRAS and output gap cards. Links to: SRAS shifts, AD shifts, output gaps, LRAS, price level.',
    keyPoint:'AD intersects SRAS → P1 and Y1 determined simultaneously. SRAS upward-sloping (sticky wages SR). AD downward-sloping (wealth, interest rate, exchange rate effects). Evaluation: the SR equilibrium may not be at full employment — a negative output gap (Y1 < Yf) implies spare capacity and unemployment; a positive gap (Y1 > Yf) implies inflationary pressure. Whether the economy self-corrects to Yf quickly (classical) or slowly (Keynesian) is the central macro policy debate. UK example: in 2021, the post-COVID AD surge (fuelled by £37bn furlough savings released into spending) intersected a supply-constrained SRAS, raising P1 sharply — CPI hit 11.1% by October 2022 — while Y1 recovered above pre-pandemic levels. Links: AD Shifts, SRAS Shifts, Output Gaps, Classical LRAS, Keynesian LRAS.' },
  { id:7, category:'adas', catLabel:'AD/AS',
    concept:'AD Shift Left',
    diagramType:'adAs', shift:'adLeft',
    explanation:'AD shifts left when any of its components fall: consumer confidence collapses (↓C), firms cut investment (↓I), government implements austerity (↓G), or net exports deteriorate (↓X−M). Both price level and real GDP fall. The multiplier amplifies the initial fall through successive rounds of lost income and spending. A critical evaluation point: the size of the multiplier matters — if it is small (due to high marginal propensity to import or save), the damage is contained; if large, a small shock becomes a deep recession. Links to: negative output gap, multiplier, unemployment, fiscal/monetary policy response.',
    keyPoint:'↓ C/I/G/(X−M) → AD left → ↓ Real GDP, ↓ Price Level, ↑ Unemployment. Multiplier amplifies. Evaluation: near full employment, AD left mainly reduces inflation; with spare capacity, output and jobs bear the brunt. Policy debate: Keynesians favour counter-cyclical fiscal stimulus; monetarists prefer price stability via monetary rules. UK example: the 2010–12 austerity programme cut spending by £83bn, shifting AD left and contributing to a double-dip recession. Links: Negative Output Gap, Multiplier, Unemployment, Fiscal Policy.' },
  { id:8, category:'adas', catLabel:'AD/AS',
    concept:'SRAS Shift Right',
    diagramType:'adAs', shift:'srasRight',
    explanation:'SRAS shifts right when firms\' production costs fall, allowing more output at every price level. Causes: falling oil/commodity prices, lower wages, productivity improvements, or deregulation reducing compliance costs. The result is simultaneously lower inflation and higher real GDP — a favourable supply shock. This is the ideal outcome of supply-side policy. Evaluation: supply-side improvements take time and their effects are uncertain; short-run cost falls (e.g. from oil prices) may reverse, making SRAS shifts volatile compared to LRAS shifts which are more permanent. Links to: LRAS, supply-side policy, Phillips curve.',
    keyPoint:'↓ Costs or ↑ Productivity → SRAS right → ↑ Real GDP, ↓ Price Level. Favourable supply shock. Evaluation: distinguishing temporary SRAS shifts (oil price falls) from permanent LRAS shifts (technology) is crucial — the former reverses, the latter does not. UK example: the 2014–15 oil price collapse (Brent $115→$35/barrel) shifted SRAS right, pushing UK CPI toward zero while supporting growth. Links: LRAS Shift Right, Supply-Side Policy, SRPC, Inflation.' },
  { id:9, category:'adas', catLabel:'AD/AS',
    concept:'SRAS Shift Left',
    diagramType:'adAs', shift:'asLeft',
    explanation:'SRAS shifts left when production costs rise — firms supply less at every price level. Common causes: energy price shocks, rising wages above productivity, new regulatory burdens, or supply chain disruptions. The result is stagflation — higher prices and falling output simultaneously — which is the most difficult macroeconomic condition to resolve. Demand-side policy cannot fix both problems at once: expanding AD to restore output worsens inflation; contracting AD to cut inflation deepens the recession. Evaluation: the appropriate policy response is contested — supply-side reform addresses the cause but is slow; tolerating higher inflation risks embedding wage-price spirals. Links to: stagflation, SRPC, cost-push inflation, policy conflict.',
    keyPoint:'↑ Input costs → SRAS left → stagflation (↑ Price Level + ↓ Real GDP). Policy dilemma: fixing output worsens inflation and vice versa. Evaluation: the speed and permanence of the supply shock determines the correct response — a temporary shock may warrant tolerance; a permanent one requires structural reform. UK example: the 1973 OPEC oil embargo quadrupled prices, shifting SRAS sharply left — UK inflation hit 24% in 1975 while GDP fell, creating the defining stagflation episode of the 20th century. Links: Cost-Push Inflation, SRPC, Supply-Side Policy, Policy Conflict.' },
  { id:10, category:'adas', catLabel:'AD/AS',
    concept:'Classical LRAS',
    diagramType:'adAs', shift:'lrasVertical',
    explanation:'The classical LRAS is vertical at the full employment level of output (Yf) — the economy\'s long-run productive capacity. In the long run, all prices and wages are fully flexible, so the economy always returns to Yf regardless of AD. Any AD shock is entirely absorbed by the price level with no lasting effect on output. The vertical LRAS reflects the classical view that markets self-correct: excess unemployment puts downward pressure on wages, restoring competitiveness and output. Evaluation: the key assumption is wage and price flexibility — if wages are downwardly rigid (as Keynesians argue), the self-correction mechanism fails and the LRAS may not be a useful policy guide in the short or medium run. Links to: long-run growth, supply-side policy, LRPC, output gaps.',
    keyPoint:'LRAS vertical at Yf. In LR, AD shocks affect only price level, not output. Self-correction via wage/price flexibility. Evaluation: the speed of self-correction is the central macro debate — classical economists see it as fast (months); Keynesians argue it can take years, making demand management necessary (\'in the long run we are all dead\'). UK example: monetarist reforms of the 1980s (Thatcher) were premised on a vertical LRAS — reducing union power and deregulating labour markets to speed up the self-correction mechanism. Links: LRPC, Output Gaps, Supply-Side Policy, Keynesian LRAS.' },
  { id:11, category:'adas', catLabel:'AD/AS',
    concept:'Keynesian vs Classical LRAS',
    diagramType:'keynesian',
    explanation:'The two LRAS models represent fundamentally different views of how the economy works. The Keynesian LRAS is horizontal at low output (spare capacity), meaning AD increases raise real GDP without inflation. It becomes vertical only at full employment (Yf). The classical LRAS is always vertical — output is fixed by supply-side factors. The Keynesian model implies demand management is effective; the classical model implies only supply-side policy can raise long-run output. Both are extreme simplifications: most modern economists accept a hybrid \'new Keynesian\' view where the LRAS is near-vertical but wages adjust slowly. Links to: fiscal policy, supply-side policy, output gaps, inflation.',
    keyPoint:'Keynesian: horizontal → vertical LRAS. AD effective when spare capacity; inflationary at Yf. Classical: always vertical — AD changes prices only. Evaluation: the appropriate model depends on the state of the economy — during deep recessions the Keynesian section is relevant; during booms, the classical section applies. UK example: the 2009 fiscal stimulus (Alistair Darling\'s temporary VAT cut and increased spending) was explicitly Keynesian — the economy had massive spare capacity, so stimulus was expected to raise output without stoking inflation. Links: Fiscal Policy, Monetary Policy, AD Shift, Output Gaps.' },
  { id:12, category:'adas', catLabel:'AD/AS',
    concept:'Positive Output Gap',
    diagramType:'adAs', shift:'positiveGap',
    explanation:'A positive output gap occurs when actual GDP exceeds potential GDP — the economy is operating above its sustainable long-run capacity. This puts upward pressure on wages, prices and inflation as firms bid for scarce labour and resources. In the AD/AS framework, it corresponds to AD intersecting SRAS to the right of the LRAS. Evaluation: measuring the output gap is notoriously difficult — the OBR and Bank of England estimates have diverged by several percentage points in recent years, making policy calibration uncertain. A further complication: potential output itself may shift (e.g. after a productivity boom), meaning what looks like an output gap may reflect new capacity. Links to: demand-pull inflation, SRPC, monetary policy tightening.',
    keyPoint:'Actual GDP > Potential GDP → positive output gap → demand-pull inflation pressure. Self-corrects (classical) via wage/price rises shifting SRAS left to restore Yf. Evaluation: the gap is unobservable in real time — policymakers often mis-identify its size, risking over-tightening. UK example: the late 1980s Lawson Boom created a +5% output gap, fuelling inflation above 10% by 1990 — the Bank subsequently raised rates to 15% to correct it. Links: Demand-Pull Inflation, SRAS Left Shift, SRPC, Monetary Policy.' },
  { id:13, category:'adas', catLabel:'AD/AS',
    concept:'Negative Output Gap',
    diagramType:'adAs', shift:'negativeGap',
    explanation:'A negative output gap occurs when actual GDP falls below potential — the economy is operating with spare capacity. Unemployment rises above its natural rate; firms have underutilised capital; inflation tends to fall. In AD/AS terms, AD intersects SRAS to the left of the LRAS. The Keynesian view holds that the economy can remain here indefinitely if wages are rigid; the classical view holds it will self-correct as unemployment drives wages down, reducing costs and shifting SRAS right. Evaluation: the persistence of the output gap after 2008 (UK GDP not recovering to pre-crisis trend for over a decade) is often cited as evidence against rapid self-correction. Links to: cyclical unemployment, deflation risk, multiplier, fiscal stimulus.',
    keyPoint:'Actual GDP < Potential GDP → negative output gap → spare capacity, ↑ unemployment, ↓ inflation pressure. Classical: self-corrects via ↓ wages → SRAS right. Keynesian: may persist — needs demand stimulus. Evaluation: post-2008 evidence suggests self-correction is slow; UK real wages fell for 5 years, yet output gap persisted — challenging classical predictions. UK example: 2009–13 UK negative output gap of approximately −3% of GDP prompted QE and maintained near-zero interest rates for seven years. Links: Cyclical Unemployment, Fiscal Policy, QE, Deflation.' },
  { id:16, category:'adas', catLabel:'AD/AS',
    concept:'Interventionist Supply-Side Policy',
    diagramType:'adAs', shift:'bothRight',
    explanation:'Interventionist supply-side policies aim to raise potential output (shift LRAS right) through government action rather than market forces. Tools include: infrastructure investment (reducing transport costs for firms), education and training (raising human capital and labour productivity), R&D subsidies (boosting innovation and TFP), and regional development policies (reducing structural unemployment and factor immobility). Unlike market-based supply-side policies (deregulation, tax cuts), interventionist policies accept market failures as the rationale for state involvement. Evaluation: they tend to be slow-acting (education takes decades to affect productivity) and their benefits are hard to measure. There is also a risk of government failure — poorly targeted spending may generate less LRAS shift than the fiscal cost justifies. Links to: LRAS, human capital, market failure, fiscal policy.',
    keyPoint:'Interventionist supply-side: infrastructure, education, R&D → LRAS right. Addresses market failure in human capital and innovation. Evaluation: long time lags — skills investment takes 10–15 years to feed into productivity; infrastructure projects take 5–10 years to complete. Risk of government failure: HS2 cost overruns illustrate the danger. UK example: the UK\'s Apprenticeship Levy (2017) was an interventionist supply-side policy — £3bn/year to fund employer-led training, aiming to raise labour productivity and shift LRAS right. Links: LRAS, Human Capital, Fiscal Policy, Market Failure.' },
  { id:67, category:'adas', catLabel:'AD/AS',
    concept:'AD-AS and the Phillips Curve (Linked)',
    diagramType:'adAsPhillips',
    explanation:'The AD/AS model and the Phillips curve are two representations of the same macroeconomic relationships. A rightward shift in AD raises both the price level (inflation) and real GDP (lower unemployment) — tracing a movement up the SRPC. A leftward shift in AD produces lower inflation but higher unemployment — moving down the SRPC. The LRAS corresponds to the LRPC: at potential output, any trade-off between inflation and unemployment is temporary as the economy self-corrects to the NRU. Evaluation: the linkage assumes a stable relationship between output gaps and inflation — but supply shocks can shift the SRPC, breaking the trade-off entirely (stagflation). Links to: SRPC, LRPC, NRU, demand-pull inflation, output gaps.',
    keyPoint:'AD right → ↑ Real GDP (↓ unemployment) + ↑ Price Level (↑ inflation) → movement up SRPC. LRAS = LRPC (vertical at NRU/Yf). Evaluation: the link breaks down with supply shocks — SRAS left shifts create stagflation, appearing as an outward SRPC shift rather than a movement along it. UK example: the 2021–22 post-COVID AD surge combined with supply disruptions showed AD/AS and SRPC moving simultaneously — inflation rose to 11% while unemployment fell, initially consistent with the trade-off, then complicated by the supply shock. Links: SRPC, LRPC, NRU, Demand-Pull Inflation, SRAS Left Shift.' },
  { id:17, category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Demand-Pull Inflation',
    diagramType:'demandPull',
    explanation:'Demand-pull inflation occurs when AD rises faster than productive capacity — too much money chasing too few goods. It typically occurs during booms when consumer confidence, investment, government spending or export demand surge. In AD/AS terms, rightward AD shifts push the price level up along a fixed or slow-moving SRAS. The positive output gap created puts upward wage pressure, which further shifts SRAS left (a wage-price spiral). Evaluation: demand-pull is generally considered more controllable than cost-push — raising interest rates reduces borrowing and spending, directly targeting the source. The main risk is over-tightening, which can trigger a recession. Links to: positive output gap, SRPC, monetary policy, AD components.',
    keyPoint:'Excess AD → price level rises. Positive output gap feeds wage-price spiral. Evaluation: demand-pull is more amenable to monetary policy than cost-push — interest rate rises reduce the AD components (C and I) that caused it. Risk: overtightening. UK example: post-COVID reopening (2021) saw demand-pull inflation as pent-up consumer spending (savings ratio fell from 25% to 4%) hit a supply-constrained economy — CPI reached 11.1% by Oct 2022. Links: Positive Output Gap, SRPC, AD Shift, Monetary Policy Transmission.' },
  { id:18, category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Cost-Push Inflation',
    diagramType:'adAs', shift:'asLeft',
    explanation:'Cost-push inflation arises from rising production costs — wages, energy, raw materials or import prices — shifting SRAS left. This creates stagflation: higher prices and lower output simultaneously. It is the most difficult macroeconomic condition because demand-side policy creates a trade-off: expanding AD restores output but worsens inflation; contracting AD cuts inflation but deepens the recession. Cost-push inflation often has external origins (commodity shocks, exchange rate depreciation) making it harder for domestic policymakers to address. Evaluation: whether to accommodate or fight cost-push inflation is contested — the Bank of England\'s 2022 response (raising rates aggressively) prioritised inflation control at the cost of lower output. Links to: stagflation, SRAS left shift, exchange rates, policy conflict.',
    keyPoint:'↑ Costs → SRAS left → stagflation (↑ P + ↓ Y). Policy dilemma: can\'t fix both simultaneously. Evaluation: the degree to which central banks should respond to imported inflation (caused by exchange rate or commodity shocks they can\'t control) is a major policy debate — tightening hurts output without addressing the cause. UK example: 2022 UK inflation was predominantly cost-push (energy +178%, food +18%) — the Bank\'s rate rises from 0.1% to 5.25% suppressed demand but couldn\'t reduce global energy prices. Links: SRAS Left Shift, Exchange Rate Depreciation, Policy Conflict, SRPC.' },
  { id:'18a', category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Long-Run Phillips Curve (Monetarist)',
    diagramType:'lrPhillips',
    explanation:'The monetarist LRPC is vertical at the Natural Rate of Unemployment (NRU) — sometimes called the Non-Accelerating Inflation Rate of Unemployment (NAIRU). Friedman and Phelps argued that the short-run trade-off between inflation and unemployment only holds while workers have adaptive expectations. Once workers fully anticipate inflation and renegotiate wages, real wages are unchanged — output returns to potential and unemployment returns to the NRU. Any attempt to hold unemployment below the NRU permanently requires ever-accelerating inflation. Evaluation: adaptive expectations are the key assumption — if expectations are rational (forward-looking), the trade-off may not even exist in the short run. The NRU itself is unobservable and shifts with structural change. Links to: SRPC, adaptive expectations, supply-side policy, NRU.',
    keyPoint:'LRPC vertical at NRU. SR trade-off exists while expectations lag; LR — no trade-off. Trying to hold U below NRU → accelerating inflation. Evaluation: the NRU is not fixed — it can be reduced by supply-side policy (reducing frictional/structural unemployment), shifting the LRPC left. UK example: the 1970s UK experience of rising inflation AND rising unemployment (stagflation) challenged the downward-sloping SRPC and gave empirical support to Friedman\'s LRPC theory. Links: SRPC, Adaptive Expectations, NRU, Supply-Side Policy, Inflation.' },
  { id:'18b', category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Supply-Side Policy and the LRPC',
    diagramType:'supplySidePhillips',
    explanation:'Effective supply-side policies reduce structural and frictional unemployment, shifting the LRPC left — achieving lower unemployment at any given inflation rate. This resolves the apparent long-run trade-off without stoking inflation: the NRU falls because the labour market functions more efficiently. Tools that shift the LRPC left include: better job-matching services (JobCentre reform), improved skills training, reducing welfare traps that discourage work, and greater labour market flexibility. Evaluation: supply-side reforms are slow-acting, politically difficult, and their effects on the NRU are hard to measure. Some policies that increase flexibility (e.g. zero-hours contracts) may reduce unemployment statistics while creating underemployment — a form of hidden unemployment. Links to: NRU, LRPC, frictional unemployment, labour market flexibility.',
    keyPoint:'Supply-side reform → ↓ NRU → LRPC shifts left → lower unemployment at same inflation. Evaluation: reforms must target specific unemployment types — retraining addresses structural; job-matching addresses frictional. Zero-hours contracts may reduce measured U but increase underemployment. UK example: the 1980s UK labour market reforms (breaking union power, Right to Work Act) are credited with shifting the NRU down from ~8% in 1984 to ~5% by the late 1990s, moving the LRPC leftward. Links: LRPC, NRU, Classical Unemployment, Supply-Side Policy, Labour Markets.' },
  { id:19, category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Phillips Curve (Short Run)',
    diagramType:'phillips',
    explanation:'The SRPC shows a negative short-run relationship between inflation and unemployment, based on the empirical work of A.W. Phillips (1958) using UK data 1861–1957. The trade-off exists because: low unemployment means firms bid up wages (cost-push) and consumers spend more (demand-pull), both raising inflation. Higher unemployment reduces these pressures. The SRPC assumes stable inflation expectations — if expectations shift (as in the 1970s), the whole curve shifts outward. Evaluation: the stable SRPC broke down in the 1970s with stagflation, prompting Friedman\'s LRPC theory. Modern \'New Keynesian\' models retain a SRPC but acknowledge it shifts with expectations and supply shocks. Links to: LRPC, demand-pull/cost-push inflation, AD/AS, NRU.',
    keyPoint:'↓ Unemployment ↔ ↑ Inflation (short run). Trade-off caused by wage pressure and AD strength. Evaluation: the SRPC is not stable — supply shocks and shifting expectations can shift it outward (higher inflation at every unemployment level — stagflation) or inward (credible anti-inflation policy). UK example: the 1950s–60s UK data showed a clear SRPC trade-off — governments deliberately expanded AD to reduce unemployment, accepting higher inflation as the \'price\'. This ended with the 1970s stagflation. Links: LRPC, Demand-Pull Inflation, AD/AS, Cost-Push Inflation.' },
  { id:22, category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Malevolent (Bad) Deflation',
    diagramType:'adAs', shift:'adLeft',
    explanation:'Malevolent deflation arises from collapsing AD — falling consumer spending, investment collapse or credit contraction. In AD/AS terms, the AD curve shifts sharply left, reducing both the price level and real GDP. The danger is a deflationary spiral: falling prices cause consumers to delay purchases (prices will be cheaper tomorrow), further reducing AD, causing further price falls. Debt deflation compounds this — the real value of debt rises as prices fall, causing defaults and credit contraction (Irving Fisher, 1933). Evaluation: malevolent deflation is historically associated with deep economic crises (1930s Great Depression, Japan 1990s). It is extremely difficult to escape once entrenched because nominal interest rates cannot fall below zero (the zero lower bound). Links to: AD collapse, liquidity trap, QE, Japan\'s lost decade.',
    keyPoint:'AD collapse → falling P + falling Y → deflationary spiral. Real debt burden rises (Fisher debt deflation). Confidence collapses. Evaluation: the self-reinforcing nature makes malevolent deflation particularly dangerous — unlike inflation, conventional monetary policy (cutting rates) loses effectiveness once rates hit zero, requiring unconventional tools (QE). UK example: UK policymakers feared malevolent deflation in 2009 — CPI briefly went negative and the Bank cut rates to 0.5% and launched QE to prevent a deflationary trap. Links: AD Shift Left, Liquidity Trap, QE, Negative Output Gap.' },
  { id:'22a', category:'inflation', catLabel:'Inflation & Deflation',
    concept:'Benign (Good) Deflation',
    diagramType:'benignDeflation',
    explanation:'Benign deflation arises from rightward SRAS or LRAS shifts — falling production costs or rising productivity reducing prices while output rises. This is the opposite of malevolent deflation: falling prices reflect supply-side improvements rather than demand collapse. Real wages and purchasing power rise; living standards improve without the deflationary spiral risk. Historically, the late 19th century US and the technology-driven falls in electronics prices are cited as benign deflation. Evaluation: the distinction between benign and malevolent deflation matters enormously for policy — applying anti-deflationary stimulus to benign deflation risks overheating the economy. In practice, distinguishing the cause of deflation in real time is difficult. Links to: SRAS/LRAS shift, productivity, supply-side policy.',
    keyPoint:'SRAS/LRAS right → falling P + rising Y. Benign: caused by supply improvement, not demand collapse. No deflationary spiral. Evaluation: the key diagnostic is output — if output is rising alongside falling prices, deflation is likely benign; if output is falling, it is malevolent. Policy error risk: confusing the two can lead to damaging over-stimulus. UK example: UK petrol prices fell throughout 2014–15 as oil supply surged (fracking, OPEC production) — benign deflation that raised real household incomes without triggering deflationary spiral dynamics. Links: SRAS Shift Right, Supply-Side Policy, Productivity, Malevolent Deflation.' },
  { id:'23a', category:'unemployment', catLabel:'Unemployment',
    concept:'AJ/LF Labour Market Model (NRU)',
    diagramType:'ajLfLabour',
    explanation:'The Actual/Job (AJ) and Labour Force (LF) model explains the Natural Rate of Unemployment (NRU) as the equilibrium rate where the number of people joining the unemployment pool (job losers + new entrants) equals those leaving it (job finders). The NRU consists of frictional unemployment (job search time) and structural unemployment (skills mismatch). It is not zero — some unemployment is unavoidable in a dynamic economy. Key assumption: the NRU is determined by supply-side factors (search frictions, skills, benefits), not demand. Evaluation: the NRU is unobservable and changes over time — it rose during the 1970s–80s as deindustrialisation created structural unemployment, and fell in the 1990s–2000s as labour markets became more flexible. Links to: LRPC, supply-side policy, structural unemployment.',
    keyPoint:'NRU = frictional + structural unemployment. AJ rate = job-finding rate. LF = labour force participation. NRU where AJ = LF flows. Evaluation: the NRU is not fixed — policies that improve job-matching, reduce skills mismatches, or change benefit incentives can shift it. The NRU does not include cyclical unemployment, which is temporary. UK example: UK NRU is estimated at ~4–4.5% — job vacancies and unemployment coexist because of search frictions and skills mismatches, not insufficient demand. Links: LRPC, Structural Unemployment, Supply-Side Policy, Labour Markets.' },
  { id:'23c', category:'unemployment', catLabel:'Unemployment',
    concept:'DL Shifts Left — Cyclical Unemployment and Wage Adjustment',
    diagramType:'dlShiftLeft',
    explanation:'When demand for labour (DL) shifts left — due to a fall in AD reducing firms\' demand for workers — employment falls below the NRU, creating cyclical unemployment. In the classical model, real wages fall (wage flexibility) until the labour market clears at a lower wage but the same employment level (self-correction). In the Keynesian model, wages are downwardly rigid — workers resist nominal wage cuts — so the fall in DL creates persistent unemployment rather than lower wages. Evaluation: the speed of wage adjustment is the critical variable. UK evidence from 2008–14 showed that real wages fell significantly (nominal wages frozen while inflation ran at 3–4%), suggesting some downward flexibility, but unemployment still rose substantially. Links to: cyclical unemployment, LRPC, AD/AS, wage rigidity.',
    keyPoint:'DL left → ↓ employment + ↑ cyclical unemployment. Classical: wages fall → self-correct. Keynesian: rigid wages → persistent unemployment. Evaluation: the \'wage flexibility vs rigidity\' debate has major policy implications — if wages adjust quickly, fiscal stimulus is less necessary; if rigid, government must fill the demand gap. UK example: post-2008 UK saw real wage falls of 8% over five years (some adjustment), yet unemployment peaked at 8.5% — suggesting partial but incomplete classical adjustment. Links: Cyclical Unemployment, AD Shift Left, Keynesian vs Classical LRAS, Fiscal Policy.' },
  { id:'23b', category:'unemployment', catLabel:'Unemployment',
    concept:'AJ Shifts Right — Lower NRU',
    diagramType:'ajShiftRight',
    explanation:'If the job-finding rate (AJ curve) shifts right — workers find jobs more quickly — the NRU falls. This can be achieved by supply-side policies: better job matching (improved JobCentre services, digital job boards), retraining programmes that reduce structural unemployment, reforms to benefit systems that strengthen job-search incentives, or greater wage flexibility. A rightward AJ shift is equivalent to a leftward shift of the LRPC — lower unemployment is achieved at the same inflation rate. Evaluation: the most powerful reductions in NRU come from reducing structural unemployment — but retraining is expensive, slow and its success depends on employer take-up. Links to: NRU, LRPC, supply-side policy, structural unemployment.',
    keyPoint:'AJ right → job-finding ↑ → NRU falls → LRPC shifts left. Achieved by: better job-matching, retraining, benefit reform. Evaluation: supply-side NRU reductions are politically difficult and slow — reforms that increase job-search intensity can reduce welfare without reducing structural mismatch if jobs aren\'t available in the right sectors. UK example: the 1980s–90s UK welfare reforms (tightening eligibility for Jobseeker\'s Allowance) shifted the AJ curve right, reducing measured NRU — but critics argue this pushed workers into low-productivity jobs rather than genuinely reducing structural unemployment. Links: NRU, LRPC, Supply-Side Policy, Labour Markets.' },
  { id:24, category:'unemployment', catLabel:'Unemployment',
    concept:'Cyclical Unemployment',
    diagramType:'adAs', shift:'adLeft',
    explanation:'Cyclical (demand-deficient) unemployment arises when AD falls below the level needed to employ all willing workers at current wages. It is directly linked to the business cycle — rising in recessions, falling in booms. In AD/AS terms it corresponds to a negative output gap. Keynesians argue it can persist due to wage rigidity; classicals argue it self-corrects via wage falls. The appropriate cure is demand stimulus (fiscal or monetary) to restore AD. Evaluation: the distinction between cyclical and structural unemployment matters for policy — demand stimulus works for cyclical unemployment but is ineffective against structural unemployment (a skills mismatch cannot be solved by spending). Links to: AD shift left, negative output gap, fiscal policy, AJ/LF model.',
    keyPoint:'Cyclical U = demand-deficient. Rises in recession, falls in boom. Cure: demand stimulus. Evaluation: prolonged cyclical unemployment can become structural (hysteresis) — workers lose skills and attachment to the labour market, raising the NRU permanently. This is a key argument for early, decisive counter-cyclical policy. UK example: UK unemployment rose from 5.2% (2008) to 8.5% (2011) during the financial crisis — the cyclical component was estimated at 3–4%, consistent with the output gap of approximately −3% of GDP. Links: AD Shift Left, Negative Output Gap, Fiscal Policy, AJ/LF Model, Hysteresis.' },
    {category:'unemployment', catLabel:'Unemployment',
    concept:'Keynesian Unemployment',
    diagramType:'keynesianUnemployment',
    explanation:'Keynesian unemployment arises when aggregate demand (AD) is insufficient to purchase all the output the economy could produce at full employment — it is demand-deficient unemployment caused by a collapse in spending. On the Keynesian LRAS diagram, the AS curve has three sections: a flat portion (substantial spare capacity and unemployment, where output can rise with no price pressure), a curved upward portion (competition for resources begins), and a vertical section at full capacity. When AD shifts left — due to a fall in consumption, investment, government spending or net exports — the new equilibrium intersects the flat section at a lower output Y2 but the same price level P. This is the defining Keynesian insight: in a recession with spare capacity, AD falls translate entirely into lower output and employment, not lower prices, because wages and prices are sticky downward. The price level does not fall to restore equilibrium — instead, output and employment bear the full adjustment burden. Key assumption: wages and prices are sticky downward — if they were fully flexible, a fall in AD would lower wages and prices until the labour market cleared (the classical view). Evaluation: the stickiness assumption is empirically well-supported — UK nominal wages did not fall during 2008–12 despite high unemployment, confirming the Keynesian mechanism. This justifies activist fiscal and monetary policy to boost AD back toward full employment, rather than waiting for self-correction. Links to: AD shifts, Keynesian LRAS, cyclical unemployment, fiscal policy, multiplier.',
    keyPoint:'AD shifts left in spare capacity zone → Y falls (Y1→Y2), P unchanged. Keynesian unemployment = demand-deficient. Sticky wages/prices prevent self-correction. Evaluation: the Keynesian model implies government has a clear role — fiscal stimulus (↑G or ↓T) shifts AD right, restoring Y1 without inflation risk while spare capacity exists. Classical economists dispute this: they argue sticky wages are temporary and the economy self-corrects via falling prices. The 2010–12 UK austerity debate was precisely this disagreement. Links: AD/AS Equilibrium, Keynesian LRAS, Fiscal Policy, Multiplier, Cyclical Unemployment. UK example: during the 2008–09 recession, UK GDP fell 6% as AD collapsed (investment fell 15%, consumer confidence crashed) — the economy moved left along the flat Keynesian AS, unemployment rose from 5% to 8.5%, but CPI remained positive throughout, consistent with the Keynesian sticky-price mechanism.'},

  { id:25, category:'unemployment', catLabel:'Unemployment',
    concept:'Classical Unemployment',
    diagramType:'classicalUnemployment',
    explanation:'Classical (real wage) unemployment occurs when real wages are held above the market-clearing level — either by minimum wage legislation, trade union bargaining power, or efficiency wage practices. At the artificially high wage, labour supply exceeds labour demand, creating a surplus of workers. The cure is to reduce the real wage floor or increase labour demand. Evaluation: whether minimum wages cause classical unemployment is hotly contested — Card and Krueger\'s US evidence showed monopsony power can mean minimum wages raise employment, challenging the classical model. In competitive labour markets, the classical model applies; in monopsonistic markets, it may not. Links to: minimum wage, trade union, monopsony, labour market equilibrium.',
    keyPoint:'Real wage above W* → Qs > Qd → classical unemployment. Cause: min wage, union bargaining, efficiency wages. Cure: ↓ wage floor or ↑ labour demand. Evaluation: Card and Krueger (1994) found no employment loss from NJ minimum wage rises — consistent with monopsony, not competitive markets. The classical model assumes competition; real labour markets vary. UK example: critics of the National Living Wage (£11.44/hr from 2024) argued it could cause classical unemployment in low-margin sectors like hospitality — though employment data showed limited impact, possibly reflecting monopsony power in those markets. Links: Minimum Wage, Trade Union, Monopsony, Labour Market Equilibrium.' },
  { id:31, category:'growth', catLabel:'Economic Growth',
    concept:'Economic Cycle (Business Cycle)',
    diagramType:'economicCycle',
    explanation:'The business cycle describes the regular fluctuation of real GDP around its long-run trend — alternating between boom (above trend), peak, contraction/recession (two consecutive quarters of negative growth), trough, and recovery. The amplitude and frequency vary across cycles. Causes include: Keynesian animal spirits (swings in confidence), the accelerator mechanism, credit cycles, and external shocks. The cycle is a central justification for counter-cyclical macroeconomic policy — fiscal and monetary tools used to smooth fluctuations. Evaluation: the cycle is difficult to predict in real time; policymakers often act too late (fiscal policy lags can be 12–18 months). Automatic stabilisers (unemployment benefits, progressive tax) act faster than discretionary policy. Links to: multiplier, accelerator, fiscal policy, AD/AS.',
    keyPoint:'Boom → peak → recession → trough → recovery → repeat. GDP fluctuates around trend. Evaluation: the political business cycle (Nordhaus, 1975) suggests governments time boosts before elections — adding an artificial cycle on top of the economic one, complicating policy. Independent central banks were partly designed to avoid this. UK example: UK cycles since 1945 — deep recessions in 1979–81, 1990–92, 2008–09, 2020. The 2008 recession was the deepest (-6.3% GDP) since the 1930s. Links: Multiplier, Accelerator Effect, Fiscal Policy, AD Shift.' },
  { id:32, category:'growth', catLabel:'Economic Growth',
    concept:'Accelerator Effect',
    diagramType:'adAs', shift:'adDouble',
    explanation:'The accelerator effect states that investment is determined by the change in output (GDP), not its level. When output grows, firms invest to expand capacity; when growth slows (even if output is still rising), investment falls sharply. The relationship is: I = a × ΔY, where a is the capital-output ratio. The accelerator amplifies the business cycle — a small slowdown in consumption growth triggers a large fall in investment, deepening the downturn. Combined with the multiplier (which amplifies the effect of any spending change on GDP), the multiplier-accelerator interaction can generate volatile cycles. Evaluation: the basic accelerator assumes a fixed capital-output ratio, which is unrealistic — firms adjust cautiously and may have excess capacity, dampening the pure accelerator effect. Links to: multiplier, business cycle, investment, AD.',
    keyPoint:'I = a × ΔY. ↑ in growth → ↑ investment. Slowdown in growth → sharp ↓ investment. Amplifies cycle. Evaluation: the accelerator is most powerful when capacity utilisation is high — when firms have spare capacity, a rise in demand does not trigger new investment immediately, weakening the effect. UK example: UK business investment fell 25% in 2009 despite output falling only 6.3% — consistent with the accelerator (growth collapsed from +3% to −6%, a large ΔY swing). Links: Multiplier Effect, Business Cycle, AD Components, Investment.' },
  { id:33, category:'growth', catLabel:'Economic Growth',
    concept:'Positive Multiplier Effect',
    diagramType:'multiplierPos',
    explanation:'The multiplier describes how an initial injection of spending (ΔG, ΔI or ΔX) generates a larger final change in GDP through successive rounds of income and spending. The formula is k = 1/(1−MPC) or equivalently k = 1/MPW (where MPW = MPS + MPT + MPM). A higher MPC means more of each round is re-spent, generating a larger multiplier. The Keynesian multiplier is the theoretical underpinning for fiscal stimulus: a £1 increase in government spending raises GDP by more than £1. Evaluation: in practice, the multiplier is often smaller than the simple model suggests — high marginal propensity to import, Ricardian equivalence (households saving anticipating future tax rises), and crowding out all reduce its size. Links to: fiscal policy, AD, circular flow, crowding out.',
    keyPoint:'k = 1/(1−MPC) = 1/MPW. ↑ injection → ↑ GDP by k × injection. Evaluation: IMF research (2012) found multipliers were 1.5–2 in recessions with spare capacity, but near zero during booms or when monetary policy offsets fiscal expansion. UK austerity cuts may have been more contractionary than the OBR predicted (multiplier underestimated). UK example: the 2009 UK fiscal stimulus (£20bn) was intended to generate a multiplier effect — Chancellor Darling estimated a multiplier of 0.5–1.0, though academic estimates varied widely. Links: AD Shift, Circular Flow, Fiscal Policy, Crowding Out.' },
  { id:'33b', category:'growth', catLabel:'Economic Growth',
    concept:'Negative Multiplier Effect',
    diagramType:'multiplierNeg',
    explanation:'The negative multiplier (or reverse multiplier) works identically to the positive version but in reverse: a withdrawal of spending (↓G, ↓I, ↑T) reduces income, which reduces consumption, which reduces income further. The final GDP fall is a multiple of the initial withdrawal. This is the theoretical basis for why austerity can be more damaging than the headline spending cuts suggest. The multiplier-accelerator interaction amplifies downturns further — falling income reduces investment via the accelerator, which further reduces income. Evaluation: the damage from fiscal contraction depends critically on the multiplier size — if Ricardian equivalence holds strongly, households anticipate future tax cuts from deficit reduction and maintain spending, shrinking the negative multiplier. Links to: austerity, business cycle, accelerator, negative output gap.',
    keyPoint:'↓ Injection or ↑ leakage → GDP falls by k × initial withdrawal. Reverse multiplier. Evaluation: the OBR underestimated the negative multiplier during 2010–12 UK austerity — the IMF later concluded multipliers were 1.5× larger than assumed, partly explaining why the recovery was weaker than forecast. UK example: the 2010 Spending Review cut public spending by £83bn; GDP growth slowed sharply and the UK narrowly avoided a triple-dip recession in 2012 — consistent with a negative multiplier effect of 1.0–1.5. Links: Fiscal Policy, Business Cycle, Crowding Out, AD Shift Left.' },
  { id:34, category:'growth', catLabel:'Economic Growth',
    concept:'Harrod-Domar Model',
    diagramType:'harrodDomar',
    explanation:'The Harrod-Domar model states that the rate of economic growth is determined by the savings ratio (s) divided by the capital-output ratio (k): g = s/k. Higher savings generate investment; lower capital requirements per unit of output mean each investment generates more growth. The model was originally developed for closed economies and emphasises capital accumulation as the driver of growth. Evaluation: the model has major limitations — it ignores human capital, technology, institutions and trade; it assumes a fixed capital-output ratio; and it predicts a \'knife-edge\' equilibrium (the warranted growth rate is inherently unstable). Solow\'s growth model addressed these by adding diminishing returns to capital and technological progress. Links to: investment, supply-side policy, growth theory, savings.',
    keyPoint:'g = s/k. ↑ savings ratio or ↓ capital-output ratio → ↑ growth. Evaluation: the model is most useful for developing economies where capital scarcity is the binding constraint — it is less applicable to advanced economies where technology and institutions matter more (Solow\'s finding). UK example: post-war UK growth was partly driven by the Harrod-Domar mechanism — public investment in infrastructure and the nationalised industries raised the savings-to-capital-output ratio. But UK productivity growth lagged Germany and France, suggesting the model missed institutional factors. Links: Investment, PPF Outward Shift, Supply-Side Policy, LRAS Right.' },
  { id:'34a', category:'growth', catLabel:'Economic Growth',
    concept:'Long-Run Growth (Classical LRAS Right)',
    diagramType:'classicalLrasRight',
    explanation:'A rightward shift of the classical LRAS represents a permanent increase in productive capacity — the economy can sustainably produce more output at every price level. Causes include: capital accumulation, technological progress (total factor productivity), improvements in human capital, and institutional improvements. This is genuine long-run economic growth as distinct from cyclical recovery. In PPF terms, it is an outward shift. Evaluation: the sources of long-run growth are debated — neoclassical growth theory (Solow) emphasises diminishing returns to capital and exogenous technology; endogenous growth theory (Romer, Lucas) argues knowledge and human capital have non-diminishing returns, making policy-driven growth possible. Links to: PPF outward shift, supply-side policy, LRPC, productive capacity.',
    keyPoint:'LRAS right → ↑ Yf → lower price level at same AD. Represents genuine long-run growth. Evaluation: endogenous growth theory (Romer) suggests knowledge spillovers mean LRAS shifts can be self-sustaining — government investment in R&D and education generates returns that justify continued policy intervention, unlike Solow where only exogenous technology drives long-run growth. UK example: UK productivity growth averaged 2.2%/year 1990–2008 (LRAS shifting right) but slowed to 0.4%/year post-2010 — the \'productivity puzzle\' suggests the LRAS has largely stagnated. Links: PPF Outward Shift, Supply-Side Policy, Harrod-Domar, LRPC.' },
  { id:'34b', category:'growth', catLabel:'Economic Growth',
    concept:'Declining Productive Capacity (Classical LRAS Left)',
    diagramType:'classicalLrasLeft',
    explanation:'A leftward shift of the LRAS means the economy\'s long-run productive capacity has permanently fallen — potential GDP is lower than before. Causes include: capital stock destruction (war, natural disaster), workforce shrinkage (pandemic, emigration, ageing population), long-term unemployment causing skill atrophy (hysteresis), or persistent underinvestment allowing capital to depreciate. In PPF terms, it is an inward shift. This is more serious than a negative output gap: the economy is not just below potential, its potential has fallen. Evaluation: the distinction between a negative output gap and an inward LRAS shift is crucial for policy — the former calls for demand stimulus; the latter requires supply-side investment. Links to: inward PPF shift, hysteresis, capital depreciation, supply-side policy.',
    keyPoint:'LRAS left → ↓ Yf → lower sustainable output. More serious than negative output gap — potential itself has fallen. Evaluation: hysteresis is a major concern — cyclical unemployment that persists can become structural (skills lost, workers leave labour force), permanently shifting LRAS left. This is why early, decisive policy response to recessions matters. UK example: the post-COVID rise in long-term sickness (400,000+ additional workers economically inactive by 2023) represents a leftward LRAS shift — productive capacity has contracted, not just utilisation fallen. Links: Inward PPF Shift, Hysteresis, Classical Unemployment, Supply-Side Policy.' },
  { id:'4c', category:'fiscal', catLabel:'Fiscal Policy',
    concept:'Crowding Out (Loanable Funds)',
    diagramType:'crowdingOut',
    explanation:'Crowding out occurs when government borrowing to finance deficit spending raises interest rates in the loanable funds market, reducing private investment. The mechanism: increased G → higher public sector borrowing requirement → government issues bonds → bond supply rises → bond prices fall → yields (interest rates) rise → private firms face higher borrowing costs → investment falls. Complete crowding out would mean ΔI = −ΔG, leaving GDP unchanged. Evaluation: the degree of crowding out depends critically on whether the economy has spare capacity. In a recession with a negative output gap and near-zero interest rates, crowding out is minimal (the liquidity trap argument). In a boom at full employment, it is strongest. Links to: loanable funds, fiscal policy, multiplier, investment.',
    keyPoint:'↑ G borrowing → ↑ loanable funds demand → ↑ interest rates → ↓ private investment. Evaluation: crowding out is weakest in recessions (spare capacity + low rates mean bond markets absorb new issuance without large rate rises) and strongest at full employment. Empirical evidence for full crowding out is weak. UK example: UK 10-year gilt yields rose from 0.4% (2020) to 4.5% (2023) as deficit spending increased post-COVID — consistent with partial crowding out, though global factors also drove yields. Links: Fiscal Policy, Multiplier, Investment, Liquidity Trap.' },
  { id:'4d', category:'fiscal', catLabel:'Fiscal Policy',
    concept:'Crowding In (PPF)',
    diagramType:'ppf', shift:'crowdingIn',
    explanation:'Crowding in is the opposite of crowding out: government investment in infrastructure, education or R&D increases private sector productivity and profitability, stimulating additional private investment. In PPF terms, public investment shifts the frontier outward, creating conditions where private firms can generate higher returns. The rationale: market failure in public goods and positive externalities means the private sector underinvests — government spending fills the gap and improves the return on private capital. Evaluation: crowding in requires the public investment to be genuinely productive — wasteful spending does not raise private returns. The quality of public investment matters as much as the quantity. Links to: PPF, supply-side policy, market failure, multiplier.',
    keyPoint:'Productive public investment → ↑ private sector returns → ↑ private investment (crowding in). PPF shifts out. Evaluation: the key condition is that public investment must address genuine market failures (infrastructure, education, R&D) rather than substitute for efficient private provision — government failure can negate the crowding-in effect. UK example: the M25 completion (1986) is a classic crowding-in case — public infrastructure investment raised productivity of businesses along the corridor, stimulating private warehousing and logistics investment that would not have occurred without the road. Links: PPF Outward Shift, Market Failure, Multiplier, Supply-Side Policy.' },
  { id:'36a', category:'fiscal', catLabel:'Fiscal Policy',
    concept:'Expansionary Fiscal Policy (Keynesian)',
    diagramType:'expFiscalKeynesian',
    explanation:'Expansionary fiscal policy involves increasing government spending (↑G) or cutting taxes (↓T) to stimulate AD during a recession. In the Keynesian model with a horizontal LRAS section (spare capacity), this raises real GDP without significantly raising the price level. The multiplier amplifies the initial injection: a £1bn increase in G can generate several billion in GDP growth. The main tools are automatic stabilisers (unemployment benefits rise, tax receipts fall automatically) and discretionary fiscal policy (deliberate budget decisions). Evaluation: effectiveness depends on the size of the multiplier, the time lags involved (fiscal policy takes 12–18 months to fully impact), and whether the deficit is financed by borrowing (which may crowd out) or money creation (which may be inflationary). Links to: multiplier, AD shift, crowding out, government debt.',
    keyPoint:'↑ G or ↓ T → AD right → ↑ Real GDP (if spare capacity). Multiplier amplifies. Evaluation: most effective with spare capacity and low interest rates; least effective at full employment (pure crowding out/inflation). Time lags mean policy may arrive too late. Ricardian equivalence: if households anticipate future tax rises to repay debt, they save the stimulus rather than spend it. UK example: the 2009 UK fiscal stimulus (temporary VAT cut from 17.5% to 15% + ↑ spending) was a Keynesian response to the financial crisis recession — GDP contraction of -4.3% in 2009 would likely have been deeper without it. Links: AD Shift, Multiplier, Crowding Out, Keynesian LRAS.' },
  { id:37, category:'fiscal', catLabel:'Fiscal Policy',
    concept:'Contractionary Fiscal Policy',
    diagramType:'adAs', shift:'adLeft',
    explanation:'Contractionary fiscal policy (austerity) involves cutting government spending (↓G) or raising taxes (↑T) to reduce the budget deficit, slow inflation, or reduce government debt. In AD/AS terms it shifts AD left, reducing both the price level and real GDP. The multiplier amplifies the contraction — a given cut in G reduces GDP by more than the cut itself. Evaluation: the debate centres on timing and multipliers — austerity is most appropriate when the economy is overheating (positive output gap) and the multiplier is small. Applied in a recession with a large multiplier, it can be deeply contractionary. Fiscal consolidation may also improve long-run growth if it restores confidence and reduces borrowing costs (the expansionary austerity hypothesis of Alesina and Ardagna — though largely discredited empirically). Links to: multiplier, negative multiplier, crowding out, government debt.',
    keyPoint:'↓ G or ↑ T → AD left → ↓ Real GDP, ↓ Price Level. Multiplier amplifies the contraction. Evaluation: IMF research (Blanchard and Leigh, 2013) found that multipliers were 1.5–2 during the 2010–12 period — meaning the UK fiscal consolidation reduced GDP by roughly 1.5–2× the headline spending cuts, more than policymakers assumed. UK example: the 2010 Spending Review (Osborne) cut public spending by £83bn — the resulting double-dip recession and slow recovery tested whether the multiplier was as small as the OBR projected. Links: Negative Multiplier, AD Shift Left, Government Debt, Crowding Out.' },
  { id:39, category:'fiscal', catLabel:'Fiscal Policy',
    concept:'Laffer Curve',
    diagramType:'laffer',
    explanation:'The Laffer Curve illustrates that tax revenue is zero at both a 0% and 100% tax rate — and peaks at some optimal rate in between. At very high rates, cutting taxes can increase revenue by expanding the tax base (more economic activity, less avoidance/evasion). The curve is the theoretical basis for supply-side tax cuts. Evaluation: the key empirical question is where the current tax rate sits relative to the revenue-maximising rate. Most economists believe advanced economies are on the left (upward-sloping) side — meaning tax cuts reduce revenue rather than increase it. The Laffer Curve is a valid theoretical insight but has been misused to justify tax cuts whose revenue effects were grossly overestimated (Reagan\'s 1981 tax cuts, Kansas experiment). Links to: supply-side policy, income tax, incentives, LRAS.',
    keyPoint:'Revenue = 0 at 0% and 100% tax rates. Peaks at optimal rate. Cutting rates above peak → ↑ revenue. Evaluation: empirical evidence for advanced economies suggests the revenue-maximising top income tax rate is 50–70% (Diamond and Saez, 2011) — implying most countries are on the left side where cuts reduce revenue. The curve is real but its practical revenue effects are routinely overstated. UK example: the UK cut the top income tax rate from 50% to 45% in 2013 — the OBR estimated this raised behavioural response revenue (less avoidance) but reduced overall revenue, suggesting the UK was on the left side of the curve. Links: Supply-Side Policy, Incentives, LRAS, Fiscal Policy.' },
  { id:40, category:'fiscal', catLabel:'Fiscal Policy',
    concept:'Balanced Budget',
    diagramType:'balancedBudget',
    explanation:'A balanced budget occurs when government expenditure equals government tax revenue (G = T) — neither a deficit nor a surplus. A balanced budget multiplier shows that equal increases in G and T (both by £X) still raise GDP by £X, because the spending increase has a full multiplier effect while the tax increase is partly absorbed by reduced saving. In practice, most governments run structural deficits (excluding cyclical components) and cyclical deficits during recessions. Evaluation: the case for a balanced budget rule (as in German constitutional law or US state laws) is that it prevents unsustainable debt accumulation; the case against is that it forces pro-cyclical policy — cutting spending in recessions when stimulus is needed. Links to: fiscal rules, multiplier, government debt, fiscal policy.',
    keyPoint:'G = T → balanced budget. Balanced budget multiplier = 1 (equal ↑G and ↑T raises GDP by the same amount). Evaluation: fiscal rules that mandate balance can be destabilising — the EU Stability and Growth Pact\'s 3% deficit limit forced some member states to tighten during the 2010 recession, deepening their downturns. Counter-argument: rules prevent political profligacy and maintain credibility. UK example: the UK has not run a budget surplus since 1999–2001 (Gordon Brown). Current fiscal rules (Reeves, 2024) target current budget balance within 5 years — structural rather than nominal balance. Links: Fiscal Policy, Government Debt, Multiplier, Automatic Stabilisers.' },
  { id:44, category:'monetary', catLabel:'Monetary Policy',
    concept:'Transmission Mechanism',
    diagramType:'transmission',
    explanation:'The monetary policy transmission mechanism describes the channels through which a change in the Bank Rate affects inflation and output. The main channels are: (1) Asset prices — lower rates raise bond and equity prices, increasing wealth and consumption. (2) Exchange rate — lower rates reduce demand for sterling, causing depreciation, raising import prices and export competitiveness. (3) Credit and lending — lower rates reduce the cost of borrowing for firms and households, stimulating investment and consumption. (4) Expectations — credible forward guidance about future rates shapes spending decisions today. Each channel has different lags (6–18 months typically). Evaluation: the mechanism\'s effectiveness varies — in a liquidity trap, rate cuts fail to stimulate lending; in a credit crunch, banks may not pass rate cuts to borrowers. Links to: Bank Rate, QE, exchange rates, AD.',
    keyPoint:'Bank Rate ↓ → ↑ lending, ↑ asset prices, ↓ exchange rate, ↑ AD → ↑ output, ↑ inflation. Lags: 6–18 months. Evaluation: the transmission mechanism weakened after 2009 — banks hoarded liquidity rather than lending, reducing the credit channel. This is why QE was needed as a supplement. UK example: the Bank of England\'s rate cuts from 5.75% (2007) to 0.5% (2009) had limited immediate impact on lending — banks were capital-constrained, breaking the credit channel. Links: QE, Exchange Rate, AD Components, Liquidity Trap.' },
  { id:45, category:'monetary', catLabel:'Monetary Policy',
    concept:'Money Supply & Demand',
    diagramType:'moneySD',
    explanation:'The money market diagram shows the nominal interest rate determined by the intersection of money supply (vertical, set by the central bank) and money demand (downward-sloping — at lower interest rates, the opportunity cost of holding money is lower, so more is demanded for transactions and speculation). A rise in money supply shifts the supply curve right, lowering the interest rate. A rise in GDP or price level shifts demand right, raising the interest rate. The quantity theory of money (MV = PT) provides the monetarist framework: if V (velocity) is stable and T (transactions) fixed at full employment, ↑M → ↑P proportionally. Evaluation: velocity is not stable in practice — the velocity of money fell sharply after 2009 as QE expanded M but lending and transactions did not rise proportionally, breaking the quantity theory. Links to: QE, Bank Rate, inflation, transmission mechanism.',
    keyPoint:'Interest rate = equilibrium of money supply and demand. Central bank sets MS (vertical). MD downward-sloping (opportunity cost of holding money). Evaluation: the monetarist prescription (control MS to control inflation) proved difficult in practice — financial innovation and the endogenous creation of credit by commercial banks mean central banks cannot fully control broad money. UK example: post-2009 QE expanded the monetary base by £895bn but broad money (M4) grew far less — velocity collapsed, demonstrating the limits of the quantity theory of money. Links: QE, Bank Rate, Transmission Mechanism, Inflation.' },
  { id:46, category:'monetary', catLabel:'Monetary Policy',
    concept:'Quantitative Easing (QE)',
    diagramType:'qe',
    explanation:'QE is an unconventional monetary policy used when interest rates are at or near the zero lower bound. The central bank creates new money (electronically) and uses it to purchase government bonds and other financial assets from banks and institutional investors. This has three intended effects: (1) raises bond prices (lowers yields), reducing long-term borrowing costs; (2) pushes investors into riskier assets (portfolio rebalancing), raising equity prices and wealth; (3) signals commitment to loose monetary policy, anchoring expectations. Evaluation: QE\'s effectiveness is contested — it clearly prevented a deflationary spiral in 2009–10, but the scale needed to generate significant inflation or growth was unexpectedly large. It also worsened wealth inequality (asset price inflation benefited owners of capital). Links to: zero lower bound, liquidity trap, asset prices, transmission mechanism.',
    keyPoint:'Central bank creates money → buys bonds → ↓ long-term yields → ↑ asset prices → portfolio rebalancing → ↑ AD. Evaluation: QE is more effective at preventing deflation than generating inflation — the \'pushing on a string\' problem means newly created money may be hoarded as bank reserves rather than lent. Distributional concern: QE inflated asset prices, benefiting the wealthy disproportionately. UK example: Bank of England launched £375bn of QE (2009–12), expanded to £895bn by 2021 — successfully preventing deflation but contributing to a 50% rise in UK house prices 2010–22. Links: Liquidity Trap, Zero Lower Bound, Transmission Mechanism, Monetary Policy.' },
  { id:47, category:'monetary', catLabel:'Monetary Policy',
    concept:'Quantitative Tightening (QT)',
    diagramType:'qt',
    explanation:'QT is the reverse of QE — the central bank reduces its balance sheet by allowing bonds to mature without reinvestment (passive QT) or actively selling bonds back to the market (active QT). This removes money from circulation, raises long-term yields, and tightens financial conditions beyond what rate rises alone achieve. QT was deployed by the Bank of England and Federal Reserve from 2022 to complement rate rises in fighting post-COVID inflation. Evaluation: the effects of QT are less well understood than QE because it has been used rarely — the 2019 Fed attempt to reduce its balance sheet triggered a repo market seizure, suggesting QT has non-linear effects on financial stability. The pace of QT must be calibrated carefully to avoid disrupting bond markets. Links to: QE, interest rates, inflation, financial stability.',
    keyPoint:'QT: central bank shrinks balance sheet → ↑ bond supply → ↓ bond prices → ↑ yields → tighter financial conditions → ↓ AD. Complements rate rises. Evaluation: QT is slower-acting and less predictable than rate rises — the unwinding of QE positions built over 10+ years carries financial stability risks if conducted too rapidly. UK example: Bank of England began active QT in November 2022, selling £10bn of gilts per quarter. The September 2022 mini-budget crisis (Truss/Kwarteng) briefly halted QT as the Bank had to buy gilts to stabilise pension funds — illustrating the financial stability risks. Links: QE, Interest Rates, Inflation, Financial Stability.' },
  { id:48, category:'monetary', catLabel:'Monetary Policy',
    concept:'Financial Regulation & Reserve Requirements',
    diagramType:'qt',
    explanation:'Banks are required to hold a proportion of deposits as reserves (reserve ratio) and capital relative to risk-weighted assets (capital ratio). Higher reserve requirements reduce the money multiplier — limiting the amount of credit commercial banks can create from a given monetary base. Post-2008, macroprudential regulation (overseen by the Financial Policy Committee in the UK) added counter-cyclical capital buffers: banks must hold more capital during booms (reducing lending) and less in downturns (supporting lending). Evaluation: regulation reduces systemic risk but may restrict credit supply — the correct balance between financial stability and credit availability is a persistent policy tension. Regulatory arbitrage (banks moving activity off-balance-sheet) can undermine reserve and capital requirements. Links to: money supply, credit, financial stability, QE.',
    keyPoint:'↑ Reserve ratio → ↓ money multiplier → ↓ credit creation. Capital requirements: ↑ capital ratio → safer banks but ↓ lending. Counter-cyclical buffers: ↑ in booms, ↓ in downturns. Evaluation: 2008 revealed that regulatory frameworks failed to account for shadow banking — mortgage-backed securities and off-balance-sheet vehicles created credit outside regulated channels. Post-2008 reforms (Basel III) strengthened requirements but shadow banking remains a concern. UK example: UK banks\' capital ratios rose from ~5% (2007) to ~15%+ (2023) post-Basel III — reducing systemic risk but contributing to tighter lending conditions. Links: Money Supply, QE, Financial Stability, Credit.' },
  { id:49, category:'monetary', catLabel:'Monetary Policy',
    concept:'Liquidity Trap',
    diagramType:'liquidityTrap',
    explanation:'A liquidity trap occurs when interest rates hit the zero lower bound and monetary policy becomes ineffective at stimulating spending. At very low rates, the opportunity cost of holding cash approaches zero — investors prefer to hold money rather than bonds, so additional money creation by the central bank merely adds to idle reserves rather than stimulating lending. In Keynes\' original formulation, the speculative demand for money becomes perfectly elastic at low rates. The result: cutting rates or conducting QE fails to boost AD sufficiently. Evaluation: the liquidity trap is controversial — some economists (Bernanke) argued it could always be escaped through sufficiently aggressive unconventional policy; others (Summers — secular stagnation) argued structural factors kept investment demand persistently low. Links to: QE, zero lower bound, Japan, deflation, fiscal policy.',
    keyPoint:'Interest rates at ZLB → money demand perfectly elastic → ↑ money supply doesn\'t ↓ rates or ↑ lending → monetary policy ineffective. Fiscal policy becomes the primary tool. Evaluation: the liquidity trap shifts the policy burden to fiscal policy — the multiplier becomes more powerful (no crowding out via rising rates) making the case for deficit spending stronger. UK example: UK Bank Rate at 0.5% (2009–16) and 0.1% (2020–21) — the Bank relied on QE and forward guidance rather than rate cuts, consistent with near-zero ZLB conditions. Links: QE, Fiscal Policy, Deflation, Negative Output Gap.' },
  { id:50, category:'exchange', catLabel:'Exchange Rates',
    concept:'Exchange Rate: Appreciation',
    diagramType:'floatingXR',
    explanation:'Currency appreciation occurs when the exchange rate rises — each unit of domestic currency buys more foreign currency. For a floating currency, appreciation is caused by: higher interest rates (attracting hot money inflows), increased demand for exports, stronger economic performance, or speculation. Effects: exports become more expensive abroad (fall in volume), imports become cheaper domestically (rise in volume). This improves the terms of trade but worsens the current account if the Marshall-Lerner condition holds (PED of exports + imports > 1). Evaluation: appreciation is a double-edged sword — it reduces import cost inflation (helping the Bank of England\'s inflation target) but damages export competitiveness. The net effect depends on the time horizon and the elasticity of trade flows. Links to: J-Curve, Marshall-Lerner, current account, monetary policy.',
    keyPoint:'↑ Exchange rate → exports costlier, imports cheaper. ↓ Current account (if ML condition holds). ↓ Import inflation. Evaluation: appreciation helps inflation control (imported deflation) but harms net exports — the two policy objectives can conflict. Short-run: trade volumes sticky (contracts), so CA may worsen before improving. UK example: sterling appreciated ~15% in 2013–15 as the UK recovery outpaced the eurozone — UK export growth slowed while import prices fell, consistent with appreciation effects. Links: J-Curve, Marshall-Lerner, Current Account, Monetary Policy.' },
  { id:51, category:'exchange', catLabel:'Exchange Rates',
    concept:'Fixed Exchange Rate',
    diagramType:'fixedXR',
    explanation:'A fixed exchange rate regime pegs the domestic currency to another currency (or gold) at a set rate. The central bank maintains the peg by intervening in the foreign exchange market — buying domestic currency to prevent depreciation (using foreign exchange reserves) or selling it to prevent appreciation. Benefits: eliminates exchange rate uncertainty (promotes trade and investment), provides an anti-inflationary anchor, and forces fiscal discipline. Costs: loss of independent monetary policy (interest rates must defend the peg rather than stabilise domestic output), vulnerability to speculative attack, and the need for large foreign exchange reserves. Evaluation: the optimal exchange rate regime depends on the degree of trade integration and business cycle synchronisation — fixed rates work best for small, open, trade-integrated economies (e.g. Hong Kong). Links to: interest rates, foreign exchange reserves, current account, Mundell-Fleming.',
    keyPoint:'Fixed peg: CB intervenes to maintain rate. ↑ pressure on peg → CB sells reserves + raises rates. Evaluation: fixed rates eliminate currency risk (good for trade) but sacrifice monetary policy independence — the Mundell-Fleming impossible trinity: you cannot simultaneously have a fixed rate, free capital flows, and independent monetary policy. UK example: the UK ERM crisis (September 1992) — the pound was pegged to the DM but speculative attacks forced sterling out. The Bank raised rates to 15% in one day trying to defend the peg before abandoning it. Links: Interest Rates, Speculative Attack, Current Account, Monetary Policy.' },
  { id:52, category:'exchange', catLabel:'Exchange Rates',
    concept:'Managed Exchange Rate',
    diagramType:'managedXR',
    explanation:'A managed float (dirty float) allows the exchange rate to be market-determined within limits or broadly, with the central bank intervening selectively to prevent excessive volatility or misalignment. Unlike a fixed rate, there is no formal peg — the central bank uses judgement about when to intervene. The degree of management varies: some countries (e.g. China) manage tightly with a daily midpoint; others (e.g. UK) intervene rarely. Benefits: retains some monetary policy independence while reducing volatility; disadvantage: discretion creates uncertainty about intervention triggers, and large reserve holdings have opportunity costs. Evaluation: most large economies operate some form of managed float in practice, even if they officially claim to float freely — G20 nations have pledged not to manipulate exchange rates for competitive advantage (currency wars). Links to: fixed/floating exchange rates, foreign exchange reserves, monetary policy.',
    keyPoint:'Market-determined within band or with CB discretion. CB intervenes to limit volatility or prevent misalignment, not to fix a rate. Evaluation: managed floats offer a middle path but risk currency war accusations if intervention appears to gain export competitiveness. The IMF monitors exchange rate policies for competitive devaluation. UK example: the Bank of England rarely intervenes directly in currency markets — but jawboning (verbal intervention about exchange rate concerns) has been used to influence sterling, particularly during periods of extreme volatility post-Brexit. Links: Fixed Exchange Rate, Monetary Policy, Current Account, Foreign Exchange Reserves.' },
  { id:53, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'J-Curve Effect',
    diagramType:'jcurve',
    explanation:'Following a currency depreciation, the current account initially worsens before improving — tracing a J-shape over time. In the short run (0–6 months), export and import contracts are fixed, quantities do not adjust, and import costs in sterling rise immediately — worsening the current account in value terms. Over 12–24 months, contracts reprice, consumers and firms switch — PED rises as the Marshall-Lerner condition is met (PED_X + PED_M > 1) and the current account improves. The J-Curve illustrates that trade elasticities are lower in the short run than the long run. Evaluation: if the ML condition is not met (both export and import demands are very inelastic), depreciation may not improve the current account even in the long run. Links to: Marshall-Lerner, exchange rate, current account, PED.',
    keyPoint:'Depreciation → SR: ↑ import costs (inelastic demand) → CA worsens. LR: quantities adjust, ML met → CA improves. Evaluation: the length of the J-Curve trough varies — typically 12–24 months. If the UK\'s export and import demands are both inelastic (e.g. if the UK specialises in inelastic goods), the improvement may be modest. UK example: after the 25% sterling depreciation post-Brexit referendum (2016), the UK current account deficit widened from 4.3% to 6.9% of GDP in 2016 before narrowing — consistent with J-Curve dynamics, though the COVID shock subsequently complicated the picture. Links: Marshall-Lerner Condition, Exchange Rate, Current Account, PED.' },
  { id:58, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Comparative Advantage (PPF)',
    diagramType:'compAdv',
    explanation:'Comparative advantage exists when a country can produce a good at a lower opportunity cost than another — even if it is absolutely less efficient at producing everything. The PPF illustrates this: different slopes represent different opportunity costs. The country with the flatter PPF for Good X has lower opportunity cost and comparative advantage in X. Specialisation and trade allow both countries to consume beyond their individual PPFs. The theory was formalised by Ricardo (1817) and underpins the case for free trade. Evaluation: the theory assumes constant opportunity costs (straight-line PPF), no transport costs, factor immobility between countries (in practice, capital moves internationally), and ignores dynamic comparative advantage — a country may gain advantage through investment rather than inherit it through endowments. Links to: trade creation, free trade, absolute advantage, globalisation.',
    keyPoint:'Specialise where OC is lowest → both countries gain from trade. PPF gradients show OC. Evaluation: the static comparative advantage model ignores that specialisation can lock countries into low-value goods — \'infant industry\' arguments and industrial policy (South Korea, China) suggest dynamic comparative advantage can be created, not just exploited. UK example: UK has comparative advantage in financial services and pharmaceuticals (low OC relative to manufacturing) — UK exports of services represented 45% of total exports in 2023, reflecting specialisation along comparative advantage lines. Links: Trade Theory, Trade Creation, Absolute Advantage, Free Trade.' },
  { id:59, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Comparative Advantage (Numerical)',
    diagramType:'compAdvGrid',
    explanation:'With numerical examples, comparative advantage is determined by comparing opportunity costs across countries. Country A: produces 200Y or 1,000X (OC of Y = 5X). Country B: produces 100Y or 1,500X (OC of Y = 15X). A has comparative advantage in Y (OC of 5X < B\'s 15X); B has comparative advantage in X (OC = 1/15Y vs A\'s 1/5Y). Under full specialisation: 200Y + 1,500X > autarky production of ~150Y + ~1,250X. Both countries gain by trading within the terms of trade range (between the two OC ratios). Evaluation: the gains from trade are real but unevenly distributed within countries — workers in the sector where the country has comparative disadvantage face unemployment and wage pressure, creating domestic winners and losers even when the aggregate gain is positive. Links to: PPF, trade policy, trade creation, protectionism.',
    keyPoint:'Compare OC (not absolute productivity) to find where each country should specialise. Both gain if each trades within the terms of trade range. Evaluation: the distribution of gains from trade matters — the Stolper-Samuelson theorem predicts that the scarce factor of production (typically low-skill labour in advanced economies) loses from trade, creating political pressure for protectionism. UK example: Ricardo\'s original illustration (UK cloth, Portuguese wine) — even if Portugal was better at both, both gained from specialisation. Modern equivalent: UK exports high-value services, imports manufactured goods. Links: Comparative Advantage PPF, Trade Creation, Trade Policy, Globalisation.' },
    {id:59.5, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Gains from Trade: CPF',
    diagramType:'cpf',
    explanation:'The Consumption Possibility Frontier (CPF) shows the combinations of goods a country can consume after specialising and trading at the world price ratio (terms of trade). Without trade, consumption is limited to points on or inside the PPF. With trade, a country can consume beyond its PPF — the CPF lies outside the PPF whenever the world price ratio (terms of trade) differs from the domestic opportunity cost ratio. Using the same numbers as the comparative advantage card: Country A (UK) has a PPF of 200Y (wheat) or 1,000X (cloth) — a domestic OC of 1Y = 5X. Country B (Portugal) has OC of 1Y = 15X, so A has comparative advantage in wheat (Y). If the terms of trade settle at 1Y = 8X (between the two OC ratios), A fully specialises at (200Y, 0X) and trades 120Y for 960X — reaching the consumption point (80Y, 960X), which lies clearly outside the PPF. The CPF runs from the specialisation point through the world price ratio; its x-intercept (1,600X) exceeds the PPF x-intercept (1,000X), and its slope (-1/8) is flatter than the PPF slope (-1/5), creating a triangular gains-from-trade region between the two frontiers. Key assumptions: full specialisation (simplification — partial specialisation also generates gains), constant returns (linear PPF), and terms of trade between the two domestic OC ratios. Evaluation: the size of the gains depends on the terms of trade — the closer the ToT to A\'s own OC (1Y=5X), the smaller A\'s gains and the larger B\'s; the closer to B\'s OC (1Y=15X), the larger A\'s gains. In practice terms of trade are determined by relative supply and demand in world markets. Links to: comparative advantage, PPF, absolute advantage, terms of trade.',
    keyPoint:'CPF lies outside PPF when ToT ≠ domestic OC. Specialise at corner of PPF → trade along CPF → consume beyond PPF. Country A: PPF (0,200)→(1000,0). ToT 1Y=8X → CPF (0,200)→(1600,0). Consumption at (960X, 80Y) — impossible without trade. Gains-from-trade triangle = shaded region between CPF and PPF. Evaluation: gains from trade are real but the distribution matters — within Country A, cloth workers lose while wheat farmers gain. The aggregate CPF lies outside PPF but individual workers may be worse off, justifying adjustment assistance. Terms of trade can also shift adversely over time (Prebisch-Singer thesis: commodity exporters face falling ToT vs manufactured goods). Links: Comparative Advantage PPF, Comparative Advantage Numerical, Terms of Trade, Trade Policy. UK example: UK specialises in financial and professional services (comparative advantage) and imports manufactured goods — the UK CPF extends beyond its domestic PPF precisely because world prices for services exceed UK domestic opportunity costs, generating net gains from trade estimated at 4–5% of GDP by the Bank of England.'},

  { id:55, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Tariff',
    diagramType:'tariff',
    explanation:'A tariff is a tax on imported goods, raising their domestic price from World Price (WP) to WP + Tariff. This increases domestic producer supply (Q1→Q3) and reduces consumer demand (Q2→Q4), narrowing imports. The government collects tariff revenue (the middle rectangle). However, two deadweight loss triangles emerge: a production inefficiency triangle (domestic output produced above world cost) and a consumption loss triangle (consumer surplus destroyed). Net domestic welfare falls, though producer surplus and government revenue partially offset consumer surplus loss. Evaluation: the free trade consensus holds that tariffs reduce global welfare — but there are valid exceptions: infant industry protection, strategic trade policy (e.g. in oligopolistic industries), and national security. WTO rules permit tariffs under certain conditions. Links to: trade policy, DWL, consumer surplus, trade creation.',
    keyPoint:'WP + Tariff → ↑ domestic price → ↑ domestic supply, ↓ imports, govt revenue. Net welfare loss (DWL). Evaluation: the optimal tariff argument — a large country can improve its terms of trade by taxing imports (shifting cost onto foreign exporters) — but invites retaliation, leading to trade wars where all countries lose. UK example: post-Brexit UK tariffs on EU goods (e.g. 10% on cars) increased costs for UK importers and consumers — estimated to reduce UK trade by 15% with the EU. Links: Free Trade, DWL, Consumer Surplus, Trade Creation.' },
  { id:'59a', category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Preferential Trade Agreement (PTA)',
    diagramType:'prefTradeAgreement',
    explanation:'A PTA reduces tariffs between partner countries but does not eliminate them entirely — unlike a full free trade area. The domestic price falls partially from WP+T to WP+PT. Consumer surplus expands, producer surplus contracts, and import volume rises. The net welfare effect has two components: trade creation (welfare gain — consumers switch from high-cost domestic production to cheaper imports) and a partial reduction in tariff revenue. Unlike a full customs union, a PTA does not impose a common external tariff — members may negotiate their own deals with third parties. Evaluation: PTAs are economically second-best to free trade but politically achievable. They may divert trade from more efficient non-members (trade diversion), partially offsetting the trade creation gains. Links to: trade creation, trade diversion, free trade, WTO.',
    keyPoint:'PTA: tariff falls partially (WP+T → WP+PT). Partial trade creation. No common external tariff. Evaluation: the net welfare effect depends on whether trade creation exceeds trade diversion — if the partner country is less efficient than the world market, the PTA may harm welfare despite reducing tariffs. UK example: the UK-Australia FTA (2023) — wine tariffs removed immediately, beef phased over 15 years — is a PTA. The UK\'s independent trade policy post-Brexit allows such targeted bilateral deals rather than requiring EU-level common tariffs. Links: Trade Creation, Trade Diversion, Tariff, Free Trade.' },
  { id:60, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Trade Creation',
    diagramType:'tradeCreation',
    explanation:'Trade creation occurs when joining a free trade area (FTA) causes consumers to switch from high-cost domestic production to lower-cost imports from a member country, following the removal of the internal tariff. The domestic price falls, consumer surplus rises, domestic producer surplus falls, government loses tariff revenue — but net welfare improves because consumer gains exceed the losses. It is the primary welfare benefit of regional economic integration and follows directly from comparative advantage theory. Evaluation: trade creation benefits are maximised when member countries have similar comparative advantages but differ in costs — so joining a bloc with genuinely lower-cost producers creates large switching. Trade creation diminishes if member countries are broadly inefficient relative to the world market. Links to: trade diversion, PTA, comparative advantage, free trade.',
    keyPoint:'High-cost domestic → low-cost FTA member → net welfare gain. Consumer surplus ↑ > producer surplus ↓ + revenue loss. Evaluation: trade creation is welfare-improving but creates domestic losers (domestic producers of import-competing goods). Political resistance to trade liberalisation often comes from these concentrated losers, even when the diffuse gains to consumers are larger. UK example: UK EEC accession (1973) created significant trade — UK consumers switched from domestic food to cheaper continental imports, driving down real food prices during the 1970s–80s. Links: Trade Diversion, PTA, Comparative Advantage, DWL.' },
  { id:61, category:'trade', catLabel:'Trade Theory & Policy',
    concept:'Trade Diversion',
    diagramType:'tradeDiversion',
    explanation:'Trade diversion occurs when a customs union\'s common external tariff (CET) diverts imports away from a more efficient non-member toward a less efficient member country. Despite joining a bloc that reduces internal tariffs, consumers end up paying more for goods than under free trade — because the CET walls off the cheapest world supplier. Trade diversion is the key welfare cost of preferential trading blocs: it may be large enough to outweigh trade creation, making bloc membership net welfare-reducing. Evaluation: whether trade creation or trade diversion dominates depends on the efficiency gap between member and non-member producers — if bloc members are close to world efficiency, diversion is small; if the CET is high and non-members much more efficient, diversion dominates. Links to: trade creation, PTA, customs union, CET.',
    keyPoint:'CET diverts imports from efficient non-member → less efficient member → net welfare loss possible. Trade diversion ≥ trade creation → bloc membership reduces welfare. Evaluation: Viner\'s (1950) framework — the welfare effect of customs union depends entirely on the balance of trade creation vs diversion. EU common agricultural policy is a classic trade diversion case: CET on food protects high-cost EU farmers, diverting from efficient non-EU producers. UK example: EEC membership diverted UK food imports from Commonwealth producers (NZ butter, Australian meat) to EU producers — NZ butter exports to UK fell 75% post-1973. Links: Trade Creation, PTA, Tariff, Comparative Advantage.' },
  { id:62, category:'inequality', catLabel:'Inequality',
    concept:'Lorenz Curve',
    diagramType:'lorenz',
    explanation:'The Lorenz Curve plots cumulative income share (y-axis) against cumulative population share (x-axis), ranked from poorest to richest. The 45° line represents perfect equality. The further the Lorenz Curve bows below this line, the greater the income inequality. The Gini Coefficient quantifies the gap: Gini = Area A / (Area A + Area B). A Gini of 0 means perfect equality; 1 means one person has all income. Lorenz Curves can cross — meaning two distributions may be equally unequal overall but differently distributed (one has more inequality at the top, another at the bottom). Evaluation: the Lorenz Curve and Gini measure income inequality but not wealth inequality (which is typically far more unequal) or equality of opportunity. Inequality has complex effects — moderate inequality may incentivise effort; extreme inequality reduces social mobility and can slow growth. Links to: poverty, redistribution, progressive taxation, Gini coefficient.',
    keyPoint:'Lorenz further from 45° → ↑ inequality → ↑ Gini. Gini = A/(A+B). 0 = perfect equality; 1 = maximum inequality. Evaluation: the Gini captures overall inequality but masks distribution details — two countries with identical Ginis can have very different structures. Wealth Ginis (typically 0.6–0.8) are far higher than income Ginis (0.3–0.4), suggesting focusing on income understates true inequality. UK example: UK Gini rose from 0.25 (1979) to 0.36 (1990) under Thatcher — reflecting income tax cuts and deindustrialisation — then stabilised. At 0.35, the UK is more unequal than most western European nations. Links: Poverty, Progressive Taxation, Redistribution, Social Mobility.' },
  {id:63, category:'inequality', catLabel:'Inequality',
  concept:'Kuznets Curve',
  diagramType:'kuznetsCurve',
  explanation:'The Kuznets curve, proposed by Simon Kuznets (1955), describes an inverted-U relationship between income per capita and income inequality as a country develops economically. In the early stages of development (Stage 1), a country is predominantly agricultural with low incomes and relatively low inequality — most people are poor together. As industrialisation begins, workers migrate from low-productivity agriculture to higher-productivity urban manufacturing. This creates a growing gap between urban and rural incomes, causing inequality to rise. Inequality peaks (Peak Y*) at the height of industrialisation when the urban-rural divide is widest and the industrial elite accumulates capital faster than wages rise. In mature economies (Stage 3), inequality falls as: the majority of the workforce has moved to higher-wage sectors, education and human capital investment become widespread, progressive taxation and welfare states redistribute income, and service sector growth creates middle-class employment. The curve is traced out historically — a single country moves along it over decades as per capita income rises. Key examples: Brazil and South Africa sit near the peak (high Gini coefficients despite middle incomes); Scandinavian countries sit on the downward slope (high income, low Gini). Key assumption: institutional and policy responses follow development automatically — critics argue inequality only falls if governments actively redistribute. Evaluation: the Kuznets curve has been empirically contested — many developing countries have failed to move to Stage 3, remaining trapped in high inequality despite rising incomes (the "middle income trap"). China\'s rapid industrialisation saw inequality rise sharply (Gini rising from 0.28 to 0.49) without the predicted automatic decline. Links to: economic development, Gini coefficient, inequality, redistribution, structural change.',
  keyPoint:'Inverted-U: inequality rises during industrialisation, peaks at middle income, then falls in mature economies. Stage 1 (LDCs): low income, low-moderate inequality. Stage 2 (industrialising): urban-rural gap → rising Gini. Stage 3 (mature): redistribution, education, services → falling Gini. Evaluation: the automatic downswing is not guaranteed — it requires progressive taxation, public education and social safety nets. The UK\'s own Kuznets experience: inequality rose sharply in the 1980s (Thatcher-era deindustrialisation and tax cuts) and has not returned to pre-1980 levels despite high income — suggesting institutional choices, not just income level, determine where a country sits on the curve. Links: Gini Coefficient, Economic Development, Redistribution, Structural Change. UK example: UK Gini rose from 0.25 (1979) to 0.36 (1990) during deindustrialisation and wage polarisation — consistent with Kuznets Stage 2 dynamics despite being a high-income economy, demonstrating that policy choices can shift a country\'s position on the curve regardless of income level.'},
];



// SHARED CARD RENDERER
// ═══════════════════════════════════════════════════════════════
function renderBank(cards, gridId, seenSet, diagFn, filterCat, searchTerm){
  const grid = document.getElementById(gridId);
  grid.innerHTML = '';
  const term = (searchTerm || '').toLowerCase().trim();
  const toShow = cards.filter(function(c){
    const catOk = filterCat === 'all' || c.category === filterCat;
    const searchOk = !term || c.concept.toLowerCase().includes(term);
    return catOk && searchOk;
  });
  toShow.forEach(card => {
    const wrap = document.createElement('div');
    wrap.className = 'cw cat-' + card.category;
    const fc = document.createElement('div');
    fc.className = 'fc' + (seenSet.has(card.id) ? ' flipped' : '');
    // Diagram placeholder — only render SVG on first flip to avoid memory crash on iOS
    const diagPlaceholder = '<div class="cdiag-ph" style="display:flex;align-items:center;justify-content:center;height:100%;color:#94a3b8;font-size:11px;">Tap to reveal</div>';
    fc.innerHTML =
      '<div class="fc-f">' +
        '<div class="ch"><span class="ccat">' + card.catLabel + '</span><span class="cid">#' + card.id + '</span></div>' +
        '<div class="cdiag">' + diagPlaceholder + '</div>' +
        '<div class="ctit"><h3>' + card.concept + '</h3></div>' +
      '</div>' +
      '<div class="fc-b">' +
        '<div>' +
          '<div class="blbl">Key Concept</div>' +
          '<div class="bcon">' + card.concept + '</div>' +
          '<div class="bexp">' + card.explanation + '</div>' +
        '</div>' +
        '<div class="bkey"><strong>Key Point</strong>' + card.keyPoint + '</div>' +
      '</div>';
    let diagRendered = false;
    fc.addEventListener('click', function(){
      if (!diagRendered) {
        const diagEl = fc.querySelector('.cdiag');
        if (diagEl) {
          try { diagEl.innerHTML = diagFn(card); }
          catch(e) { diagEl.innerHTML = '<div style="color:#94a3b8;font-size:10px;padding:8px;">Diagram unavailable</div>'; }
        }
        diagRendered = true;
      }
      fc.classList.toggle('flipped');
      seenSet.add(card.id);
    });
    wrap.appendChild(fc);
    grid.appendChild(wrap);
  });
}

// ═══════════════════════════════════════════════════════════════
// MACRO ENGINE
// ═══════════════════════════════════════════════════════════════

var maSeen = new Set();
var maFilter = 'all';
var maOrder = maCards.slice();

function maRender(){
  var term = document.getElementById('maSearch') ? document.getElementById('maSearch').value : '';
  renderBank(maOrder, 'maGrid', maSeen, buildDiagram, maFilter, term);
  maStats();
}
function maSearchFn(){
  maRender();
}
function maF(cat, btn){
  maFilter = cat;
  document.querySelectorAll('#v-macro .fbtn').forEach(function(b){b.classList.remove('active');});
  btn.classList.add('active');
  var s = document.getElementById('maSearch'); if(s) s.value = '';
  maRender();
}
function maShuffle(){
  for(var i=maOrder.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var t=maOrder[i];maOrder[i]=maOrder[j];maOrder[j]=t;}
  maRender();
}
function maReset(){
  maSeen.clear();
  document.querySelectorAll('#maGrid .fc').forEach(function(c){c.classList.remove('flipped');});
  maStats();
}
function maStats(){
  var term = document.getElementById('maSearch') ? document.getElementById('maSearch').value.toLowerCase().trim() : '';
  var visible = maOrder.filter(function(c){
    var catOk = maFilter==='all' || c.category===maFilter;
    var searchOk = !term || c.concept.toLowerCase().includes(term);
    return catOk && searchOk;
  });
  var seen = visible.filter(function(c){return maSeen.has(c.id);}).length;
  document.getElementById('maSeen').textContent = seen;
  document.getElementById('maTotal').textContent = visible.length;
  document.getElementById('maProg').style.width = maOrder.length > 0 ? (maSeen.size/maOrder.length*100)+'%' : '0%';
}

// ═══════════════════════════════════════════════════════════════
// MICRO ENGINE
// ═══════════════════════════════════════════════════════════════

window.addEventListener('DOMContentLoaded',function(){maRender();});
</script>
</body>
</html>